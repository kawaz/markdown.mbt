const e={hi:0,lo:1},t={hi:536870912,lo:0},n={hi:1386662239,lo:-1067102156},r={hi:415383748,lo:-1362422853},i={hi:2091439360,lo:1910491142},a={hi:321387608,lo:-636522507},o={hi:1696605309,lo:894846830},s={hi:497323236,lo:1760020226},c={hi:1631178199,lo:1745020649},l={hi:384785216,lo:-1023641735},u={hi:-112089089,lo:1138658425},d={hi:297713141,lo:2024993681},f={hi:2078850792,lo:-689350680},p={hi:460688772,lo:-1884531536},m={hi:-1949042199,lo:-1717296150},h={hi:356440673,lo:1081189303},g={hi:139000179,lo:-885070898},_={hi:275782613,lo:666146700},v={hi:355632619,lo:-1175470174},y={hi:426752923,lo:-1269975987},b={hi:-1376851976,lo:1812444822},te={hi:330184081,lo:-172697290},ne={hi:1298688590,lo:-1357372894},re={hi:510935119,lo:1034607249},ie={hi:-1732206330,lo:-526467681},ae={hi:395316900,lo:-39337385},oe={hi:-1893670029,lo:1900641550},se={hi:305861637,lo:1993875634},ce={hi:-1337781375,lo:880033157},le={hi:473297959,lo:1601841581},x={hi:0,lo:0},ue={hi:268435456,lo:0},de={hi:346944695,lo:839070905},fe={hi:240423432,lo:-1290085616},pe={hi:448415508,lo:-1786957811},me={hi:1841736998,lo:1301219430},he={hi:289781730,lo:-2051041035},ge={hi:-350372462,lo:1032165066},_e={hi:374534108,lo:1612227068},ve={hi:-1262372853,lo:581866044},ye={hi:484073989,lo:1529716099},be={hi:1538427726,lo:-1887548368},xe={hi:312825483,lo:-1621953514},Se={hi:-259330749,lo:1988285691},Ce={hi:404317461,lo:838461327},we={hi:-1259465910,lo:-644091568},Te={hi:522568070,lo:-1494201304},Ee={hi:373923531,lo:1891786499},De={hi:337701700,lo:-1668791578},Oe={hi:-2052755795,lo:906519984},ke={hi:436469218,lo:348844165},Ae={hi:155038165,lo:2040105227},je={hi:282061621,lo:983030488},Me={hi:-818365581,lo:1581201068},Ne={hi:364556100,lo:-95262914},Pe={hi:0,lo:5},Fe={hi:0,lo:25},Ie={hi:0,lo:125},Le={hi:0,lo:625},Re={hi:0,lo:3125},ze={hi:0,lo:15625},Be={hi:0,lo:78125},Ve={hi:0,lo:390625},He={hi:0,lo:1953125},Ue={hi:0,lo:9765625},We={hi:0,lo:48828125},Ge={hi:0,lo:244140625},Ke={hi:0,lo:1220703125},qe={hi:1,lo:1808548329},Je={hi:7,lo:452807053},Ye={hi:35,lo:-2030932031},Xe={hi:177,lo:-1564725563},Ze={hi:888,lo:766306777},Qe={hi:4440,lo:-463433411},$e={hi:22204,lo:1977800241},et={hi:111022,lo:1299066613},tt={hi:555111,lo:-2094601527},nt={hi:2775557,lo:-1883073043},rt={hi:13877787,lo:-825430623},it={hi:69388939,lo:167814181},at={$tag:0};function ot(e){this._0=e}ot.prototype.$tag=1;function S(e){this._0=e}S.prototype.$tag=0;function st(e){this._0=e}st.prototype.$tag=1;function C(e){this._0=e}C.prototype.$tag=2;const w={$tag:0};function ct(e){this._0=e}ct.prototype.$tag=1;function lt(e){this._0=e}lt.prototype.$tag=0;function ut(e){this._0=e}ut.prototype.$tag=1;function dt(e){this._0=e}dt.prototype.$tag=2;function ft(e){this._0=e}ft.prototype.$tag=3;function pt(e,t,n,r){this._0=e,this._1=t,this._2=n,this._3=r}pt.prototype.$tag=0;function mt(e){this._0=e}mt.prototype.$tag=1;function ht(e,t){this._0=e,this._1=t}ht.prototype.$tag=2;function gt(e,t){this._0=e,this._1=t}gt.prototype.$tag=3;function _t(e){this._0=e}_t.prototype.$tag=4;function vt(e,t,n,r,i){this._0=e,this._1=t,this._2=n,this._3=r,this._4=i}vt.prototype.$tag=5;function yt(e,t){this._0=e,this._1=t}yt.prototype.$tag=6;var bt=class extends Error{};function T(){throw new bt}function E(e,t){if(t<0||t>=e.length)throw Error(`Index out of bounds`)}function xt(e,t){let n=Array(e);return n.fill(t),n}const St=()=>{if(globalThis.crypto?.getRandomValues){let e=new Uint32Array(1);return globalThis.crypto.getRandomValues(e),e[0]|0}else return Math.floor(Math.random()*4294967296)|0};function Ct(e){this._0=e}Ct.prototype.$tag=0;function wt(e){this._0=e}wt.prototype.$tag=1;const Tt={$tag:1},Et={$tag:0},Dt=(e,t)=>e.toString(t),Ot=(e,t)=>(BigInt(e.hi>>>0)<<32n|BigInt(e.lo>>>0)).toString(t);function kt(e,t){let n=new Uint8Array(e);return t!==0&&n.fill(t),n}const At=(e,t)=>{e.push(t)},jt={$tag:0};function Mt(e){this._0=e}Mt.prototype.$tag=1;function Nt(e){this._0=e}Nt.prototype.$tag=2;function Pt(e){this._0=e}Pt.prototype.$tag=3;function Ft(e){this._0=e}Ft.prototype.$tag=4;const It={$tag:0};function Lt(e){this._0=e}Lt.prototype.$tag=1;function Rt(e){this._0=e}Rt.prototype.$tag=2;function zt(e){this._0=e}zt.prototype.$tag=3;function Bt(e){this._0=e}Bt.prototype.$tag=4;const Vt={$tag:0};function Ht(e){this._0=e}Ht.prototype.$tag=1;function Ut(e){this._0=e}Ut.prototype.$tag=2;function Wt(e){this._0=e}Wt.prototype.$tag=3;function Gt(e){this._0=e}Gt.prototype.$tag=4;const Kt=function(){try{return new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{return}},qt=(e,t)=>{let n=(BigInt(e.hi>>>0)<<32n|BigInt(e.lo>>>0))/(BigInt(t.hi>>>0)<<32n|BigInt(t.lo>>>0)),r=Number(n&4294967295n);return{hi:Number(n>>32n&4294967295n)|0,lo:r|0}},Jt=(e,t)=>{let n=(BigInt(e.hi>>>0)<<32n|BigInt(e.lo>>>0))%(BigInt(t.hi>>>0)<<32n|BigInt(t.lo>>>0)),r=Number(n&4294967295n);return{hi:Number(n>>32n&4294967295n)|0,lo:r|0}},Yt=(e,t)=>{let n=e.hi>>>0,r=t.hi>>>0;if(n<r)return-1;if(n>r)return 1;let i=e.lo>>>0,a=t.lo>>>0;return i<a?-1:i>a?1:0},Xt=function e(t){let n=e._view;return n===void 0&&(n=e._view=new DataView(new ArrayBuffer(8))),n.setFloat64(0,t),{hi:n.getInt32(0),lo:n.getInt32(4)}},Zt=e=>e.slice(0),Qt=(e,t)=>{e.length=t},$t=e=>e.pop(),en=(e,t,n)=>e.splice(t,n),tn={hi:0,lo:-1},nn={hi:2328306,lo:1874919424},rn={hi:232830,lo:-1530494976},an={hi:23283,lo:276447232},on={hi:2328,lo:1316134912},sn={hi:232,lo:-727379968},cn={hi:23,lo:1215752192},ln={hi:2,lo:1410065408},un={hi:0,lo:1e9},dn={hi:0,lo:1e8},fn={hi:0,lo:1e7},pn={hi:0,lo:1e6},mn={hi:0,lo:1e5},hn={hi:0,lo:1e4},gn={hi:0,lo:1e3},_n={hi:0,lo:100},vn={hi:0,lo:10},yn={hi:0,lo:4},bn={hi:0,lo:2},xn=(e,t)=>e[t],Sn=(e,t,n)=>e[t](...n),D=e=>e==null,Cn=()=>({}),wn=(e,t,n)=>{e[t]=n},Tn=()=>null;function En(e){this._0=e}En.prototype.$tag=1;const Dn={$tag:0};function On(e){this._0=e}On.prototype.$tag=1;const kn=()=>document,An=(e,t)=>e.createElement(t),jn=(e,t)=>e.createTextNode(t),Mn=e=>queueMicrotask(e),Nn={$tag:0};function Pn(e){this._0=e}Pn.prototype.$tag=1;function Fn(e){this._0=e}Fn.prototype.$tag=0;function In(e){this._0=e}In.prototype.$tag=1;function Ln(e){this._0=e}Ln.prototype.$tag=2;function Rn(e){this._0=e}Rn.prototype.$tag=3;const zn=(e,t)=>document.createElementNS(e,t),Bn=(e,t,n)=>e.addEventListener(t,n),Vn=(e,t)=>e===t,Hn=(e,t,n)=>{if(typeof e.moveBefore==`function`)try{return e.moveBefore(t,n),t}catch{return e.insertBefore(t,n)}else return e.insertBefore(t,n)},Un=(e,t)=>{if(typeof e.moveBefore==`function`)try{return e.moveBefore(t,null),t}catch{return e.insertBefore(t,null)}else return e.insertBefore(t,null)},Wn=(e,t)=>e.nextSibling===t,Gn=(e,t)=>{try{t.parentNode===e?e.removeChild(t):t.parentNode&&t.parentNode.removeChild(t)}catch{}},O=(e,t)=>(e.click=t,e),Kn=(e,t)=>(e.input=t,e),qn=(e,t)=>(e.change=t,e),Jn=e=>Object.entries(e).map(([e,t])=>({_0:e,_1:{$tag:2,_0:t}})),Yn=(e,t)=>{let n=document.getElementById(e);if(!n)return;let r=t.currentTarget.getBoundingClientRect();n.showPopover(),n.style.left=r.left+r.width/2+`px`,n.style.top=r.bottom+6+`px`,n.style.transform=`translateX(-50%)`},Xn=e=>{let t=document.getElementById(e);t&&t.hidePopover()},k={$tag:0};function A(e){this._0=e}A.prototype.$tag=1;const j={$tag:0};function Zn(e){this._0=e}Zn.prototype.$tag=1;const M={$tag:0};function Qn(e){this._0=e}Qn.prototype.$tag=1;const $n=()=>null,er=(e,t)=>{let n=e.querySelector(`.free-draw-preview`);n||(n=document.createElementNS(`http://www.w3.org/2000/svg`,`polyline`),n.setAttribute(`class`,`free-draw-preview`),n.setAttribute(`fill`,`none`),n.setAttribute(`stroke`,`#888`),n.setAttribute(`stroke-width`,`1`),n.setAttribute(`stroke-linecap`,`round`),n.setAttribute(`stroke-linejoin`,`round`),n.setAttribute(`stroke-dasharray`,`4 2`),n.setAttribute(`opacity`,`0.6`),n.setAttribute(`pointer-events`,`none`),e.appendChild(n)),n.setAttribute(`points`,t)},tr=e=>{let t=e.querySelector(`.free-draw-preview`);t&&t.remove()},nr=e=>e.target.value,rr=e=>{let t=parseFloat(e);return isNaN(t)?null:t};function ir(e){this._0=e}ir.prototype.$tag=0;function ar(e){this._0=e}ar.prototype.$tag=1;function or(e,t,n,r,i){this._0=e,this._1=t,this._2=n,this._3=r,this._4=i}or.prototype.$tag=2;function sr(e,t,n){this._0=e,this._1=t,this._2=n}sr.prototype.$tag=3;function cr(e,t,n){this._0=e,this._1=t,this._2=n}cr.prototype.$tag=4;function lr(e,t,n){this._0=e,this._1=t,this._2=n}lr.prototype.$tag=5;function ur(e,t){this._0=e,this._1=t}ur.prototype.$tag=6;function dr(e,t,n){this._0=e,this._1=t,this._2=n}dr.prototype.$tag=7;const fr=(e,t,n,r,i)=>{let a=document.createElement(`textarea`);a.id=`inline-text-edit`,a.style.cssText=e,a.rows=1,a.value=t;let o=!1,s=!1;return a.addEventListener(`compositionstart`,()=>{o=!0}),a.addEventListener(`compositionend`,()=>{o=!1}),a.addEventListener(`keydown`,e=>{e.key===`Enter`&&!o?(e.preventDefault(),s=!0,n(a.value)):e.key===`Escape`&&(e.preventDefault(),s=!0,r(t))}),a.addEventListener(`blur`,()=>{s||(s=!0,n(a.value))}),a.addEventListener(`input`,()=>{a.style.width=`auto`,a.style.width=Math.max(a.scrollWidth,40)+`px`,!s&&i(a.value)}),setTimeout(()=>{a.focus(),a.setSelectionRange(t.length,t.length)},0),a},N=(e,t,n)=>e.setAttribute(t,n),pr=(e,t,n)=>e.addEventListener(t,n),mr=(e,t)=>e.appendChild(t),hr=(e,t,n,r)=>{if(!t.includes(`
`)){e.textContent=t;return}let i=t.split(`
`),a=r*1.2,o=-((i.length-1)*a)/2;i.forEach((t,r)=>{let i=document.createElementNS(`http://www.w3.org/2000/svg`,`tspan`);i.setAttribute(`x`,n),i.setAttribute(`dy`,r===0?o:a),i.textContent=t||` `,e.appendChild(i)})},gr={$tag:0};function _r(e){this._0=e}_r.prototype.$tag=1;const vr=(e,t,n,r,i,a,o)=>{let s=e.children;for(let e=0;e<s.length;e++){let c=s[e];c.tagName===`line`&&(c.setAttribute(`x1`,t),c.setAttribute(`y1`,n),c.setAttribute(`x2`,r),c.setAttribute(`y2`,i),c.getAttribute(`pointer-events`)===`none`&&(c.setAttribute(`stroke`,a),c.setAttribute(`stroke-width`,o)))}},yr=(e,t,n,r,i,a,o)=>{n!==0||r!==0?e.setAttribute(`transform`,`translate(${n}, ${r})`):e.removeAttribute(`transform`);let s=e.children;for(let e=0;e<s.length;e++){let n=s[e];n.tagName===`path`&&(n.setAttribute(`d`,t),n.getAttribute(`pointer-events`)===`none`&&(n.setAttribute(`stroke`,i),n.setAttribute(`stroke-width`,a),n.setAttribute(`fill`,o)))}},br=(e,t,n,r,i,a,o,s,c)=>{let l=e.children,u=r.split(`
`),d=u.length,f=i*1.2,p=d*f,m=u.reduce((e,t)=>Math.max(e,t.length),0)*i*.55,h=i*2,g=Math.max(m,h),_=Math.max(p,i*1.2);for(let e=0;e<l.length;e++){let p=l[e];if(p.tagName===`rect`)p.setAttribute(`x`,t-g/2),p.setAttribute(`y`,n-_/2),p.setAttribute(`width`,g),p.setAttribute(`height`,_);else if(p.tagName===`text`){if(p.setAttribute(`x`,t),p.setAttribute(`y`,n),p.setAttribute(`font-size`,i),c?p.setAttribute(`font-family`,c):p.removeAttribute(`font-family`),d===1)p.textContent=r;else{p.innerHTML=``;let e=-(d-1)*f/2;u.forEach((n,r)=>{let i=document.createElementNS(`http://www.w3.org/2000/svg`,`tspan`);i.setAttribute(`x`,t),i.setAttribute(`dy`,r===0?e:f),i.textContent=n,p.appendChild(i)})}p.setAttribute(`fill`,a),o?(p.setAttribute(`stroke`,o),p.setAttribute(`stroke-width`,s)):(p.removeAttribute(`stroke`),p.removeAttribute(`stroke-width`))}}},xr=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},Sr=(e,t,n)=>typeof e[t]==`boolean`?e[t]:n,Cr=(e,t,n)=>typeof e[t]==`number`?e[t]:n,wr=(e,t,n)=>typeof e[t]==`number`?e[t]:n,Tr=(e,t)=>e[t],Er=e=>typeof e==`string`,Dr=(e,t,n)=>typeof e[t]==`string`?e[t]:n,Or=e=>e.pointerId||0,kr=(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h)=>({_changeCallbacks:[],_selectCallbacks:[],_deselectCallbacks:[],_focusCallbacks:[],_blurCallbacks:[],_modeChangeCallbacks:[],_elementAddCallbacks:[],_elementDeleteCallbacks:[],exportSvg:e,importSvg:t,clear:n,destroy:()=>{},hasFocus:r,select:i,selectAll:a,deselect:o,getSelectedIds:s,focus:c,blur:l,getElements:u,getElementById:function(e){return u().find(t=>t.id===e)||null},deleteElements:d,setMode:f,getMode:p,setReadonly:m,isReadonly:h,onChange:function(e){return this._changeCallbacks.push(e),()=>{this._changeCallbacks=this._changeCallbacks.filter(t=>t!==e)}},onSelect:function(e){return this._selectCallbacks.push(e),()=>{this._selectCallbacks=this._selectCallbacks.filter(t=>t!==e)}},onDeselect:function(e){return this._deselectCallbacks.push(e),()=>{this._deselectCallbacks=this._deselectCallbacks.filter(t=>t!==e)}},onFocus:function(e){return this._focusCallbacks.push(e),()=>{this._focusCallbacks=this._focusCallbacks.filter(t=>t!==e)}},onBlur:function(e){return this._blurCallbacks.push(e),()=>{this._blurCallbacks=this._blurCallbacks.filter(t=>t!==e)}},onModeChange:function(e){return this._modeChangeCallbacks.push(e),()=>{this._modeChangeCallbacks=this._modeChangeCallbacks.filter(t=>t!==e)}},onElementAdd:function(e){return this._elementAddCallbacks.push(e),()=>{this._elementAddCallbacks=this._elementAddCallbacks.filter(t=>t!==e)}},onElementDelete:function(e){return this._elementDeleteCallbacks.push(e),()=>{this._elementDeleteCallbacks=this._elementDeleteCallbacks.filter(t=>t!==e)}},_fireChange:function(){this._changeCallbacks.forEach(e=>e())},_fireSelect:function(e){this._selectCallbacks.forEach(t=>t(e))},_fireDeselect:function(){this._deselectCallbacks.forEach(e=>e())},_fireFocus:function(){this._focusCallbacks.forEach(e=>e())},_fireBlur:function(){this._blurCallbacks.forEach(e=>e())},_fireModeChange:function(e){this._modeChangeCallbacks.forEach(t=>t(e))},_fireElementAdd:function(e){this._elementAddCallbacks.forEach(t=>t(e))},_fireElementDelete:function(e){this._elementDeleteCallbacks.forEach(t=>t(e))}}),Ar=(e,t)=>e.getAttribute(t),jr=e=>Array.from(e.children),Mr=e=>e.tagName.toLowerCase(),Nr=e=>e.textContent||``,Pr=e=>{let t=new DOMParser().parseFromString(e,`image/svg+xml`);return t.querySelector(`parsererror`)?null:t.documentElement},Fr=e=>{let t=e.closest(`[data-id]`);return t?t.dataset.id:null},Ir=()=>performance.now(),Lr=e=>window.addEventListener(`keydown`,e),Rr=()=>{let e=document.activeElement;if(!e)return!1;let t=e.tagName.toLowerCase();return t===`input`||t===`textarea`||t===`select`||e.isContentEditable},zr=(e,t,n)=>{navigator.clipboard.writeText(e).then(()=>t()).catch(()=>n())},Br=(e,t,n)=>{let r=new Blob([e],{type:n}),i=URL.createObjectURL(r),a=document.createElement(`a`);a.href=i,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i)},Vr=e=>{let t=document.getElementById(e);t&&t.hidePopover()},Hr=(e,t)=>{let n=document.createElement(`input`);n.type=`file`,n.accept=e,n.onchange=async e=>{let n=e.target.files[0];n&&t(await n.text())},n.click()},Ur=e=>window.open(e,`_blank`),Wr=(e,t)=>{let n=document.getElementById(e);if(!n)return;let r=t.currentTarget.getBoundingClientRect();n.showPopover(),n.style.left=r.left+r.width/2+`px`,n.style.top=r.bottom+6+`px`,n.style.transform=`translateX(-50%)`},Gr=(e,t)=>{new ResizeObserver(e=>{for(let n of e){let{width:e,height:r}=n.contentRect;t(e,r)}}).observe(e)},Kr=(e,t)=>{try{t&&t.parentNode===e&&e.removeChild(t)}catch{}},qr=e=>e._fireBlur(),Jr=e=>e._fireChange(),Yr=e=>e._fireDeselect(),Xr=(e,t)=>e._fireElementAdd(t),Zr=(e,t)=>e._fireElementDelete(t),Qr=e=>e._fireFocus(),$r=(e,t)=>e._fireModeChange(t),ei=(e,t)=>e._fireSelect(t),ti=e=>{globalThis.__moonlightEditorModule={createEditor:e}},ni={method_0:I,method_1:_l,method_2:eu,method_3:Dc},ri={tried:!1,exports:void 0},ii=[e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h,g,_,v,y,b,te,ne,re,ie,ae,oe,se,ce,le],ai=[1414808916,67458373,268701696,4195348,1073807360,1091917141,1108,65604,1073741824,1140850753,1346716752,1431634004,1365595476,1073758208,16777217,66816,1364284433,89478484,0],oi=[x,ue,x,de,fe,pe,me,he,ge,_e,ve,ye,be,xe,Se,Ce,we,Te,Ee,De,Oe,ke,Ae,je,Me,Ne],si=[0,0,0,0,1073741824,1500076437,1431590229,1448432917,1091896580,1079333904,1146442053,1146111296,1163220304,1073758208,-1773927360,1431721317,1413824581,1075134801,1431671125,1363170645,261],ci=[e,Pe,Fe,Ie,Le,Re,ze,Be,Ve,He,Ue,We,Ge,Ke,qe,Je,Ye,Xe,Ze,Qe,$e,et,tt,nt,rt,it],li={mantissa:x,exponent:0},ui={val:0},P={current_subscriber:void 0,current_owner:void 0,current_cleanups:at,batch_depth:0,pending_effects:[],pending_ids:[]},di=`http://www.w3.org/2000/svg`,fi={_0:`disabled`,_1:new S(`true`)},pi={_0:`disabled`,_1:new S(`true`)},mi={_0:`readonly`,_1:new S(`true`)},hi={_0:`required`,_1:new S(`true`)},gi={_0:`checked`,_1:new S(`true`)},_i=`INVALID_PARENT`,vi=`ORPHAN_CONNECTION`,yi=`NEGATIVE_DIMENSION`,bi=`var(--ml-stroke)`,xi=`var(--ml-text)`,Si={can_move:!0,can_resize:!0,can_edit:!0,can_delete:!0,can_connect:!0,can_add_child:!0},Ci={can_move:!0,can_resize:!1,can_edit:!1,can_delete:!0,can_connect:!1,can_add_child:!1},wi={can_move:!0,can_resize:!0,can_edit:!0,can_delete:!0,can_connect:!0,can_add_child:!1},Ti={can_move:!0,can_resize:!0,can_edit:!0,can_delete:!0,can_connect:!1,can_add_child:!1},Ei={background:`#ffffff`,stroke:`#000000`,fill:`transparent`,text:`#000000`,ui_bg:`rgba(255,255,255,0.98)`,ui_bg_hover:`#f3f4f6`,ui_bg_muted:`#f9fafb`,ui_border:`#d1d5db`,ui_text:`#1f2937`,ui_text_muted:`#6b7280`,ui_accent:`#2563eb`},Di={background:`#1a1a1a`,stroke:`#ffffff`,fill:`transparent`,text:`#ffffff`,ui_bg:`rgba(31,31,31,0.98)`,ui_bg_hover:`#374151`,ui_bg_muted:`#27272a`,ui_border:`#4b5563`,ui_text:`#f3f4f6`,ui_text_muted:`#9ca3af`,ui_accent:`#60a5fa`},Oi={name:`Black`,light:`#000000`,dark:`#ffffff`},ki={name:`Gray`,light:`#6b7280`,dark:`#9ca3af`},Ai={name:`Red`,light:`#dc2626`,dark:`#f87171`},ji={name:`Orange`,light:`#ea580c`,dark:`#fb923c`},Mi={name:`Yellow`,light:`#ca8a04`,dark:`#facc15`},Ni={name:`Green`,light:`#16a34a`,dark:`#4ade80`},Pi={name:`Blue`,light:`#2563eb`,dark:`#60a5fa`},Fi={name:`Purple`,light:`#9333ea`,dark:`#c084fc`},Ii=new ct(1),Li={val:0},Ri={_0:`viewBox`,_1:new S(`0 0 24 24`)},zi={_0:`fill`,_1:new S(`none`)},Bi={_0:`stroke`,_1:new S(`currentColor`)},Vi={_0:`stroke-width`,_1:new S(`2`)},Hi={_0:`stroke-linecap`,_1:new S(`round`)},Ui={_0:`stroke-linejoin`,_1:new S(`round`)},Wi={_0:`style`,_1:new S(`display: block;`)},Gi={_0:`popover`,_1:new lt(`manual`)},Ki={scroll_x:0,scroll_y:0,zoom:1},qi={x:0,y:0},Ji={resample_dist:4,epsilon:2,max_error:8},Yi=new ct(1),Xi=new ct(1),Zi=new ct(1),Qi={x:0,y:0},$i=`width: 100%; text-align: left; background: none; border: none; cursor: pointer; padding: 4px 8px;`,ea=`display: flex; align-items: center; justify-content: space-between; padding: 8px; background: #f0f0f0; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: bold; color: #333; margin-bottom: 4px; user-select: none;`,ta=`color: #666;`,na=`width: 60px; padding: 2px 4px; border: 1px solid #ccc; border-radius: 3px; font-size: 10px;`,ra=`flex: 1; padding: 6px 8px; border: 1px solid #ccc; border-radius: 3px; cursor: pointer; font-size: 11px; transition: all 0.2s;`,ia=`flex: 1; padding: 2px 6px; border: 1px solid #ddd; border-radius: 3px; font-family: monospace; font-size: 11px; box-sizing: border-box;`,aa=`font-size: 11px; color: #888; min-width: 12px;`,oa=`font-family: monospace; font-size: 11px; padding: 2px 4px; background: #f5f5f5; border-radius: 3px; min-width: 36px; text-align: center;`,sa=[{_0:`―`,_1:void 0},{_0:`--`,_1:`8,4`},{_0:`··`,_1:`2,4`},{_0:`-·`,_1:`8,4,2,4`}],ca=`padding: 2px 6px; border: 1px solid #ccc; border-radius: 3px; cursor: pointer; font-size: 10px;`,la=[{_0:`Sans`,_1:void 0},{_0:`Serif`,_1:`serif`},{_0:`Mono`,_1:`monospace`}],ua=`margin-bottom: 8px;`,da=`width: 48px; padding: 2px 4px; border: 1px solid #ddd; border-radius: 3px; font-family: monospace; font-size: 11px; box-sizing: border-box;`,fa=`padding: 4px 0;`,pa=`tooltip-grid-snap`,ma=`display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 2px; padding: 4px 6px; cursor: pointer; border: 1px solid; border-radius: 4px; min-width: 36px; height: 40px;`,ha={_0:`min`,_1:new lt(`0`)},ga={_0:`step`,_1:new lt(`0.5`)},_a=new mt(40),va=new ht(60,35),ya=new yt(`Text`,new ct(24)),ba=new ct(2),xa=new ct(2),Sa=new ct(1),Ca=new ct(2),wa=new ct(2),Ta=new ct(1),Ea=new mt(35),Da=new yt(`Moonbit`,new ct(14)),Oa=new yt(`Luna`,new ct(16)),ka=new yt(`JS`,new ct(18)),Aa=new gt(130,65),ja=new gt(280,65),Ma=new ht(50,28),Na=new yt(`Excalidraw`,new ct(12)),Pa=new yt(`Moonlight`,new ct(14)),Fa=new yt(`Svg`,new ct(16)),Ia=new gt(200,160),La=new gt(150,195),Ra=new gt(300,195),za={_0:`fill`,_1:`none`},Ba={_0:`marker-start`,_1:`url(#arrow-start-context)`},Va={_0:`marker-end`,_1:`url(#arrow-end-context)`},Ha={_0:`markerWidth`,_1:`10`},Ua={_0:`markerHeight`,_1:`10`},Wa={_0:`refY`,_1:`5`},Ga={_0:`orient`,_1:`auto`},Ka={_0:`markerUnits`,_1:`strokeWidth`},qa={_0:`fill`,_1:`context-stroke`},Ja={_0:`class`,_1:`line-handle-group`},Ya={_0:`fill`,_1:`transparent`},Xa={_0:`fill`,_1:`#0066ff`},Za={_0:`stroke`,_1:`#ffffff`},Qa={_0:`stroke-width`,_1:`2`},$a={_0:`pointer-events`,_1:`none`},eo={_0:`class`,_1:`line-handle-visible`},to={_0:`style`,_1:`transition: r 0.15s ease, fill 0.15s ease;`},no={_0:`fill`,_1:`#0066ff`},ro={_0:`stroke`,_1:`#ffffff`},io={_0:`stroke-width`,_1:`1`},ao={_0:`r`,_1:`5`},oo={_0:`fill`,_1:`rgba(100, 100, 255, 0.15)`},so={_0:`stroke`,_1:`rgba(100, 100, 255, 0.4)`},co={_0:`stroke-width`,_1:`1`},lo={_0:`cursor`,_1:`crosshair`},uo={_0:`class`,_1:`anchor-point`},fo={_0:`r`,_1:`8`},po={_0:`fill`,_1:`rgba(255, 200, 0, 0.5)`},mo={_0:`stroke`,_1:`#ffc800`},ho={_0:`stroke-width`,_1:`2`},go={_0:`pointer-events`,_1:`none`},_o={_0:`pointer-events`,_1:`none`},vo={_0:`x`,_1:`0`},yo={_0:`y`,_1:`0`},bo={_0:`filter`,_1:`url(#doc-shadow)`},xo={_0:`pointer-events`,_1:`none`},So={_0:`x`,_1:`0`},Co={_0:`y`,_1:`0`},wo={_0:`fill`,_1:`none`},To={_0:`stroke-width`,_1:`1`},Eo={_0:`pointer-events`,_1:`none`},Do={_0:`r`,_1:`4`},Oo={_0:`fill`,_1:`rgba(0, 102, 255, 0.15)`},ko={_0:`stroke`,_1:`rgba(0, 102, 255, 0.35)`},Ao={_0:`stroke-width`,_1:`1`},jo={_0:`pointer-events`,_1:`none`},Mo={_0:`cursor`,_1:`move`},No={_0:`pointer-events`,_1:`all`},Po={_0:`cursor`,_1:`move`},Fo={_0:`pointer-events`,_1:`all`},Io={_0:`cursor`,_1:`move`},Lo={_0:`pointer-events`,_1:`all`},Ro={_0:`stroke`,_1:`transparent`},zo={_0:`stroke-width`,_1:`24`},Bo={_0:`stroke`,_1:`rgba(0, 102, 255, 0.3)`},Vo={_0:`stroke-linecap`,_1:`round`},Ho={_0:`pointer-events`,_1:`none`},Uo={_0:`pointer-events`,_1:`none`},Wo={_0:`data-element-type`,_1:`line`},Go={_0:`cursor`,_1:`move`},Ko={_0:`cursor`,_1:`move`},qo={_0:`cursor`,_1:`move`},Jo={_0:`fill`,_1:`transparent`},Yo={_0:`pointer-events`,_1:`all`},Xo={_0:`text-anchor`,_1:`middle`},Zo={_0:`dominant-baseline`,_1:`middle`},Qo={_0:`pointer-events`,_1:`none`},$o={_0:`data-element-type`,_1:`text`},es={_0:`cursor`,_1:`move`},ts={_0:`stroke-width`,_1:`0.5`},ns={_0:`stroke-width`,_1:`0.5`},rs={_0:`stroke`,_1:`transparent`},is={_0:`stroke-width`,_1:`24`},as={_0:`pointer-events`,_1:`none`},os={_0:`data-element-type`,_1:new S(`line`)},ss={_0:`cursor`,_1:new S(`move`)},cs={_0:`fill`,_1:`none`},ls={_0:`stroke`,_1:`transparent`},us={_0:`stroke-width`,_1:`16`},ds={_0:`stroke-linecap`,_1:`round`},fs={_0:`stroke-linejoin`,_1:`round`},ps={_0:`pointer-events`,_1:`none`},ms={_0:`data-element-type`,_1:new S(`path`)},hs={_0:`cursor`,_1:new S(`move`)},gs={_0:`fill`,_1:`transparent`},_s={_0:`pointer-events`,_1:`all`},vs={_0:`text-anchor`,_1:`middle`},ys={_0:`dominant-baseline`,_1:`middle`},bs={_0:`pointer-events`,_1:`none`},xs={_0:`data-element-type`,_1:new S(`text`)},Ss={_0:`cursor`,_1:new S(`move`)},Cs={_0:`cursor`,_1:`move`},ws={_0:`pointer-events`,_1:`all`},Ts={_0:`cursor`,_1:`move`},Es={_0:`pointer-events`,_1:`all`},Ds={_0:`cursor`,_1:`move`},Os={_0:`pointer-events`,_1:`all`},ks={_0:0,_1:0,_2:0,_3:0},As={_0:`fill`,_1:new S(`rgba(0, 102, 255, 0.1)`)},js={_0:`stroke`,_1:new S(`#0066ff`)},Ms={_0:`stroke-width`,_1:new S(`1`)},Ns={_0:`stroke-dasharray`,_1:new S(`4,2`)},Ps={_0:`pointer-events`,_1:new S(`none`)},Fs={_0:0,_1:0},Is={_0:`r`,_1:new S(`10`)},Ls={_0:`fill`,_1:new S(`rgba(0, 200, 100, 0.4)`)},Rs={_0:`stroke`,_1:new S(`#00c864`)},zs={_0:`stroke-width`,_1:new S(`2`)},Bs={_0:`pointer-events`,_1:new S(`none`)},Vs={_0:`id`,_1:`doc-shadow`},Hs={_0:`x`,_1:`-50%`},Us={_0:`y`,_1:`-50%`},Ws={_0:`width`,_1:`200%`},Gs={_0:`height`,_1:`200%`},Ks={_0:`dx`,_1:`0`},qs={_0:`dy`,_1:`2`},Js={_0:`stdDeviation`,_1:`4`},Ys=new ct(16),Xs=new mt(40),Zs=new ht(60,35),Qs=new yt(`Text`,new ct(24)),$s={_0:`aria-label`,_1:new S(`Grid Snap`)},ec={_0:`popover`,_1:new lt(`manual`)},tc={_0:`width`,_1:new S(`100%`)},nc={_0:`height`,_1:new S(`100%`)},rc={_0:`style`,_1:new S(`position: absolute; top: 0; left: 0; pointer-events: none;`)},ic={_0:`style`,_1:new S(`padding: 8px; background: #f5f5f5; border: 1px solid #d0d0d0; border-radius: 6px; cursor: pointer; display: flex; align-items: center; justify-content: center; color: #555;`)},ac={_0:`aria-label`,_1:new S(`Close`)},oc={_0:`title`,_1:new S(`Close`)},sc={_0:`style`,_1:new S(`position: absolute; top: 8px; right: 8px; padding: 10px; background: rgba(59, 130, 246, 0.95); border: none; border-radius: 8px; cursor: pointer; color: white; box-shadow: 0 2px 8px rgba(59, 130, 246, 0.4); z-index: 10; display: flex; align-items: center; justify-content: center;`)},cc={_0:`aria-label`,_1:new S(`Edit in fullscreen`)},lc={_0:`title`,_1:new S(`Edit in fullscreen`)};new mt(40),new ht(60,35),new yt(`Text`,new ct(16));const uc=St();function dc(e){T()}function fc(e){return T()}function pc(e){return T()}function mc(e){return T()}function hc(e){return T()}function gc(e,t){return e===0?t===0:t===1}function _c(e,t){dc(`${e}\n  at ${xl(t)}\n`)}function vc(e,t){return fc(`${e}\n  at ${xl(t)}\n`)}function yc(e,t){return pc(`${e}\n  at ${xl(t)}\n`)}function bc(e,t){return mc(`${e}\n  at ${xl(t)}\n`)}function xc(e,t){return hc(`${e}\n  at ${xl(t)}\n`)}function Sc(e,t,n,r,i){if(e===n&&t<r){let a=0;for(;;){let o=a;if(o<i){let i=t+o|0,s=r+o|0;E(n,s),E(e,i),e[i]=n[s],a=o+1|0;continue}else return}}else{let a=i-1|0;for(;;){let i=a;if(i>=0){let o=t+i|0,s=r+i|0;E(n,s),E(e,o),e[o]=n[s],a=i-1|0;continue}else return}}}function Cc(e,t,n,r,i){if(e===n&&t<r){let a=0;for(;;){let o=a;if(o<i){let i=t+o|0,s=r+o|0;E(n,s),E(e,i),e[i]=n[s],a=o+1|0;continue}else return}}else{let a=i-1|0;for(;;){let i=a;if(i>=0){let o=t+i|0,s=r+i|0;E(n,s),E(e,o),e[o]=n[s],a=i-1|0;continue}else return}}}function wc(e,t,n,r,i){Sc(e,t,n,r,i)}function Tc(e,t,n,r,i){Cc(e,t,n,r,i)}function Ec(e){return{val:``}}function Dc(e,t){let n=e;n.val=`${n.val}${String.fromCodePoint(t)}`}function Oc(e,t){return(((Math.imul(e-55296|0,1024)|0)+t|0)-56320|0)+65536|0}function kc(e,t){return!bv(e,t)}function Ac(e,t){return!gc(e,t)}function jc(e,t){return!x_(e,t)}function Mc(e,t){return!nd(e,t)}function Nc(e,t){return!Af(e,t)}function Pc(e,t){let n=e.length;return t>=0&&t<n?(E(e,t),e[t]):T()}function Fc(e,t){let n=e.length;return t>=0&&t<n?(E(e,t),e[t]):T()}function Ic(e,t){let n=e.length;return t>=0&&t<n?(E(e,t),e[t]):T()}function Lc(e,t){let n=e.length;return t>=0&&t<n?(E(e,t),e[t]):T()}function Rc(e,t){let n=e.length;return t>=0&&t<n?(E(e,t),e[t]):T()}function zc(e,t){let n=e.length;return t>=0&&t<n?(E(e,t),e[t]):T()}function F(e,t){let n=e.length;return t>=0&&t<n?(E(e,t),e[t]):T()}function Bc(e,t){let n=e.length;return t>=0&&t<n?(E(e,t),e[t]):T()}function Vc(e,t){let n=e.length;return t>=0&&t<n?(E(e,t),e[t]):T()}function Hc(e,t){let n=e.length;return t>=0&&t<n?(E(e,t),e[t]):T()}function Uc(e,t){let n=e.length;return t>=0&&t<n?(E(e,t),e[t]):T()}function Wc(e,t){let n=e.length;return t>=0&&t<n?(E(e,t),e[t]):T()}function Gc(e,t){let n=e.length;return t>=0&&t<n?(E(e,t),e[t]):T()}function Kc(e,t){let n=e.end-e.start|0,r=t.end-t.start|0;if(r>0)if(n>=r){let i=xt(256,r),a=r-1|0,o=0;for(;;){let e=o;if(e<a){let n=t.str,a=t.start+e|0,s=n.charCodeAt(a)&255;E(i,s),i[s]=(r-1|0)-e|0,o=e+1|0;continue}else break}let s=0;for(;;){let a=s;if(a<=(n-r|0)){let n=r-1|0,o=0;for(;;){let r=o;if(r<=n){let n=a+r|0,i=e.str,s=e.start+n|0,c=i.charCodeAt(s),l=t.str,u=t.start+r|0;if(c!==l.charCodeAt(u))break;o=r+1|0;continue}else return a}let c=(a+r|0)-1|0,l=e.str,u=e.start+c|0,d=l.charCodeAt(u)&255;E(i,d),s=a+i[d]|0;continue}else break}return}else return;else return 0}function qc(e,t){let n=e.end-e.start|0,r=t.end-t.start|0;if(r>0)if(n>=r){let i=t.str,a=t.start+0|0,o=i.charCodeAt(a),s=n-r|0,c=0;for(;c<=s;){for(;;){let t;if(c<=s){let n=c,r=e.str,i=e.start+n|0;t=r.charCodeAt(i)!==o}else t=!1;if(t){c=c+1|0;continue}else break}if(c<=s){let n=1;for(;;){let i=n;if(i<r){let r=c+i|0,a=e.str,o=e.start+r|0,s=a.charCodeAt(o),l=t.str,u=t.start+i|0;if(s!==l.charCodeAt(u))break;n=i+1|0;continue}else return c}c=c+1|0}}return}else return;else return 0}function Jc(e,t){return(t.end-t.start|0)<=4?qc(e,t):Kc(e,t)}function Yc(e,t){let n=e.end-e.start|0,r=t.end-t.start|0;if(r>0)if(n>=r){let i=xt(256,r),a=r-1|0;for(;;){let e=a;if(e>0){let n=t.str,r=t.start+e|0,o=n.charCodeAt(r)&255;E(i,o),i[o]=e,a=e-1|0;continue}else break}let o=n-r|0;for(;;){let n=o;if(n>=0){let a=0;for(;;){let i=a;if(i<r){let r=n+i|0,o=e.str,s=e.start+r|0,c=o.charCodeAt(s),l=t.str,u=t.start+i|0;if(c!==l.charCodeAt(u))break;a=i+1|0;continue}else return n}let s=e.str,c=e.start+n|0,l=s.charCodeAt(c)&255;E(i,l),o=n-i[l]|0;continue}else break}return}else return;else return n}function Xc(e,t){let n=e.end-e.start|0,r=t.end-t.start|0;if(r>0)if(n>=r){let i=t.str,a=t.start+0|0,o=i.charCodeAt(a),s=n-r|0;for(;s>=0;){for(;;){let t;if(s>=0){let n=s,r=e.str,i=e.start+n|0;t=r.charCodeAt(i)!==o}else t=!1;if(t){s=s-1|0;continue}else break}if(s>=0){let n=1;for(;;){let i=n;if(i<r){let r=s+i|0,a=e.str,o=e.start+r|0,c=a.charCodeAt(o),l=t.str,u=t.start+i|0;if(c!==l.charCodeAt(u))break;n=i+1|0;continue}else return s}s=s-1|0}}return}else return;else return n}function Zc(e,t){return(t.end-t.start|0)<=4?Xc(e,t):Yc(e,t)}function Qc(e,t,n){let r;return r=n===void 0?e.end-e.start|0:n,t>=0&&t<=r&&r<=(e.end-e.start|0)?{str:e.str,start:e.start+t|0,end:e.start+r|0}:yc(`Invalid index for View`,`@moonbitlang/core/builtin:stringview.mbt:111:5-111:36`)}function $c(e){let t=Jc(e,{str:`:`,start:0,end:1});if(t!==void 0){let n=t;return n>0&&(n+1|0)<(e.end-e.start|0)?{_0:Qc(e,0,n),_1:Qc(e,n+1|0,void 0)}:void 0}}function el(e){_L:if(Yl(e,1,0,e.length))if(e.charCodeAt(0)===64){let t=Ql(e,1,0,e.length),n;n=t===void 0?e.length:t;let r={str:e,start:n,end:e.length},i=Jc(r,{str:`:`,start:0,end:1});if(i===void 0)return T();{let e=i,t=Qc(r,0,e),n=Zc(r,{str:`-`,start:0,end:1});if(n===void 0)return T();{let i=n;if((i+1|0)<(r.end-r.start|0)){let n=$c(Qc(r,i+1|0,void 0));if(n===void 0)return T();{let a=n,o=a._0,s=a._1,c=Qc(r,0,i);_L$2:{let n=Zc(c,{str:`:`,start:0,end:1});if(n===void 0)break _L$2;{let r=Zc(Qc(c,0,n),{str:`:`,start:0,end:1});if(r===void 0)break _L$2;{let n=r;if((n+1|0)<(c.end-c.start|0)){let r=$c(Qc(c,n+1|0,void 0));if(r===void 0)return T();{let i=r,a=i._0,l=i._1;return n>(e+1|0)?{pkg:t,filename:Qc(c,e+1|0,n),start_line:a,start_column:l,end_line:o,end_column:s}:T()}}else return T()}}}return T()}}else return T()}}}else break _L;else break _L;return T()}function I(e,t){let n=e;n.val=`${n.val}${t}`}function tl(e,t){let n=(e.acc>>>0)+((Math.imul(t,-1028477379)|0)>>>0)|0;e.acc=Math.imul(n<<17|n>>>15|0,668265263)|0}function nl(e,t){e.acc=(e.acc>>>0)+4|0,tl(e,t)}function rl(e,t){nl(e,t)}function il(e,t){Lf(t,e)}function al(e,t){If(t,e)}function ol(e,t){return kf(e,t)<0}function sl(e,t){return kf(e,t)>0}function cl(e,t){return kf(e,t)<=0}function ll(e,t){return kf(e,t)>=0}function ul(e){let t=e.acc;return t^=t>>>15|0,t=Math.imul(t,-2048144777)|0,t^=t>>>13|0,t=Math.imul(t,-1028477379)|0,t^=t>>>16|0,t}function dl(e){return ul(e)}function fl(e){return{acc:(e>>>0)+374761393|0}}function pl(e){let t;return t=e===void 0?uc:e,fl(t)}function ml(e){let t=pl(void 0);return il(t,e),dl(t)}function hl(e){let t=pl(void 0);return al(t,e),dl(t)}function gl(e,t,n){let r=e.length,i;if(n===void 0)i=r;else{let e=n;i=e<0?r+e|0:e}let a=t<0?r+t|0:t;if(a>=0&&a<=i&&i<=r){let t;if(a<r){let n=e.charCodeAt(a);t=56320<=n&&n<=57343}else t=!1;if(t)return new Ct(Et);let n;if(i<r){let t=e.charCodeAt(i);n=56320<=t&&t<=57343}else n=!1;return n?new Ct(Et):new wt({str:e,start:a,end:i})}else return new Ct(Tt)}function _l(e,t,n,r){let i;_L:{_L$2:{let e=gl(t,n,n+r|0);if(e.$tag===1)i=e._0;else{e._0;break _L$2}break _L}i=T()}eu(e,i)}function vl(e){let t=Ec(0);return Ku(e,{self:t,method_table:ni}),t.val}function L(e){let t=Ec(0);return Ip(e,{self:t,method_table:ni}),t.val}function yl(e){let t=Ec(0),n={self:t,method_table:ni};return e?n.method_table.method_0(n.self,`true`):n.method_table.method_0(n.self,`false`),t.val}function bl(e){let t=Ec(0);return p_(e,{self:t,method_table:ni}),t.val}function xl(e){let t=Ec(0);return Kf(e,{self:t,method_table:ni}),t.val}function Sl(e){let t=Ec(0);return qu(e,{self:t,method_table:ni}),t.val}function Cl(e,t){return Dt(e,t)}function wl(e,t){return Ot(e,t)}function Tl(e){return e.str.substring(e.start,e.end)}function El(e){return e()}function Dl(e){return e()}function Ol(e){return e()}function kl(e){return e()}function Al(e){return e()}function jl(e){return e()}function Ml(e){return e()}function Nl(e){return e()}function Pl(e){return t=>{for(;;){let n=El(e);if(n===void 0)return 1;if(t(n)!==1)return 0}}}function Fl(e){return t=>{for(;;){let n=Dl(e);if(n===void 0)return 1;if(t(n)!==1)return 0}}}function Il(e){return t=>{for(;;){let n=Ol(e);if(n===void 0)return 1;if(t(n)!==1)return 0}}}function Ll(e){return t=>{for(;;){let n=kl(e);if(n===-1)return 1;if(t(n)!==1)return 0}}}function Rl(e){return t=>{for(;;){let n=Al(e);if(n===void 0)return 1;if(t(n)!==1)return 0}}}function zl(e){return t=>{for(;;){let n=jl(e);if(n===void 0)return 1;if(t(n)!==1)return 0}}}function Bl(e){return t=>{for(;;){let n=Ml(e);if(n===void 0)return 1;if(t(n)!==1)return 0}}}function Vl(e){let t=e.start,n=e.end,r={val:t};return()=>{if(r.val<n){let t=e.str,n=r.val,i=t.charCodeAt(n);if(55296<=i&&i<=56319&&(r.val+1|0)<e.end){let t=e.str,n=r.val+1|0,a=t.charCodeAt(n);if(56320<=a&&a<=57343)return r.val=r.val+2|0,Oc(i,a)}return r.val=r.val+1|0,i}else return-1}}function Hl(e){return Ll(Vl(e))}function Ul(e){return Nl(e)}function Wl(e){return e}function Gl(e){let t=e.start,n=e.end,r={val:t},i={val:0};return Wl(()=>{if(r.val<n){let t=e.str,n=r.val,a=t.charCodeAt(n);if(55296<=a&&a<=56319&&(r.val+1|0)<e.end){let t=e.str,n=r.val+1|0,o=t.charCodeAt(n);if(56320<=o&&o<=57343){let e={_0:i.val,_1:Oc(a,o)};return r.val=r.val+2|0,i.val=i.val+1|0,e}}let o={_0:i.val,_1:a};return r.val=r.val+1|0,i.val=i.val+1|0,o}else return})}function Kl(e,t,n){let r;return r=n===void 0?e.length:n,t>=0&&t<=r&&r<=e.length?{str:e,start:t,end:r}:yc(`Invalid index for View`,`@moonbitlang/core/builtin:stringview.mbt:374:5-374:36`)}function ql(e){let t=Ec(Math.imul(e.end-e.start|0,4)|0),n=e.end-e.start|0,r=0;for(;;){let i=r;if(i<n){let n=e.buf[e.start+i|0];Dc(t,n),r=i+1|0;continue}else break}return t.val}function Jl(e,t,n,r){let i;i=r===void 0?e.length:r;let a=n,o=0;for(;;){let n=a,r=o;if(n<i&&r<t){let t=e.charCodeAt(n);if(55296<=t&&t<=56319&&(n+1|0)<i){let t=n+1|0,i=e.charCodeAt(t);if(56320<=i&&i<=57343){a=n+2|0,o=r+1|0;continue}else _c(`invalid surrogate pair`,`@moonbitlang/core/builtin:string.mbt:463:9-463:40`)}a=n+1|0,o=r+1|0;continue}else return r===t&&n===i}}function Yl(e,t,n,r){let i;i=r===void 0?e.length:r;let a=n,o=0;for(;;){let n=a,r=o;if(n<i&&r<t){let t=e.charCodeAt(n);if(55296<=t&&t<=56319&&(n+1|0)<i){let t=n+1|0,i=e.charCodeAt(t);if(56320<=i&&i<=57343){a=n+2|0,o=r+1|0;continue}else _c(`invalid surrogate pair`,`@moonbitlang/core/builtin:string.mbt:491:9-491:40`)}a=n+1|0,o=r+1|0;continue}else return r>=t}}function Xl(e,t,n,r){let i=0,a=r;for(;(a-1|0)>=n&&i<t;){let t=a-1|0,n=e.charCodeAt(t);a=56320<=n&&n<=57343?a-2|0:a-1|0,i=i+1|0}return i<t||a<n?void 0:a}function Zl(e,t,n,r){if(n>=0&&n<=r){let i=n,a=0;for(;i<r&&a<t;){let t=i,n=e.charCodeAt(t);i=55296<=n&&n<=56319?i+2|0:i+1|0,a=a+1|0}return a<t||i>=r?void 0:i}else return xc(`Invalid start index`,`@moonbitlang/core/builtin:string.mbt:366:5-366:33`)}function Ql(e,t,n,r){let i;return i=r===void 0?e.length:r,t>=0?Zl(e,t,n,i):Xl(e,-t|0,n,i)}function $l(e,t){t(t=>(Dc(e,t),1))}function eu(e,t){let n=e;n.val=`${n.val}${Tl(t)}`}function tu(e,t){return Jc({str:e,start:0,end:e.length},t)}function nu(e,t){let n=Gl(e);for(;;){let e=Ul(n);if(e===void 0)break;{let n=e,r=n._0,i=n._1;if(t(i))return r;continue}}}function ru(e,t){return nu({str:e,start:0,end:e.length},t)}function iu(e,t){let n=Jc(e,t);return n===void 0?!1:n===0}function au(e,t){return iu({str:e,start:0,end:e.length},t)}function R(e,t){At(e,t)}function ou(e,t){At(e,t)}function z(e,t){At(e,t)}function su(e,t){At(e,t)}function B(e,t){At(e,t)}function cu(e,t){At(e,t)}function lu(e,t){At(e,t)}function uu(e,t){At(e,t)}function du(e,t){At(e,t)}function V(e,t){At(e,t)}function fu(e,t){At(e,t)}function pu(e,t){At(e,t)}function mu(e,t){At(e,t)}function hu(e,t){At(e,t)}function gu(e,t){At(e,t)}function _u(e,t){At(e,t)}function vu(e,t){At(e,t)}function yu(e,t){At(e,t)}function bu(e,t){At(e,t)}function xu(e,t){At(e,t)}function Su(e,t){At(e,t)}function Cu(e,t){At(e,t)}function wu(e,t){return Jc(e,t)!==void 0}function Tu(e,t){return wu({str:e,start:0,end:e.length},t)}function Eu(e){let t=e.length,n={val:0};return()=>{if(n.val<t){let r=n.val,i=e.charCodeAt(r);if(55296<=i&&i<=56319&&(n.val+1|0)<t){let t=n.val+1|0,r=e.charCodeAt(t);if(56320<=r&&r<=57343){let e=Oc(i,r);return n.val=n.val+2|0,e}}return n.val=n.val+1|0,i}else return-1}}function Du(e){return Ll(Eu(e))}function Ou(e,t){return e(t)}function ku(e,t){return e(t)}function Au(e,t){return e(t)}function ju(e){return String.fromCodePoint(e)}function Mu(e,t){let n=t.end-t.start|0;if(n===0){let t=Hl(e);return e=>t(t=>e(Kl(ju(t),0,void 0)))}let r={val:e};return zl(()=>{let e=r.val;if(e!==void 0){let i=e,a=Jc(i,t);if(a===void 0)return r.val=void 0,i;{let e=a;return r.val=Qc(i,e+n|0,void 0),Qc(i,0,e)}}})}function Nu(e,t){return Mu({str:e,start:0,end:e.length},t)}function Pu(e,t){let n={val:It};e(e=>(t(e),1));let r=n.val;switch(r.$tag){case 0:return;case 1:r._0;return;case 2:return r._0;case 3:T();return;default:T();return}}function Fu(e,t){let n={val:It};e(e=>(t(e),1));let r=n.val;switch(r.$tag){case 0:return;case 1:r._0;return;case 2:return r._0;case 3:T();return;default:T();return}}function Iu(e,t){let n={val:It};e(e=>(t(e),1));let r=n.val;switch(r.$tag){case 0:return;case 1:r._0;return;case 2:return r._0;case 3:T();return;default:T();return}}function Lu(e,t){let n={val:It};e(e=>(t(e),1));let r=n.val;switch(r.$tag){case 0:return;case 1:r._0;return;case 2:return r._0;case 3:T();return;default:T();return}}function Ru(e){let t=[];return Pu(e,e=>{lu(t,e)}),t}function zu(e){let t=[];return Fu(e,e=>{su(t,e)}),t}function Bu(e){let t=[];return Iu(e,e=>{bu(t,e)}),t}function Vu(e){let t=[];return Lu(e,e=>{Cu(t,e)}),t}function Hu(e,t,n){let r=tu(e,t);if(r===void 0)return e;{let i=r,a=Ec(0);return $l(a,Hl(Kl(e,0,i))),$l(a,Hl(n)),$l(a,Hl(Kl(e,i+(t.end-t.start|0)|0,void 0))),a.val}}function Uu(e){return e>=97&&e<=122}function Wu(e){let t=ru(e,e=>Uu(e));if(t===void 0)return e;{let n=t,r=Ec(e.length),i=Kl(e,0,n);_l(r,i.str,i.start,i.end-i.start|0);let a=Vl(Kl(e,n,void 0));for(;;){let e=kl(a);if(e===-1)break;{let t=e;Uu(t)?Dc(r,t-32|0):Dc(r,t);continue}}return r.val}}function Gu(e){return{str:e,start:0,end:e.length}}function Ku(e,t){t.method_table.method_0(t.self,Cl(e,10))}function qu(e,t){t.method_table.method_0(t.self,wl(e,10))}function Ju(e){let t={val:0};return()=>{if(t.val<(e.end-e.start|0)){let n=e.buf[e.start+t.val|0];return t.val=t.val+1|0,n}else return}}function Yu(e){let t={val:0};return()=>{if(t.val<(e.end-e.start|0)){let n=e.buf[e.start+t.val|0];return t.val=t.val+1|0,n}else return}}function Xu(e){let t={val:0};return()=>{if(t.val<(e.end-e.start|0)){let n=e.buf[e.start+t.val|0];return t.val=t.val+1|0,n}else return}}function Zu(e){return Ju({buf:e,start:0,end:e.length})}function Qu(e){return Yu({buf:e,start:0,end:e.length})}function $u(e){return Xu({buf:e,start:0,end:e.length})}function H(e){return Pl(Zu(e))}function ed(e){return Il(Qu(e))}function td(e){return Rl($u(e))}function nd(e,t){return e===void 0?t===void 0:t===void 0?!1:e===t}function rd(e,t){if(e.$tag===0)return t.$tag===0;{let n=e._0;return t.$tag===1?n===t._0:!1}}function id(e,t){return e.$tag===0?t:e._0}function ad(e){return e>=0?e<=1?1:e>1073741824?1073741824:(2147483647>>(Math.clz32(e-1|0)-1|0))+1|0:T()}function od(e){let t=ad(e),n=t-1|0,r=(Math.imul(t,13)|0)/16|0;return{entries:xt(t,void 0),size:0,capacity:t,capacity_mask:n,grow_at:r,head:void 0,tail:-1}}function sd(e){let t=ad(e),n=t-1|0,r=(Math.imul(t,13)|0)/16|0;return{entries:xt(t,void 0),size:0,capacity:t,capacity_mask:n,grow_at:r,head:void 0,tail:-1}}function cd(e){let t=ad(e),n=t-1|0,r=(Math.imul(t,13)|0)/16|0;return{entries:xt(t,void 0),size:0,capacity:t,capacity_mask:n,grow_at:r,head:void 0,tail:-1}}function ld(e){let t=ad(e),n=t-1|0,r=(Math.imul(t,13)|0)/16|0;return{entries:xt(t,void 0),size:0,capacity:t,capacity_mask:n,grow_at:r,head:void 0,tail:-1}}function ud(e){let t=ad(e),n=t-1|0,r=(Math.imul(t,13)|0)/16|0;return{entries:xt(t,void 0),size:0,capacity:t,capacity_mask:n,grow_at:r,head:void 0,tail:-1}}function dd(e,t,n){let r=e.tail;if(r===-1)e.head=n;else{let t=e.entries;E(t,r);let i=t[r],a;a=i===void 0?T():i,a.next=n}e.tail=t;let i=e.entries;E(i,t),i[t]=n,e.size=e.size+1|0}function fd(e,t,n){let r=e.tail;if(r===-1)e.head=n;else{let t=e.entries;E(t,r);let i=t[r],a;a=i===void 0?T():i,a.next=n}e.tail=t;let i=e.entries;E(i,t),i[t]=n,e.size=e.size+1|0}function pd(e,t,n){let r=e.tail;if(r===-1)e.head=n;else{let t=e.entries;E(t,r);let i=t[r],a;a=i===void 0?T():i,a.next=n}e.tail=t;let i=e.entries;E(i,t),i[t]=n,e.size=e.size+1|0}function md(e,t,n){let r=e.tail;if(r===-1)e.head=n;else{let t=e.entries;E(t,r);let i=t[r],a;a=i===void 0?T():i,a.next=n}e.tail=t;let i=e.entries;E(i,t),i[t]=n,e.size=e.size+1|0}function hd(e,t,n){let r=e.tail;if(r===-1)e.head=n;else{let t=e.entries;E(t,r);let i=t[r],a;a=i===void 0?T():i,a.next=n}e.tail=t;let i=e.entries;E(i,t),i[t]=n,e.size=e.size+1|0}function gd(e,t,n){let r=e.entries;E(r,n),r[n]=t;let i=t.next;if(i===void 0){e.tail=n;return}else{let e=i;e.prev=n;return}}function _d(e,t,n){let r=e.entries;E(r,n),r[n]=t;let i=t.next;if(i===void 0){e.tail=n;return}else{let e=i;e.prev=n;return}}function vd(e,t,n){let r=e.entries;E(r,n),r[n]=t;let i=t.next;if(i===void 0){e.tail=n;return}else{let e=i;e.prev=n;return}}function yd(e,t,n){let r=e.entries;E(r,n),r[n]=t;let i=t.next;if(i===void 0){e.tail=n;return}else{let e=i;e.prev=n;return}}function bd(e,t,n){let r=e.entries;E(r,n),r[n]=t;let i=t.next;if(i===void 0){e.tail=n;return}else{let e=i;e.prev=n;return}}function xd(e,t,n){let r=n.psl+1|0,i=t+1&e.capacity_mask,a=n;for(;;){let t=r,n=i,o=a,s=e.entries;E(s,n);let c=s[n];if(c===void 0){o.psl=t,gd(e,o,n);break}else{let s=c;if(t>s.psl){o.psl=t,gd(e,o,n),r=s.psl+1|0,i=n+1&e.capacity_mask,a=s;continue}else{r=t+1|0,i=n+1&e.capacity_mask;continue}}}}function Sd(e,t,n){let r=n.psl+1|0,i=t+1&e.capacity_mask,a=n;for(;;){let t=r,n=i,o=a,s=e.entries;E(s,n);let c=s[n];if(c===void 0){o.psl=t,_d(e,o,n);break}else{let s=c;if(t>s.psl){o.psl=t,_d(e,o,n),r=s.psl+1|0,i=n+1&e.capacity_mask,a=s;continue}else{r=t+1|0,i=n+1&e.capacity_mask;continue}}}}function Cd(e,t,n){let r=n.psl+1|0,i=t+1&e.capacity_mask,a=n;for(;;){let t=r,n=i,o=a,s=e.entries;E(s,n);let c=s[n];if(c===void 0){o.psl=t,vd(e,o,n);break}else{let s=c;if(t>s.psl){o.psl=t,vd(e,o,n),r=s.psl+1|0,i=n+1&e.capacity_mask,a=s;continue}else{r=t+1|0,i=n+1&e.capacity_mask;continue}}}}function wd(e,t,n){let r=n.psl+1|0,i=t+1&e.capacity_mask,a=n;for(;;){let t=r,n=i,o=a,s=e.entries;E(s,n);let c=s[n];if(c===void 0){o.psl=t,yd(e,o,n);break}else{let s=c;if(t>s.psl){o.psl=t,yd(e,o,n),r=s.psl+1|0,i=n+1&e.capacity_mask,a=s;continue}else{r=t+1|0,i=n+1&e.capacity_mask;continue}}}}function Td(e,t,n){let r=n.psl+1|0,i=t+1&e.capacity_mask,a=n;for(;;){let t=r,n=i,o=a,s=e.entries;E(s,n);let c=s[n];if(c===void 0){o.psl=t,bd(e,o,n);break}else{let s=c;if(t>s.psl){o.psl=t,bd(e,o,n),r=s.psl+1|0,i=n+1&e.capacity_mask,a=s;continue}else{r=t+1|0,i=n+1&e.capacity_mask;continue}}}}function Ed(e,t,n,r){e.size>=e.grow_at&&jd(e);let i,a=0,o=r&e.capacity_mask;for(;;){let s=a,c=o,l=e.entries;E(l,c);let u=l[c];if(u===void 0){i={_0:c,_1:s};break}else{let l=u;if(l.hash===r&&l.key===t){l.value=n;return}if(s>l.psl){xd(e,c,l),i={_0:c,_1:s};break}a=s+1|0,o=c+1&e.capacity_mask;continue}}let s=i._0,c=i._1;dd(e,s,{prev:e.tail,next:void 0,psl:c,hash:r,key:t,value:n})}function Dd(e,t,n,r){e.size>=e.grow_at&&Md(e);let i,a=0,o=r&e.capacity_mask;for(;;){let s=a,c=o,l=e.entries;E(l,c);let u=l[c];if(u===void 0){i={_0:c,_1:s};break}else{let l=u;if(l.hash===r&&l.key===t){l.value=n;return}if(s>l.psl){Sd(e,c,l),i={_0:c,_1:s};break}a=s+1|0,o=c+1&e.capacity_mask;continue}}let s=i._0,c=i._1;fd(e,s,{prev:e.tail,next:void 0,psl:c,hash:r,key:t,value:n})}function Od(e,t,n,r){e.size>=e.grow_at&&Nd(e);let i,a=0,o=r&e.capacity_mask;for(;;){let s=a,c=o,l=e.entries;E(l,c);let u=l[c];if(u===void 0){i={_0:c,_1:s};break}else{let l=u;if(l.hash===r&&l.key===t){l.value=n;return}if(s>l.psl){Cd(e,c,l),i={_0:c,_1:s};break}a=s+1|0,o=c+1&e.capacity_mask;continue}}let s=i._0,c=i._1;pd(e,s,{prev:e.tail,next:void 0,psl:c,hash:r,key:t,value:n})}function kd(e,t,n,r){e.size>=e.grow_at&&Pd(e);let i,a=0,o=r&e.capacity_mask;for(;;){let s=a,c=o,l=e.entries;E(l,c);let u=l[c];if(u===void 0){i={_0:c,_1:s};break}else{let l=u;if(l.hash===r&&l.key===t){l.value=n;return}if(s>l.psl){wd(e,c,l),i={_0:c,_1:s};break}a=s+1|0,o=c+1&e.capacity_mask;continue}}let s=i._0,c=i._1;md(e,s,{prev:e.tail,next:void 0,psl:c,hash:r,key:t,value:n})}function Ad(e,t,n,r){e.size>=e.grow_at&&Fd(e);let i,a=0,o=r&e.capacity_mask;for(;;){let s=a,c=o,l=e.entries;E(l,c);let u=l[c];if(u===void 0){i={_0:c,_1:s};break}else{let l=u;if(l.hash===r&&l.key===t){l.value=n;return}if(s>l.psl){Td(e,c,l),i={_0:c,_1:s};break}a=s+1|0,o=c+1&e.capacity_mask;continue}}let s=i._0,c=i._1;hd(e,s,{prev:e.tail,next:void 0,psl:c,hash:r,key:t,value:n})}function jd(e){let t=e.head,n=e.capacity<<1;e.entries=xt(n,void 0),e.capacity=n,e.capacity_mask=n-1|0;let r=e.capacity;e.grow_at=(Math.imul(r,13)|0)/16|0,e.size=0,e.head=void 0,e.tail=-1;let i=t;for(;;){let t=i;if(t===void 0)return;{let n=t,r=n.next,a=n.key,o=n.value,s=n.hash;Ed(e,a,o,s),i=r;continue}}}function Md(e){let t=e.head,n=e.capacity<<1;e.entries=xt(n,void 0),e.capacity=n,e.capacity_mask=n-1|0;let r=e.capacity;e.grow_at=(Math.imul(r,13)|0)/16|0,e.size=0,e.head=void 0,e.tail=-1;let i=t;for(;;){let t=i;if(t===void 0)return;{let n=t,r=n.next,a=n.key,o=n.value,s=n.hash;Dd(e,a,o,s),i=r;continue}}}function Nd(e){let t=e.head,n=e.capacity<<1;e.entries=xt(n,void 0),e.capacity=n,e.capacity_mask=n-1|0;let r=e.capacity;e.grow_at=(Math.imul(r,13)|0)/16|0,e.size=0,e.head=void 0,e.tail=-1;let i=t;for(;;){let t=i;if(t===void 0)return;{let n=t,r=n.next,a=n.key,o=n.value,s=n.hash;Od(e,a,o,s),i=r;continue}}}function Pd(e){let t=e.head,n=e.capacity<<1;e.entries=xt(n,void 0),e.capacity=n,e.capacity_mask=n-1|0;let r=e.capacity;e.grow_at=(Math.imul(r,13)|0)/16|0,e.size=0,e.head=void 0,e.tail=-1;let i=t;for(;;){let t=i;if(t===void 0)return;{let n=t,r=n.next,a=n.key,o=n.value,s=n.hash;kd(e,a,o,s),i=r;continue}}}function Fd(e){let t=e.head,n=e.capacity<<1;e.entries=xt(n,void 0),e.capacity=n,e.capacity_mask=n-1|0;let r=e.capacity;e.grow_at=(Math.imul(r,13)|0)/16|0,e.size=0,e.head=void 0,e.tail=-1;let i=t;for(;;){let t=i;if(t===void 0)return;{let n=t,r=n.next,a=n.key,o=n.value,s=n.hash;Ad(e,a,o,s),i=r;continue}}}function Id(e,t,n){Ed(e,t,n,ml(t))}function Ld(e,t,n){Dd(e,t,n,hl(t))}function Rd(e,t,n){Od(e,t,n,hl(t))}function zd(e,t,n){kd(e,t,n,hl(t))}function Bd(e,t,n){Ad(e,t,n,hl(t))}function Vd(e){let t=e.end-e.start|0,n=ad(t),r=n;t>((Math.imul(r,13)|0)/16|0)&&(n=Math.imul(n,2)|0);let i=od(n),a=e.end-e.start|0,o=0;for(;;){let t=o;if(t<a){let n=e.buf[e.start+t|0];Id(i,n._0,n._1),o=t+1|0;continue}else break}return i}function Hd(e){let t=e.end-e.start|0,n=ad(t),r=n;t>((Math.imul(r,13)|0)/16|0)&&(n=Math.imul(n,2)|0);let i=sd(n),a=e.end-e.start|0,o=0;for(;;){let t=o;if(t<a){let n=e.buf[e.start+t|0];Ld(i,n._0,n._1),o=t+1|0;continue}else break}return i}function Ud(e){let t=e.end-e.start|0,n=ad(t),r=n;t>((Math.imul(r,13)|0)/16|0)&&(n=Math.imul(n,2)|0);let i=cd(n),a=e.end-e.start|0,o=0;for(;;){let t=o;if(t<a){let n=e.buf[e.start+t|0];Rd(i,n._0,n._1),o=t+1|0;continue}else break}return i}function Wd(e){let t=e.end-e.start|0,n=ad(t),r=n;t>((Math.imul(r,13)|0)/16|0)&&(n=Math.imul(n,2)|0);let i=ld(n),a=e.end-e.start|0,o=0;for(;;){let t=o;if(t<a){let n=e.buf[e.start+t|0];zd(i,n._0,n._1),o=t+1|0;continue}else break}return i}function Gd(e){let t=e.end-e.start|0,n=ad(t),r=n;t>((Math.imul(r,13)|0)/16|0)&&(n=Math.imul(n,2)|0);let i=ud(n),a=e.end-e.start|0,o=0;for(;;){let t=o;if(t<a){let n=e.buf[e.start+t|0];Bd(i,n._0,n._1),o=t+1|0;continue}else break}return i}function Kd(e,t){let n=hl(t),r=0,i=n&e.capacity_mask;for(;;){let a=r,o=i,s=e.entries;E(s,o);let c=s[o];if(c===void 0)return;{let s=c;if(s.hash===n&&s.key===t)return s.value;if(a>s.psl)return;r=a+1|0,i=o+1&e.capacity_mask;continue}}}function qd(e,t){let n=hl(t),r=0,i=n&e.capacity_mask;for(;;){let a=r,o=i,s=e.entries;E(s,o);let c=s[o];if(c===void 0)return;{let s=c;if(s.hash===n&&s.key===t)return s.value;if(a>s.psl)return;r=a+1|0,i=o+1&e.capacity_mask;continue}}}function Jd(e,t){let n=hl(t),r=0,i=n&e.capacity_mask;for(;;){let a=r,o=i,s=e.entries;E(s,o);let c=s[o];if(c===void 0)return;{let s=c;if(s.hash===n&&s.key===t)return s.value;if(a>s.psl)return;r=a+1|0,i=o+1&e.capacity_mask;continue}}}function Yd(e,t){let n=hl(t),r=0,i=n&e.capacity_mask;for(;;){let a=r,o=i,s=e.entries;E(s,o);let c=s[o];if(c===void 0)return;{let s=c;if(s.hash===n&&s.key===t)return s.value;if(a>s.psl)return;r=a+1|0,i=o+1&e.capacity_mask;continue}}}function Xd(e,t){let n=t.prev;if(n===-1)e.head=t.next;else{let r=e.entries;E(r,n);let i=r[n],a;a=i===void 0?T():i;let o=a;o.next=t.next}let r=t.next;if(r===void 0){e.tail=t.prev;return}else{let e=r;e.prev=t.prev;return}}function Zd(e,t){let n=t;for(;;){let t=n,r=t+1&e.capacity_mask;_L:{let i=e.entries;E(i,r);let a=i[r];if(a===void 0)break _L;{let i=a;if(i.psl===0)break _L;i.psl=i.psl-1|0,gd(e,i,t),n=r;continue}}let i=e.entries;E(i,t),i[t]=void 0;return}}function Qd(e,t,n){let r=0,i=n&e.capacity_mask;for(;;){let a=r,o=i,s=e.entries;E(s,o);let c=s[o];if(c===void 0)break;{let s=c;if(s.hash===n&&s.key===t){Xd(e,s),Zd(e,o),e.size=e.size-1|0;break}if(a>s.psl)break;r=a+1|0,i=o+1&e.capacity_mask;continue}}}function $d(e,t){Qd(e,t,ml(t))}function ef(e){let t={val:e.head};return()=>{let e=t.val;if(e!==void 0){let n=e,r=n.key,i=n.value;return t.val=n.next,{_0:r,_1:i}}}}function tf(e){return Fl(ef(e))}function nf(e){let t={val:e.head};return Bl(()=>{let e=t.val;if(e!==void 0){let n=e,r=n.value;return t.val=n.next,r}})}function rf(e){return{hi:0,lo:e}}function af(e){return rf(e)}function of(e){return af(e)}function U(e,t){return Ac(Ou(e,e=>t(e)?0:1),1)}function sf(e,t){return Ac(ku(e,e=>t(e)?0:1),1)}function cf(e,t){return Ac(Au(e,e=>t(e)?0:1),1)}function lf(e){let t={val:0},n={val:jt};e(e=>(t.val=t.val+1|0,1));let r=n.val;switch(r.$tag){case 0:break;case 1:r._0;break;case 2:return r._0;case 3:T();break;default:T()}return t.val}function uf(e,t){let n={val:Vt};e(e=>t(e)?(n.val=new Ht(e),0):1);let r=n.val;switch(r.$tag){case 0:return;case 1:return r._0;case 2:return r._0;case 3:return T();default:return T()}}function df(e){return e.lo}function ff(e,t,n){let r=e.hi,i=e.lo,a=i+n|0,o=a>>31,s=i>>31,c=n>>31,l=(s&c|~o&(s^c))&1;return{hi:(r+t|0)+l|0,lo:a}}function pf(e,t){return ff(e,t.hi,t.lo)}function mf(e,t){return t.lo===0?{hi:e.hi-t.hi|0,lo:e.lo}:ff(e,~t.hi,~t.lo+1|0)}function hf(e,t){let n=e.hi,r=e.lo,i=t.hi,a=t.lo,o=n,s=r,c=i,l=a,u=o>>>16|0,d=o&65535,f=s>>>16|0,p=s&65535,m=c>>>16|0,h=c&65535,g=l>>>16|0,_=l&65535,v=Math.imul(p,_)|0,y=v>>>16|0,b=v&65535,te=(y>>>0)+((Math.imul(f,_)|0)>>>0)|0,ne=te>>>16|0,re=((te&65535)>>>0)+((Math.imul(p,g)|0)>>>0)|0,ie=(ne>>>0)+((re>>>16|0)>>>0)|0,ae=re&65535,oe=(ie>>>0)+((Math.imul(d,_)|0)>>>0)|0,se=oe>>>16|0,ce=((oe&65535)>>>0)+((Math.imul(f,g)|0)>>>0)|0,le=(se>>>0)+((ce>>>16|0)>>>0)|0,x=((ce&65535)>>>0)+((Math.imul(p,h)|0)>>>0)|0,ue=(le>>>0)+((x>>>16|0)>>>0)|0,de=x&65535;return{hi:(((((((((ue>>>0)+((Math.imul(u,_)|0)>>>0)|0)>>>0)+((Math.imul(d,g)|0)>>>0)|0)>>>0)+((Math.imul(f,h)|0)>>>0)|0)>>>0)+((Math.imul(p,m)|0)>>>0)|0)&65535)<<16|de,lo:ae<<16|b}}function gf(){return ri.tried?ri.exports!==void 0:(ri.tried=!0,ri.exports=Kt(),ri.exports!==void 0)}function _f(e,t){if(t.hi===0&&t.lo===0)return T();{if(!gf())return qt(e,t);let n=ri.exports;if(n===void 0)return T();{let r=n,i=e.hi,a=e.lo,o=t.hi,s=t.lo,c=r.div_u,l=c(a,i,s,o),u=r.get_high;return{hi:u(),lo:l}}}}function vf(e,t){if(t.hi===0&&t.lo===0)return T();{if(!gf())return Jt(e,t);let n=ri.exports;if(n===void 0)return T();{let r=n,i=e.hi,a=e.lo,o=t.hi,s=t.lo,c=r.rem_u,l=c(a,i,s,o),u=r.get_high;return{hi:u(),lo:l}}}}function yf(e,t){return{hi:e.hi&t.hi,lo:e.lo&t.lo}}function bf(e,t){return{hi:e.hi|t.hi,lo:e.lo|t.lo}}function xf(e,t){let n=t&63;if(n===0)return e;if(n<32){let t=e.hi,r=e.lo,i=t,a=r;return{hi:i<<n|a>>>(32-n|0)|0,lo:a<<n}}else return{hi:e.lo<<(n-32|0),lo:0}}function Sf(e,t){let n=t&63;return n===0?e:n<32?{hi:e.hi>>>n|0,lo:e.lo>>>n|e.hi<<(32-n|0)}:{hi:0,lo:e.hi>>>(n-32|0)|0}}function Cf(e){return Xt(e)}function wf(e,t){return pf(e,t)}function Tf(e,t){return mf(e,t)}function Ef(e,t){return hf(e,t)}function Df(e,t){return _f(e,t)}function Of(e,t){return vf(e,t)}function kf(e,t){return Yt(e,t)}function Af(e,t){let n=e,r=t;return n.hi===r.hi&&n.lo===r.lo}function jf(e,t){return yf(e,t)}function Mf(e,t){return bf(e,t)}function Nf(e,t){return xf(e,t)}function Pf(e,t){return Sf(e,t)}function Ff(e,t){let n=t.length,r=0;for(;;){let i=r;if(i<n){nl(e,t.charCodeAt(i)),r=i+1|0;continue}else return}}function If(e,t){Ff(t,e)}function Lf(e,t){rl(t,e)}function Rf(e){return e===e?e>=2147483647?2147483647:e<=-2147483648?-2147483648:e|0:0}function zf(e,t){let n=Array(e),r=0;for(;;){let i=r;if(i<e){n[i]=t,r=i+1|0;continue}else break}return n}function Bf(e,t){let n=Array(e),r=0;for(;;){let i=r;if(i<e){n[i]=t,r=i+1|0;continue}else break}return n}function Vf(e,t,n){let r=e.length;if(t>=0&&t<r){E(e,t),e[t]=n;return}else{T();return}}function Hf(e,t,n){let r=e.length;if(t>=0&&t<r){E(e,t),e[t]=n;return}else{T();return}}function Uf(e,t,n){let r=e.length;if(t>=0&&t<r){E(e,t),e[t]=n;return}else{T();return}}function Wf(e,t,n){let r=e.length;if(t>=0&&t<r){E(e,t),e[t]=n;return}else{T();return}}function Gf(e,t){let n=e.pkg,r=Jc(n,{str:`/`,start:0,end:1}),i;if(r===void 0)i={_0:n,_1:void 0};else{let e=r,t=Jc(Qc(n,e+1|0,void 0),{str:`/`,start:0,end:1});if(t===void 0)i={_0:n,_1:void 0};else{let r=t,a=(e+1|0)+r|0;i={_0:Qc(n,0,a),_1:Qc(n,a+1|0,void 0)}}}let a=i._0,o=i._1;if(o!==void 0){let e=o;t.method_table.method_2(t.self,e),t.method_table.method_3(t.self,47)}t.method_table.method_2(t.self,e.filename),t.method_table.method_3(t.self,58),t.method_table.method_2(t.self,e.start_line),t.method_table.method_3(t.self,58),t.method_table.method_2(t.self,e.start_column),t.method_table.method_3(t.self,45),t.method_table.method_2(t.self,e.end_line),t.method_table.method_3(t.self,58),t.method_table.method_2(t.self,e.end_column),t.method_table.method_3(t.self,64),t.method_table.method_2(t.self,a)}function Kf(e,t){Gf(el(e),t)}function qf(e,t){if(e.end-e.start|0){let n=e.buf[e.start],r=e.buf,i=1+e.start|0,a={buf:r,start:i,end:e.end},o=Gu(n),s=o.end-o.start|0,c=a.end-a.start|0,l=0;for(;;){let e=l;if(e<c){let n=r[i+e|0],a=s,o=Gu(n);s=a+((o.end-o.start|0)+(t.end-t.start|0)|0)|0,l=e+1|0;continue}else break}s<<=1;let u=Ec(s);if(eu(u,o),Jl(t.str,0,t.start,t.end)){let e=a.end-a.start|0,t=0;for(;;){let n=t;if(n<e){let e=r[i+n|0];eu(u,Gu(e)),t=n+1|0;continue}else break}}else{let e=a.end-a.start|0,n=0;for(;;){let a=n;if(a<e){let e=r[i+a|0],o=Gu(e);eu(u,t),eu(u,o),n=a+1|0;continue}else break}}return u.val}else return``}function Jf(e,t){Qt(e,t)}function Yf(e,t){Qt(e,t)}function Xf(e,t){Qt(e,t)}function Zf(e,t){Qt(e,t)}function Qf(e){return $t(e)}function $f(e){if(e.length!==0)return Qf(e)}function ep(e,t){if(t>=0&&t<e.length){E(e,t);let n=e[t];return en(e,t,1),n}else return vc(`index out of bounds: the len is from 0 to ${vl(e.length)} but the index is ${vl(t)}`,`@moonbitlang/core/builtin:arraycore_js.mbt:241:5-243:6`)}function tp(e,t){if(t>=e.length){Qt(e,t);return}else{T();return}}function np(e,t){if(t>=e.length){Qt(e,t);return}else{T();return}}function rp(e){return Zt(e)}function ip(e){return Zt(e)}function ap(e){return Zt(e)}function op(e){return Zt(e)}function sp(e,t,n){let r=e.end-e.start|0;if(n>=0&&n<=t.length){(n+r|0)>t.length&&tp(t,n+r|0),wc(t,n,e.buf,e.start,r);return}else{T();return}}function cp(e,t,n){let r=e.end-e.start|0;if(n>=0&&n<=t.length){(n+r|0)>t.length&&np(t,n+r|0),Tc(t,n,e.buf,e.start,r);return}else{T();return}}function lp(e,t){let n=e.length;if(n===t.length){let r=0;for(;;){let i=r;if(i<n){let n=e[i],a=t[i];if(!(n.x===a.x&&n.y===a.y))return!1;r=i+1|0;continue}else return!0}}else return!1}function up(e,t){sp(t,e,e.length)}function dp(e,t){cp(t,e,e.length)}function fp(e){Jf(e,0)}function pp(e){Yf(e,0)}function mp(e){Xf(e,0)}function hp(e){Zf(e,0)}function gp(e,t){let n=e.length,r=0;for(;;){let i=r;if(i<n){if(e[i]===t)return!0;r=i+1|0;continue}else return!1}}function _p(e,t){return qf({buf:e,start:0,end:e.length},t)}function vp(e,t,n){if(n)return`NaN`;let r=e?`-`:``;return t?`${r}Infinity`:`${r}0.0`}function yp(e,t,n){let r=Ec(e.length),i=t;for(;;){let t=i;if(t<n){E(e,t);let n=e[t];Dc(r,n),i=t+1|0;continue}else break}return r.val}function bp(e,t){let n=jf(e,tn),r=Pf(e,32),i=jf(t,tn),a=Pf(t,32),o=Ef(n,i),s=wf(Ef(r,i),Pf(o,32)),c=wf(Ef(n,a),jf(s,tn)),l=wf(wf(Ef(r,a),Pf(s,32)),Pf(c,32));return{_0:Ef(e,t),_1:l}}function xp(e,t,n){return Mf(Nf(t,64-n|0),Pf(e,n))}function Sp(e){if(Nc(Of(e,Pe),x))return 0;if(Nc(Of(e,Fe),x))return 1;if(Nc(Of(e,Ie),x))return 2;if(Nc(Of(e,Le),x))return 3;let t=4,n=Df(e,Le);for(;sl(n,x);){if(Nc(Of(n,Pe),x))return t;n=Df(n,Pe),t=t+1|0}return bc(`IllegalArgumentException ${Sl(n)}`,`@moonbitlang/core/double/internal/ryu:ryu.mbt:116:3-116:45`)}function Cp(e,t){return Sp(e)>=t}function wp(t,n){return Af(jf(t,Tf(Nf(e,n),e)),x)}function Tp(t,n,r,i){let a=n._0,o=n._1,s=Nf(t,1),c=bp(s,a),l=c._0,u=c._1,d=bp(s,o),f=d._0,p=d._1,m=wf(u,f),h=wf(p,ol(m,u)?e:x),g=wf(l,a),_=wf(wf(m,o),ol(g,l)?e:x),v=xp(_,wf(h,ol(_,m)?e:x),(r-64|0)-1|0),y=x;if(i){let t=Tf(l,a),n=Tf(Tf(m,o),ol(l,t)?e:x);y=xp(n,Tf(h,ol(m,n)?e:x),(r-64|0)-1|0)}else{let t=wf(l,l),n=wf(wf(m,m),ol(t,l)?e:x),i=wf(wf(h,h),ol(n,m)?e:x),s=Tf(t,a),c=Tf(Tf(n,o),ol(t,s)?e:x);y=xp(c,Tf(i,ol(n,c)?e:x),r-64|0)}return{_0:xp(m,h,(r-64|0)-1|0),_1:v,_2:y}}function Ep(t){let n=t/26|0,r=Math.imul(n,26)|0,i=t-r|0,a=Math.imul(n,2)|0;E(oi,a);let o=oi[a],s=(Math.imul(n,2)|0)+1|0;E(oi,s);let c=oi[s];if(i===0)return{_0:o,_1:c};E(ci,i);let l=ci[i],u=bp(l,c),d=u._0,f=u._1,p=bp(l,o),m=p._0,h=p._1,g=wf(h,d),_=f;ol(g,h)&&(_=wf(_,e));let v=(((Math.imul(t,1217359)|0)>>>19|0)+1|0)-(((Math.imul(r,1217359)|0)>>>19|0)+1|0)|0,y=xp(m,g,v),b=t/16|0;return E(si,b),{_0:wf(y,of(si[b]>>>(t%16<<1)&3)),_1:xp(g,_,v)}}function Dp(t){let n=((t+26|0)-1|0)/26|0,r=Math.imul(n,26)|0,i=r-t|0,a=Math.imul(n,2)|0;E(ii,a);let o=ii[a],s=(Math.imul(n,2)|0)+1|0;E(ii,s);let c=ii[s];if(i===0)return{_0:o,_1:c};E(ci,i);let l=ci[i],u=bp(l,c),d=u._0,f=u._1,p=bp(l,o),m=p._0,h=p._1,g=wf(h,d),_=f;ol(g,h)&&(_=wf(_,e));let v=(((Math.imul(r,1217359)|0)>>>19|0)+1|0)-(((Math.imul(t,1217359)|0)>>>19|0)+1|0)|0,y=wf(xp(m,g,v),e),b=t/16|0;return E(ai,b),{_0:wf(y,of(ai[b]>>>(t%16<<1)&3)),_1:xp(g,_,v)}}function Op(e){return ll(e,nn)?17:ll(e,rn)?16:ll(e,an)?15:ll(e,on)?14:ll(e,sn)?13:ll(e,cn)?12:ll(e,ln)?11:ll(e,un)?10:ll(e,dn)?9:ll(e,fn)?8:ll(e,pn)?7:ll(e,mn)?6:ll(e,hn)?5:ll(e,gn)?4:ll(e,_n)?3:ll(e,vn)?2:1}function kp(t,n){let r=0,i=x;n===0?(r=-1076,i=t):(r=((n-1023|0)-52|0)-2|0,i=Mf(Nf(e,52),t));let a=Af(jf(i,e),x),o=Ef(yn,i),s=Nc(t,x)||n>>>0<=1,c=x,l=x,u=x,d=0,f=!1,p=!1;if(r>=0){let t=r,n=((Math.imul(t,78913)|0)>>>18|0)-(r>3?1:0)|0;d=n;let m=(125+(((Math.imul(n,1217359)|0)>>>19|0)+1|0)|0)-1|0,h=((-r|0)+n|0)+m|0,g=Dp(n),_=Tp(i,g,h,s),v=_._0,y=_._1,b=_._2;c=v,l=y,u=b,n<=21&&(df(o)-(Math.imul(5,df(Df(o,Pe)))|0)|0?a?f=Cp(Tf(Tf(o,e),s?e:x),n):l=Tf(l,Cp(wf(o,bn),n)?e:x):p=Cp(o,n))}else{let t=-r|0,n=((Math.imul(t,732923)|0)>>>20|0)-((-r|0)>1?1:0)|0;d=n+r|0;let m=(-r|0)-n|0,h=n-((((Math.imul(m,1217359)|0)>>>19|0)+1|0)-125|0)|0,g=Ep(m),_=Tp(i,g,h,s),v=_._0,y=_._1,b=_._2;c=v,l=y,u=b,n<=1?(p=!0,a?f=(s?1:0)==1:l=Tf(l,e)):n<63&&(p=wp(o,n))}let m=0,h=0,g=x;if(f||p){for(;;){let e=Df(l,vn),t=Df(u,vn);if(cl(e,t))break;let n=df(u)-(Math.imul(10,df(t))|0)|0,r=Df(c,vn),i=df(c)-(Math.imul(10,df(r))|0)|0;f&&=n===0,p&&=h===0,h=i,c=r,l=e,u=t,m=m+1|0}if(f)for(;;){let e=Df(u,vn);if(df(u)-(Math.imul(10,df(e))|0)|0)break;let t=Df(l,vn),n=Df(c,vn),r=df(c)-(Math.imul(10,df(n))|0)|0;p&&=h===0,h=r,c=n,l=t,u=e,m=m+1|0}p&&h===5&&Af(Of(c,bn),x)&&(h=4),g=wf(c,Af(c,u)&&(!a||!f)||h>=5?e:x)}else{let t=!1,n=Df(l,_n),r=Df(u,_n);if(sl(n,r)){let e=Df(c,_n);t=(df(c)-(Math.imul(100,df(e))|0)|0)>=50,c=e,l=n,u=r,m=m+2|0}for(;;){let e=Df(l,vn),n=Df(u,vn);if(cl(e,n))break;let r=Df(c,vn);t=(df(c)-(Math.imul(10,df(r))|0)|0)>=5,c=r,l=e,u=n,m=m+1|0}g=wf(c,Af(c,u)||t?e:x)}let _=d+m|0;return{mantissa:g,exponent:_}}function Ap(e,t){let n=kt(25,0),r=0;if(t){let e=r;E(n,e),n[e]=45,r=r+1|0}let i=e.mantissa,a=Op(i),o=(e.exponent+a|0)-1|0;if(o>=-6&&o<21){if(o<0){let e=r;E(n,e),n[e]=48,r=r+1|0;let t=r;E(n,t),n[t]=46,r=r+1|0;let s=-1;for(;;){let e=s;if(e>o){let t=r;E(n,t),n[t]=48,r=r+1|0,s=e-1|0;continue}else break}let c=r,l=0;for(;;){let e=l;if(e<a){let t=((c+a|0)-e|0)-1|0;E(n,t),n[t]=(48+df(Of(i,vn))|0)&255,i=Df(i,vn),r=r+1|0,l=e+1|0;continue}else break}}else if((o+1|0)>=a){let e=0;for(;;){let t=e;if(t<a){let o=((r+a|0)-t|0)-1|0;E(n,o),n[o]=(48+df(Of(i,vn))|0)&255,i=Df(i,vn),e=t+1|0;continue}else break}r=r+a|0;let t=o+1|0,s=a;for(;;){let e=s;if(e<t){let t=r;E(n,t),n[t]=48,r=r+1|0,s=e+1|0;continue}else break}}else{let e=r+1|0,t=0;for(;;){let r=t;if(r<a){if(((a-r|0)-1|0)===o){let t=((e+a|0)-r|0)-1|0;E(n,t),n[t]=46,e=e-1|0}let s=((e+a|0)-r|0)-1|0;E(n,s),n[s]=(48+df(Of(i,vn))|0)&255,i=Df(i,vn),t=r+1|0;continue}else break}r=r+(a+1|0)|0}return yp(n,0,r)}else{let e=a-1|0,t=0;for(;;){let o=t;if(o<e){let e=Of(i,vn);i=Df(i,vn);let s=(r+a|0)-o|0;E(n,s),n[s]=(48+df(e)|0)&255,t=o+1|0;continue}else break}let s=r;if(E(n,s),n[s]=(48+(df(i)%10|0)|0)&255,a>1){let e=r+1|0;E(n,e),n[e]=46}else r=r-1|0;r=r+(a+1|0)|0;let c=r;if(E(n,c),n[c]=101,r=r+1|0,o<0){let e=r;E(n,e),n[e]=45,r=r+1|0,o=-o|0}else{let e=r;E(n,e),n[e]=43,r=r+1|0}if(o>=100){let e=o/100|0,t=(o/10|0)%10|0,i=o%10|0,a=r;E(n,a),n[a]=(48+e|0)&255;let s=r+1|0;E(n,s),n[s]=(48+t|0)&255;let c=r+2|0;E(n,c),n[c]=(48+i|0)&255,r=r+3|0}else if(o>=10){let e=o/10|0,t=o%10|0,i=r;E(n,i),n[i]=(48+e|0)&255;let a=r+1|0;E(n,a),n[a]=(48+t|0)&255,r=r+2|0}else{let e=r;E(n,e),n[e]=(48+o|0)&255,r=r+1|0}return yp(n,0,r)}}function jp(t,n){let r=Mf(Nf(e,52),t),i=(n-1023|0)-52|0;if(!(i>0)&&!(i<-52)&&!Nc(jf(r,Tf(Nf(e,-i|0),e)),x))return{mantissa:Pf(r,-i|0),exponent:0}}function Mp(t){if(t===0)return`0`;let n=Cf(t),r=Nc(jf(Pf(n,63),e),x),i=jf(n,Tf(Nf(e,52),e)),a=df(jf(Pf(n,52),Tf(Nf(e,11),e)));if(a===2047||a===0&&Af(i,x))return vp(r,a!==0,Nc(i,x));let o=li,s=jp(i,a);if(s===void 0)o=kp(i,a);else{let e=s;for(;;){let t=Df(e.mantissa,vn);if(Nc(Tf(e.mantissa,Ef(vn,t)),x))break;e={mantissa:t,exponent:e.exponent+1|0}}o=e}return Ap(o,r)}function Np(e){return Math.floor(e)}function Pp(e){return Math.round(e)}function Fp(e){return Mp(e)}function Ip(e,t){t.method_table.method_0(t.self,Fp(e))}function Lp(e){return D(e)?Dn:new On(e)}function Rp(e){return xn(e,`nodeType`)}function zp(e){return Lp(xn(e,`parentNode`))}function Bp(e){return Lp(xn(e,`firstChild`))}function Vp(e,t){return Sn(e,`appendChild`,[t])}function Hp(e,t){return Sn(e,`removeChild`,[t])}function Up(e,t,n){if(n.$tag===1){let r=n._0;return Sn(e,`insertBefore`,[t,r])}else return Sn(e,`insertBefore`,[t,Tn()])}function Wp(e,t){wn(e,`textContent`,t)}function Gp(e){Sn(e,`preventDefault`,[])}function Kp(e,t){wn(e,`className`,t)}function qp(e,t,n){Sn(e,`setAttribute`,[t,n])}function Jp(e,t){Sn(e,`removeAttribute`,[t])}function Yp(e){return Sn(e,`createDocumentFragment`,[])}function Xp(e,t){return Sn(e,`createComment`,[t])}function Zp(){let e=ui.val;return ui.val=e+1|0,e}function Qp(e){let t=e.length-1|0;for(;;){let n=t;if(n>=0){zc(e,n)(),t=n-1|0;continue}else break}pp(e)}function $p(e){let t=P.current_cleanups;return P.current_cleanups=e,t}function em(e,t){let n=$p(new ot(e));t(),P.current_cleanups=n}function tm(e,t){let n=P.current_subscriber;P.current_subscriber=e;let r=t();return P.current_subscriber=n,r}function nm(e,t){let n=P.current_subscriber;P.current_subscriber=e,t(),P.current_subscriber=n}function rm(e,t){let n=Zp(),r={val:void 0},i={id:n,run:()=>{if(!t.active)return;Qp(t.cleanups);let n=r.val;n!==void 0&&nm(n,()=>{em(t.cleanups,e)})}};return r.val=i,{_0:i,_1:()=>{t.active=!1,Qp(t.cleanups)}}}function im(e){let t=P.current_owner;t!==void 0&&mu(t.disposers,e)}function am(e){let t=rm(e,{active:!0,cleanups:[]}),n=t._0,r=t._1,i=n.run;return i(),im(r),r}function om(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function sm(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function W(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function cm(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function lm(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function um(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function dm(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function fm(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function pm(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function mm(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function hm(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function gm(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function _m(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function vm(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function ym(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function bm(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function xm(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function Sm(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function Cm(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function wm(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function Tm(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function Em(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function Dm(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function Om(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function km(e){let t=P.current_subscriber;if(t!==void 0){let n=t;U(H(e.subscribers),e=>e.id===n.id)||R(e.subscribers,n)}return e.value}function Am(e){return{value:e,subscribers:[]}}function jm(e){return{value:e,subscribers:[]}}function Mm(e){return{value:e,subscribers:[]}}function Nm(e){return{value:e,subscribers:[]}}function Pm(e){return{value:e,subscribers:[]}}function Fm(e){return{value:e,subscribers:[]}}function Im(e){return{value:e,subscribers:[]}}function Lm(e){return{value:e,subscribers:[]}}function Rm(e){return{value:e,subscribers:[]}}function zm(e){return{value:e,subscribers:[]}}function Bm(e){return{value:e,subscribers:[]}}function Vm(e){return{value:e,subscribers:[]}}function Hm(e){return{value:e,subscribers:[]}}function Um(e){return{value:e,subscribers:[]}}function Wm(e){return{value:e,subscribers:[]}}function Gm(e){return{value:e,subscribers:[]}}function Km(e){return{value:e,subscribers:[]}}function qm(e){return{value:e,subscribers:[]}}function Jm(e){return{value:e,subscribers:[]}}function Ym(e){return{value:e,subscribers:[]}}function Xm(e){return{value:e,subscribers:[]}}function Zm(e){return{value:e,subscribers:[]}}function Qm(e){return{value:e,subscribers:[]}}function $m(e){return{value:e,subscribers:[]}}function eh(e){return{value:e,subscribers:[]}}function th(e){return{value:e,subscribers:[]}}function nh(e){return Am(e)}function rh(e){return jm(e)}function ih(e){return Mm(e)}function ah(e){return Nm(e)}function oh(e){return Pm(e)}function sh(e){return Fm(e)}function ch(e){return Im(e)}function lh(e){return Lm(e)}function uh(e){return Rm(e)}function dh(e){return zm(e)}function fh(e){return Bm(e)}function ph(e){return Vm(e)}function mh(e){return Hm(e)}function hh(e){return Um(e)}function gh(e){return Wm(e)}function _h(e){return Gm(e)}function vh(e){return Km(e)}function yh(e){return qm(e)}function bh(e){return Jm(e)}function xh(e){return Ym(e)}function Sh(e){return Xm(e)}function Ch(e){return Zm(e)}function wh(e){return Qm(e)}function Th(e){return $m(e)}function Eh(e){return eh(e)}function Dh(e){return th(e)}function Oh(e){let t=P.pending_ids,n=t.length,r=0;for(;;){let i=r;if(i<n){if(t[i]===e)return!0;r=i+1|0;continue}else break}return!1}function kh(e){if(P.batch_depth>0){if(Oh(e.id))return;pu(P.pending_ids,e.id),R(P.pending_effects,e);return}else{let t=e.run;t();return}}function Ah(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function jh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function Mh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function Nh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function Ph(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function Fh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function Ih(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function Lh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function Rh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function zh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function Bh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function Vh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function Hh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function Uh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function Wh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function Gh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function Kh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function qh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function Jh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function Yh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function Xh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function Zh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function Qh(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function $h(e){let t=e.subscribers,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e];kh(n),r=e+1|0;continue}else return}}function eg(e,t){e.value=t,Ah(e)}function tg(e,t){e.value=t,jh(e)}function ng(e,t){e.value=t,Mh(e)}function rg(e,t){e.value=t,Nh(e)}function ig(e,t){e.value=t,Ph(e)}function ag(e,t){e.value=t,Fh(e)}function og(e,t){e.value=t,Ih(e)}function sg(e,t){e.value=t,Lh(e)}function cg(e,t){e.value=t,Rh(e)}function lg(e,t){e.value=t,zh(e)}function ug(e,t){e.value=t,Bh(e)}function dg(e,t){e.value=t,Vh(e)}function fg(e,t){e.value=t,Hh(e)}function pg(e,t){e.value=t,Uh(e)}function mg(e,t){e.value=t,Wh(e)}function hg(e,t){e.value=t,Gh(e)}function gg(e,t){e.value=t,Kh(e)}function _g(e,t){e.value=t,qh(e)}function vg(e,t){e.value=t,Jh(e)}function yg(e,t){e.value=t,Yh(e)}function bg(e,t){e.value=t,Xh(e)}function xg(e,t){e.value=t,Zh(e)}function Sg(e,t){e.value=t,Qh(e)}function Cg(e,t){e.value=t,$h(e)}function wg(e){let t={active:!0,cleanups:[]},n=rm(e,t),r=n._0,i=n._1;return Mn(()=>{if(t.active){let e=r.run;e();return}else return}),im(i),i}function Tg(e,t){e.value=t(e.value),Fh(e)}function Eg(e,t){e.value=t(e.value),Bh(e)}function Dg(e,t){e.value=t(e.value),Nh(e)}function Og(e,t){e.value=t(e.value),jh(e)}function kg(e){let t=Zp(),n={value:Nn,dirty:!0,subscribers:[]},r={val:void 0};return r.val={id:t,run:()=>{if(!n.dirty){n.dirty=!0;let e=n.subscribers,t=e.length,r=0;for(;;){let n=r;if(n<t){let t=e[n];kh(t),r=n+1|0;continue}else return}}}},()=>{let t=P.current_subscriber;if(t!==void 0){let e=t;U(H(n.subscribers),t=>t.id===e.id)||R(n.subscribers,e)}if(n.dirty){let t=r.val;t===void 0||(n.value=new Pn(tm(t,e)),n.dirty=!1)}let i=n.value;if(i.$tag===1)return i._0;{let t=e();return n.value=new Pn(t),t}}}function Ag(e,t){let n=P.current_owner;P.current_owner=e;let r=t();return P.current_owner=n,r}function jg(e,t){let n=P.current_owner;P.current_owner=e;let r=t();return P.current_owner=n,r}function Mg(e,t){let n=P.current_owner;P.current_owner=e;let r=t();return P.current_owner=n,r}function Ng(e){if(e.disposed)return;e.disposed=!0;let t=e.children.length-1|0;for(;;){let n=t;if(n>=0){Ng(Vc(e.children,n)),t=n-1|0;continue}else break}let n=e.disposers.length-1|0;for(;;){let t=n;if(t>=0){zc(e.disposers,t)(),n=t-1|0;continue}else break}let r=e.cleanups.length-1|0;for(;;){let t=r;if(t>=0){zc(e.cleanups,t)(),r=t-1|0;continue}else break}mp(e.children),pp(e.disposers),pp(e.cleanups);let i=e.parent;if(i!==void 0){let t=i.children,n=t.length,r=0,a=0;for(;;){let i=r,o=a;if(i<n){let n=t[i];if(n.id!==e.id){t[o]=n,r=i+1|0,a=o+1|0;continue}r=i+1|0;continue}else{Xf(t,o);return}}}}function Pg(e){let t={id:Zp(),parent:e,children:[],cleanups:[],disposers:[],disposed:!1};return e===void 0||vu(e.children,t),t}function Fg(e){let t=P.current_subscriber;P.current_subscriber=void 0;let n=e();return P.current_subscriber=t,n}function Ig(e){let t=P.current_subscriber;P.current_subscriber=void 0;let n=e();return P.current_subscriber=t,n}function Lg(e){let t=P.current_subscriber;P.current_subscriber=void 0,e(),P.current_subscriber=t}function Rg(e){let t=P.current_subscriber;P.current_subscriber=void 0;let n=e();return P.current_subscriber=t,n}function zg(e){let t=P.current_subscriber;P.current_subscriber=void 0;let n=e();return P.current_subscriber=t,n}function Bg(e){let t=Pg(P.current_owner);return{_0:jg(t,e),_1:()=>{Ng(t)}}}function Vg(e,t){return e===void 0?t():Ag(e,t)}function Hg(e,t){return e===void 0?t():Mg(e,t)}function Ug(e){let t=jn(kn(),e());return am(()=>{Wp(t,e())}),new In(t)}function Wg(e,t,n){if(t===`className`||t===`class`){Kp(e,n);return}else if(t===`__innerHTML`){wn(e,`innerHTML`,n);return}else if(t===`value`){wn(e,`value`,n);return}else if(t===`checked`){wn(e,`checked`,n===`true`);return}else if(t===`disabled`)if(n===`true`){qp(e,`disabled`,``);return}else{Jp(e,`disabled`);return}else{qp(e,t,n);return}}function Gg(e,t){qp(e,`style`,t)}function Kg(e,t,n){switch(n.$tag){case 0:{let r=n._0;if(t===`style`){Gg(e,r);return}else{Wg(e,t,r);return}}case 1:{let r=n._0;am(()=>{let n=r();if(t===`style`){Gg(e,n);return}else{Wg(e,t,n);return}});return}default:{let r=n._0;if(t===`__ref`){r(e);return}else{Bn(e,t,r);return}}}}function qg(e){return{inner:e}}function Jg(e){switch(e.$tag){case 0:return e._0.inner;case 1:return e._0;case 2:return e._0;default:return e._0}}function Yg(e,t,n,r){let i=zn(e,t),a=n.length,o=0;for(;;){let e=o;if(e<a){let t=n[e],r=t._0,a=t._1;Kg(i,r,a),o=e+1|0;continue}else break}let s=r.length,c=0;for(;;){let e=c;if(e<s){let t=r[e];Vp(i,Jg(t)),c=e+1|0;continue}else break}return new Fn(qg(i))}function Xg(e,t,n){let r=An(kn(),e),i=t.length,a=0;for(;;){let e=a;if(e<i){let n=t[e],i=n._0,o=n._1;Kg(r,i,o),a=e+1|0;continue}else break}let o=n.length,s=0;for(;;){let e=s;if(e<o){let t=n[e];Vp(r,Jg(t)),s=e+1|0;continue}else break}return new Fn(qg(r))}function Zg(e,t){Vp(e.inner,Jg(t))}function Qg(e){Wp(e.inner,``)}function $g(e,t){Qg(e),Zg(e,t)}function e_(e){if(Rp(e)===11){let t=[];for(;;){let n=Bp(e);if(n.$tag===1){let r=n._0;yu(t,r),Hp(e,r);continue}else break}return t}else return[e]}function t_(e){switch(e.length){case 0:return new Ln(Yp(kn()));case 1:return Lc(e,0);default:{let t=Yp(kn()),n=e.length,r=0;for(;;){let i=r;if(i<n){let n=e[i];Vp(t,Jg(n)),r=i+1|0;continue}else break}return new Ln(t)}}}function n_(e){let t=e._2,n=e._1,r=e._0;return Hg(n,()=>{let e=Bg(()=>r()),n=e._0;return t.val=e._1,e_(Jg(n))})}function r_(e,t){let n=Xp(kn(),`show`),r=P.current_owner,i={val:void 0},a={_0:t,_1:r,_2:i},o=Rg(()=>e())?zg(()=>n_(a)):[],s={val:o},c={val:!0};if(am(()=>{let t=e(),r=s.val.length>0;if(c.val){c.val=!1;return}if(t===!0)if(r===!1){let e=zp(n);if(e.$tag===1){let t=e._0,r=zg(()=>n_(a)),i=r.length,o=0;for(;;){let e=o;if(e<i){let i=r[e];Up(t,i,new On(n)),o=e+1|0;continue}else break}s.val=r;return}else return}else return;else if(r===!0){let e=i.val;e===void 0||(e(),i.val=void 0);let t=s.val,n=t.length,r=0;for(;;){let e=r;if(e<n){let n=t[e],i=zp(n);if(i.$tag===1){let e=i._0;Hp(e,n)}r=e+1|0;continue}else break}s.val=[];return}else return}),o.length>0){let e=[],t=o.length,r=0;for(;;){let n=r;if(n<t){let t=o[n];B(e,new Ln(t)),r=n+1|0;continue}else break}return B(e,new Ln(n)),t_(e)}else return new Ln(n)}function i_(e,t){return Vn(e,t)}function a_(e,t){let n=e.length,r=0;for(;;){let i=r;if(i<n){let n=e[i];if(i_(n.item,t))return i;r=i+1|0;continue}else break}return-1}function o_(e,t,n){if(n.$tag===1){let r=n._0;return Hn(e,t,r)}else return Un(e,t)}function s_(e,t,n,r,i){let a=n.length;if(a===0){let n=t.length,r=0;for(;;){let i=r;if(i<n){let n=t[i],a=n.dispose;a(),Gn(e,n.dom),r=i+1|0;continue}else break}return[]}let o=[],s=0;for(;;){let e=s;if(e<a){du(o,{item:Fc(n,0),dom:i,dispose:()=>{}}),s=e+1|0;continue}else break}let c=zf(t.length,!1),l=i,u=a-1|0;for(;;){let i=u;if(i>=0){let a=Fc(n,i),s=a_(t,a);if(s>=0){let n=Hc(t,s);Hf(c,s,!0),Wn(n.dom,l)||o_(e,n.dom,new On(l)),l=n.dom,Uf(o,i,n)}else{let t=r(a,i),n=t._0,s=t._1;Up(e,n,new On(l)),l=n,Uf(o,i,{item:a,dom:n,dispose:s})}u=i-1|0;continue}else break}let d=t.length,f=0;for(;;){let n=f;if(n<d){let r=t[n];if(!Uc(c,n)){let t=r.dispose;t(),Gn(e,r.dom)}f=n+1|0;continue}else break}return o}function c_(e,t,n,r){let i=zp(t);if(i.$tag===1){let a=i._0;e.val=s_(a,e.val,n,r,t);return}else return}function l_(e,t,n){return{item:e,dom:t,dispose:n}}function u_(e,t){let n=kn(),r=Xp(n,`for`),i={val:[]},a={val:!0},o=P.current_owner,s=(e,n)=>Vg(o,()=>{let r=Bg(()=>t(e,n)),i=r._0,a=r._1;return{_0:Jg(i),_1:a}}),c=Yp(n),l=Fg(()=>e()),u=l.length,d=0;for(;;){let e=d;if(e<u){let t=l[e],n=Ig(()=>s(t,e)),r=n._0,a=n._1;du(i.val,l_(t,r,a)),Vp(c,r),d=e+1|0;continue}else break}return Vp(c,r),am(()=>{let t=e();if(a.val){a.val=!1;return}Lg(()=>{c_(i,r,t,s)})}),new Ln(c)}function d_(e){return new In(jn(kn(),e))}function f_(e){return Sn(e,`toString`,[])}function p_(e,t){switch(e.$tag){case 0:{let n=e._0;t.method_table.method_0(t.self,n);return}case 1:{let n=e._0;t.method_table.method_0(t.self,f_(n));return}case 2:{let n=e._0;t.method_table.method_0(t.self,Cl(n,10));return}default:{let n=e._0;t.method_table.method_0(t.self,yl(n));return}}}function m_(e){return new S(bl(e))}function G(){return Cn()}function h_(e,t,n,r,i,a,o){let s=[];if(e===void 0||V(s,{_0:`id`,_1:new S(e)}),t===void 0||V(s,{_0:`className`,_1:new S(t)}),n===void 0||V(s,{_0:`style`,_1:new S(n)}),r.$tag===1){let e=r._0,t=Jn(e),n=t.length,i=0;for(;;){let e=i;if(e<n){let n=t[e];V(s,n),i=e+1|0;continue}else break}}if(i!==void 0){let e=i;V(s,{_0:`__ref`,_1:new C(t=>{e(t)})})}if(a.$tag===1){let e=a._0,t=e.length,n=0;for(;;){let r=n;if(r<t){let t=e[r];V(s,{_0:t._0,_1:m_(t._1)}),n=r+1|0;continue}else break}}if(o.$tag===1){let e=o._0,t=e.length,n=0;for(;;){let r=n;if(r<t){let t=e[r];V(s,t),n=r+1|0;continue}else break}}return s}function K(e,t,n,r,i,a,o,s,c,l){let u=h_(e,t,n,a,o,s,c);return r===void 0||V(u,{_0:`className`,_1:new st(r)}),i===void 0||V(u,{_0:`style`,_1:new st(i)}),Xg(`div`,u,l)}function q(e,t,n,r,i,a,o,s,c,l){let u=h_(e,t,n,a,o,s,c);return r===void 0||V(u,{_0:`className`,_1:new st(r)}),i===void 0||V(u,{_0:`style`,_1:new st(i)}),Xg(`span`,u,l)}function g_(e,t,n,r,i,a,o,s,c,l,u,d){let f=h_(t,n,r,s,c,l,u);if(e===-1||e===!0&&V(f,fi),i===void 0||V(f,{_0:`className`,_1:new st(i)}),a===void 0||V(f,{_0:`style`,_1:new st(a)}),o!==void 0){let e=o;V(f,{_0:`disabled`,_1:new st(()=>yl(e()))})}return Xg(`button`,f,d)}function __(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h,g,_,v,y){let b=h_(c,l,u,g,_,v,y);if(e===void 0||V(b,{_0:`type`,_1:new S(e)}),t===void 0||V(b,{_0:`name`,_1:new S(t)}),n===void 0||V(b,{_0:`value`,_1:new S(n)}),r===void 0||V(b,{_0:`placeholder`,_1:new S(r)}),i===-1||i===!0&&V(b,pi),a===-1||a===!0&&V(b,mi),o===-1||o===!0&&V(b,hi),s===-1||s===!0&&V(b,gi),d===void 0||V(b,{_0:`className`,_1:new st(d)}),f===void 0||V(b,{_0:`style`,_1:new st(f)}),p===void 0||V(b,{_0:`value`,_1:new st(p)}),m!==void 0){let e=m;V(b,{_0:`disabled`,_1:new st(()=>yl(e()))})}if(h!==void 0){let e=h;V(b,{_0:`checked`,_1:new st(()=>yl(e()))})}return Xg(`input`,b,[])}function J(e){return d_(e)}function v_(e){return Ug(e)}function y_(e,t){switch(e){case 0:return t===0;case 1:return t===1;case 2:return t===2;case 3:return t===3;case 4:return t===4;case 5:return t===5;case 6:return t===6;case 7:return t===7;case 8:return t===8;case 9:return t===9;default:return t===10}}function b_(e,t){switch(e){case 0:return t===0;case 1:return t===1;default:return t===2}}function x_(e,t){switch(e.$tag){case 0:{let n=e,r=n._0,i=n._1,a=n._2,o=n._3;if(t.$tag===0){let e=t,n=e._0,s=e._1,c=e._2,l=e._3;return r===n&&i===s&&rd(a,c)&&rd(o,l)}else return!1}case 1:{let n=e._0;return t.$tag===1?n===t._0:!1}case 2:{let n=e,r=n._0,i=n._1;if(t.$tag===2){let e=t,n=e._0,a=e._1;return r===n&&i===a}else return!1}case 3:{let n=e,r=n._0,i=n._1;if(t.$tag===3){let e=t,n=e._0,a=e._1;return r===n&&i===a}else return!1}case 4:{let n=e._0;if(t.$tag===4){let e=t._0;return lp(n,e)}else return!1}case 5:{let n=e,r=n._0,i=n._1,a=n._2,o=n._3,s=n._4;if(t.$tag===5){let e=t,n=e._0,c=e._1,l=e._2,u=e._3,d=e._4;return r===n&&i===c&&a===l&&o===u&&s===d}else return!1}default:{let n=e,r=n._0,i=n._1;if(t.$tag===6){let e=t,n=e._0,a=e._1;return r===n&&rd(i,a)}else return!1}}}function S_(e,t){return e===0?t===0:t===1}function C_(e){return!(e!==e||e>1e308||e<-1e308)}function w_(e,t,n,r,i){fu(e,{level:t,element_id:n,code:r,message:i})}function T_(e,t){return cf(td(e),e=>e.id===t)}function E_(e,t){let n=e.length,r=0;for(;;){let i=r;if(i<n){let n=e[i];if(n.id===t)return n;r=i+1|0;continue}else break}}function D_(e,t){if(sf(ed(t),e=>b_(e.level,0))||sf(ed(t),e=>b_(e.level,1)&&(e.code===_i||e.code===vi)))return Ci;switch(e.shape.$tag){case 3:return wi;case 6:return Ti;default:return Si}}function O_(e,t){let n=[],r=e,i=t.length+1|0,a=0;for(;;){let e=a;if(e<i){if(gp(n,r))return!0;su(n,r);let i=E_(t,r);if(i===void 0)return!1;{let e=i.parent_id;if(e===void 0)return!1;r=e}a=e+1|0;continue}else break}return!1}function k_(e,t,n,r){if(t!==void 0){let i=t;if(T_(n,i.element_id))return;w_(r,1,e,vi,`Connected element '${i.element_id}' does not exist`);return}}function A_(e,t){let n=e.shape;switch(n.$tag){case 0:{let r=n,i=r._0,a=r._1;if(i<0||a<0){w_(t,0,e.id,yi,`Rectangle has negative dimensions`);return}else return}case 1:if(n._0<0){w_(t,0,e.id,yi,`Circle has negative radius`);return}else return;case 2:{let r=n,i=r._0,a=r._1;if(i<0||a<0){w_(t,0,e.id,yi,`Ellipse has negative radius`);return}else return}case 3:{let r=n,i=r._0,a=r._1;if(e.x===i&&e.y===a){w_(t,1,e.id,`LINE_SAME_POINTS`,`Line start and end points are the same`);return}else return}case 6:if(n._0===``){w_(t,2,e.id,`TEXT_EMPTY`,`Text element has empty content`);return}else return;default:return}}function j_(e,t,n){let r=[];e.id===``&&w_(r,0,e.id,`INVALID_ID`,`Element has empty ID`),(!C_(e.x)||!C_(e.y))&&w_(r,0,e.id,`INVALID_COORDINATES`,`Element has invalid coordinates (NaN or Infinity)`);let i=Kd(n,e.id);i===void 0||i>1&&w_(r,0,e.id,`DUPLICATE_ID`,`Duplicate element ID: ${e.id}`);let a=e.parent_id;if(a!==void 0){let n=a;T_(t,n)||w_(r,1,e.id,_i,`Parent element '${n}' does not exist`),O_(e.id,t)&&w_(r,0,e.id,`CIRCULAR_PARENT`,`Circular parent reference detected`)}let o=e.connections;if(o!==void 0){let n=o;k_(e.id,n.start,t,r),k_(e.id,n.end,t,r);let i=n.start,a=n.end,s;if(i===void 0)s=!1;else{let e=i;if(a===void 0)s=!1;else{let t=a;s=e.element_id===t.element_id}}s&&w_(r,1,e.id,`SELF_CONNECTION`,`Line connects element to itself`)}return A_(e,r),r}function M_(e){let t=[],n=Hd({buf:[],start:0,end:0}),r=Ud({buf:[],start:0,end:0}),i=e.length,a=0;for(;;){let t=a;if(t<i){let n=e[t],i=Kd(r,n.id);if(i===void 0)Rd(r,n.id,1);else{let e=i;Rd(r,n.id,e+1|0)}a=t+1|0;continue}else break}let o=e.length,s=0;for(;;){let i=s;if(i<o){let a=e[i],o=j_(a,e,r),c=o.length,l=0;for(;;){let e=l;if(e<c){let n=o[e];fu(t,n),l=e+1|0;continue}else break}let u=D_(a,o);Ld(n,a.id,u),s=i+1|0;continue}else break}return{is_valid:!sf(ed(t),e=>b_(e.level,0)),issues:t,capabilities:n}}function N_(e){let t=[],n=[],r=e.length,i=0;for(;;){let a=i;if(a<r){let r=e[a];r.parent_id===void 0?ou(t,r):ou(n,r),i=a+1|0;continue}else break}return dp(t,{buf:n,start:0,end:n.length}),t}function P_(){return{start:void 0,end:void 0}}function F_(){return{fill:void 0,stroke:`#000000`,stroke_width:Ii,opacity:w,stroke_dasharray:void 0,marker_start:void 0,marker_end:void 0,font_family:void 0}}function I_(e,t,n){switch(e.$tag){case 1:return e._0>0;case 0:{let t=e,n=t._0,r=t._1;return n>0&&r>0}case 2:{let t=e,n=t._0,r=t._1;return n>0&&r>0}case 3:{let r=e,i=r._0,a=r._1,o=i-t,s=a-n;return o*o+s*s>0}case 5:return!1;case 4:return e._0.length>=2;default:return!0}}function L_(e){_L:switch(e.$tag){case 0:return{has_stroke:!0,has_fill:!0,has_stroke_width:!0,has_font:!1,has_dasharray:!1,has_arrows:!1,can_connect:!1,is_connection_target:!0,anchor_types:[0,1,2,3,4,5,6,7,8]};case 1:break _L;case 2:break _L;case 3:return{has_stroke:!0,has_fill:!1,has_stroke_width:!0,has_font:!1,has_dasharray:!0,has_arrows:!0,can_connect:!0,is_connection_target:!1,anchor_types:[9,10]};case 4:return{has_stroke:!0,has_fill:!1,has_stroke_width:!0,has_font:!1,has_dasharray:!0,has_arrows:!1,can_connect:!1,is_connection_target:!1,anchor_types:[9,10]};case 5:return{has_stroke:!0,has_fill:!1,has_stroke_width:!0,has_font:!1,has_dasharray:!0,has_arrows:!0,can_connect:!0,is_connection_target:!1,anchor_types:[9,10,0]};default:return{has_stroke:!0,has_fill:!1,has_stroke_width:!1,has_font:!0,has_dasharray:!1,has_arrows:!1,can_connect:!1,is_connection_target:!0,anchor_types:[0]}}return{has_stroke:!0,has_fill:!0,has_stroke_width:!0,has_font:!1,has_dasharray:!1,has_arrows:!1,can_connect:!1,is_connection_target:!0,anchor_types:[0,1,2,3,4]}}function Y(e,t,n,r){return{id:e,x:t,y:n,shape:r,style:F_(),transform:void 0,parent_id:void 0,connections:void 0}}function R_(e,t){return{...e,parent_id:t}}function X(e,t){return{...e,style:t}}function z_(e){return I_(e.shape,e.x,e.y)}function B_(e,t){if(t===void 0){let t=e.fill,n;return n=t===void 0?xi:t,n===`none`||n===``?xi:n}else return t}function V_(e,t){if(t!==void 0){let n=t,r=e.length,i=0;for(;;){let t=i;if(t<r){let r=e[t];if(r.id===n)return r.style.stroke;i=t+1|0;continue}else break}return}}function H_(e){let t=e.shape;switch(t.$tag){case 0:{let n=t,r=n._0,i=n._1;return{x:e.x,y:e.y,width:r,height:i}}case 1:{let n=t._0;return{x:e.x-n,y:e.y-n,width:n*2,height:n*2}}case 2:{let n=t,r=n._0,i=n._1;return{x:e.x-r,y:e.y-i,width:r*2,height:i*2}}case 3:{let n=t,r=n._0,i=n._1,a=e.x<r?e.x:r,o=e.y<i?e.y:i,s=e.x>r?e.x:r,c=e.y>i?e.y:i;return{x:a,y:o,width:s-a,height:c-o}}case 4:{let n=t._0;if(n.length===0)return{x:e.x,y:e.y,width:0,height:0};{let t=e.x,r=e.y,i=e.x,a=e.y,o=n.length,s=0;for(;;){let e=s;if(e<o){let o=n[e];o.x<t&&(t=o.x),o.y<r&&(r=o.y),o.x>i&&(i=o.x),o.y>a&&(a=o.y),s=e+1|0;continue}else break}return{x:t,y:r,width:i-t,height:a-r}}}case 5:{let n=t,r=n._1,i=n._2,a=n._3,o=n._4,s=e.x+(a-r),c=e.y+(o-i),l=e.x<s?e.x:s,u=e.x>s?e.x:s,d=e.y<c?e.y:c,f=e.y>c?e.y:c;return{x:l,y:d,width:u-l<10?10:u-l,height:f-d<10?10:f-d}}default:{let n=t,r=n._0,i=n._1,a=id(i,16),o=(lf(Du(r))+0)*a*.55,s=a*2,c=o<s?s:o,l=a*1.2;return{x:e.x-c/2,y:e.y-l/2,width:c,height:l}}}}function U_(e,t){_L:{let n=e.shape;switch(n.$tag){case 3:{let r=n,i=r._0,a=r._1;switch(t){case 9:return{x:e.x,y:e.y};case 10:return{x:i,y:a};default:break _L}}case 5:{let r=n,i=r._1,a=r._2,o=r._3,s=r._4;switch(t){case 9:return{x:e.x,y:e.y};case 10:return{x:e.x+(o-i),y:e.y+(s-a)};default:break _L}}default:break _L}}let n=H_(e),r=n.x+n.width/2,i=n.y+n.height/2;_L$2:switch(t){case 0:return{x:r,y:i};case 1:return{x:r,y:n.y};case 2:return{x:r,y:n.y+n.height};case 3:return{x:n.x,y:i};case 4:return{x:n.x+n.width,y:i};case 5:return{x:n.x,y:n.y};case 6:return{x:n.x+n.width,y:n.y};case 7:return{x:n.x,y:n.y+n.height};case 8:return{x:n.x+n.width,y:n.y+n.height};case 9:break _L$2;default:break _L$2}return{x:r,y:i}}function W_(e){let t=L_(e.shape).anchor_types,n=Array(t.length),r=t.length,i=0;for(;;){let a=i;if(a<r){let r=t[a];n[a]={_0:r,_1:U_(e,r)},i=a+1|0;continue}else break}return n}function G_(e,t,n){let r,i=W_(e),a=i.length,o=0;for(;;){let e=o;if(e<a){let a=i[e],s=a._0,c=a._1,l=t.x-c.x,u=t.y-c.y,d=Math.sqrt(l*l+u*u);if(d<=n){let e=r;(e===void 0||d<e._2)&&(r={_0:s,_1:c,_2:d})}o=e+1|0;continue}else break}return r}function K_(e,t,n){return{x:t/e.zoom+e.scroll_x,y:n/e.zoom+e.scroll_y}}function q_(e,t,n){return{x:(t-e.scroll_x)*e.zoom,y:(n-e.scroll_y)*e.zoom}}function J_(e){let t=e.start_x<e.current_x?e.start_x:e.current_x,n=e.start_y<e.current_y?e.start_y:e.current_y,r=e.start_x>e.current_x?e.start_x:e.current_x,i=e.start_y>e.current_y?e.start_y:e.current_y;return{x:t,y:n,width:r-t,height:i-n}}function Y_(e,t,n,r){return{x:n-e,y:r-t}}function X_(e,t){return!(e.x+e.width<t.x||t.x+t.width<e.x||e.y+e.height<t.y||t.y+t.height<e.y)}function Z_(e,t){let n=[],r=e.length,i=0;for(;;){let a=i;if(a<r){let r=e[a];r.parent_id===void 0&&X_(t,H_(r))&&ou(n,r),i=a+1|0;continue}else break}return n}function Q_(e,t,n,r){if(!r)return{_0:e,_1:t};let i=n+0;return{_0:Pp(e/i)*i,_1:Pp(t/i)*i}}function $_(e){switch(e.$tag){case 0:return`rect`;case 1:return`circle`;case 2:return`ellipse`;case 3:return`line`;case 4:return`polyline`;case 5:return`path`;default:return`text`}}function ev(e){switch(e){case`nw`:return 0;case`ne`:return 1;case`sw`:return 2;case`se`:return 3;case`line-start`:return 4;case`line-end`:return 5;default:return 3}}function tv(e){switch(e){case`center`:return 0;case`top`:return 1;case`bottom`:return 2;case`left`:return 3;case`right`:return 4;case`top-left`:return 5;case`top-right`:return 6;case`bottom-left`:return 7;case`bottom-right`:return 8;case`line-start`:return 9;case`line-end`:return 10;default:return}}function nv(e){switch(e){case 0:return`center`;case 1:return`top`;case 2:return`bottom`;case 3:return`left`;case 4:return`right`;case 5:return`top-left`;case 6:return`top-right`;case 7:return`bottom-left`;case 8:return`bottom-right`;case 9:return`line-start`;default:return`line-end`}}function rv(e,t,n,r){let i,a=e.length,o=0;for(;;){let s=o;if(s<a){_L:{let a=e[s];if(gp(n,a.id))break _L;if(a.parent_id===void 0){let e=G_(a,t,r);if(e===void 0)break _L;{let t=e,n=t._0,r=t._1,o=t._2,s=i;(s===void 0||o<s._3)&&(i={_0:a,_1:n,_2:r,_3:o})}}else break _L;break _L}o=s+1|0;continue}else break}let s=i;if(s!==void 0){let e=s;return{element:e._0,anchor:e._1,point:e._2}}}function iv(e){return Hu(Hu(Hu(Hu(e,{str:`&`,start:0,end:1},{str:`&amp;`,start:0,end:5}),{str:`<`,start:0,end:1},{str:`&lt;`,start:0,end:4}),{str:`>`,start:0,end:1},{str:`&gt;`,start:0,end:4}),{str:`"`,start:0,end:1},{str:`&quot;`,start:0,end:6})}function Z(e){return Fp(Pp(e*100)/100)}function av(e){return Pp(e)}function ov(e){let t=av(e.x),n=av(e.y),r=e.shape,i;switch(r.$tag){case 0:{let e=r,t=e._0,n=e._1,a=e._2,o=e._3;i=new pt(av(t),av(n),a,o);break}case 1:{let e=r._0;i=new mt(av(e));break}case 2:{let e=r,t=e._0,n=e._1;i=new ht(av(t),av(n));break}case 3:{let e=r,t=e._0,n=e._1;i=new gt(av(t),av(n));break}case 4:{let e=r._0,t=Array(e.length),n=e.length,a=0;for(;;){let r=a;if(r<n){let n=e[r];t[r]={x:av(n.x),y:av(n.y)},a=r+1|0;continue}else break}i=new _t(t);break}case 5:{let e=r,t=e._0,n=e._1,a=e._2,o=e._3,s=e._4;i=new vt(t,av(n),av(a),av(o),av(s));break}default:{let e=r,t=e._0,n=e._1;i=new yt(t,n)}}return{...e,x:t,y:n,shape:i}}function sv(e,t){switch(t){case 9:return{x:e.x,y:e.y};case 10:return{x:e.x2,y:e.y2};default:return{x:(e.x+e.x2)/2,y:(e.y+e.y2)/2}}}function cv(e,t,n,r,i){switch(i){case 9:return{x:e,y:t};case 10:return{x:n,y:r};default:return{x:(e+n)/2,y:(t+r)/2}}}function lv(e,t,n,r,i,a){let o=uf(td(e),e=>e.id===t);if(o===void 0)return[];{let s=o.shape;if(s.$tag===3){let o=s,c=o._0,l=o._1,u=c+i,d=l+a,f=Gd({buf:[],start:0,end:0});Bd(f,t,{id:t,x:n,y:r,x2:u,y2:d});let p=[t],m=[t];for(;p.length>0;){let t=ep(p,0),n=Yd(f,t);if(n===void 0)T();else{let r=n,i=e.length,a=0;for(;;){let n=a;if(n<i){_L:{let i=e[n],a=i.shape;if(a.$tag===3){let e=a,n=e._0,o=e._1;if(i.id!==t){let e=i.connections;if(e===void 0)break _L;{let a=e,s=Yd(f,i.id),c;if(s===void 0)c={_0:i.x,_1:i.y,_2:n,_3:o};else{let e=s;c={_0:e.x,_1:e.y,_2:e.x2,_3:e.y2}}let l=c._0,u=c._1,d=c._2,h=c._3,g=l,_=u,v=d,y=h,b=!1,te=a.start;if(te!==void 0){let e=te;if(e.element_id===t){let t=sv(r,e.anchor);g=t.x,_=t.y,b=!0}}let ne=a.end;if(ne!==void 0){let e=ne;if(e.element_id===t){let t=sv(r,e.anchor);v=t.x,y=t.y,b=!0}}b&&(Bd(f,i.id,{id:i.id,x:g,y:_,x2:v,y2:y}),gp(m,i.id)||(su(m,i.id),su(p,i.id)))}}else break _L}else break _L;break _L}a=n+1|0;continue}else break}}}return Vu(nf(f))}else return[]}}function uv(e,t,n){let r=Wd({buf:[],start:0,end:0}),i=e.length,a=0;for(;;){let t=a;if(t<i){let n=e[t],i=n.shape;if(i.$tag===3){let e=i,t=e._0,a=e._1;zd(r,n.id,{_0:n.x,_1:n.y,_2:t,_3:a})}a=t+1|0;continue}else break}let o=[],s=t.length,c=0;for(;;){let e=c;if(e<s){let n=t[e];su(o,n),c=e+1|0;continue}else break}let l=[];for(;o.length>0;){let t=ep(o,0);if(gp(l,t))continue;su(l,t);let i=uf(td(e),e=>e.id===t);if(i!==void 0){let a=i,s=e.length,c=0;for(;;){let i=c;if(i<s){_L:{let s=e[i];if(gp(n,s.id))break _L;let c=s.shape;if(c.$tag===3){let e=c,n=e._0,i=e._1,u=s.connections;if(u===void 0)break _L;{let e=u,c=Jd(r,s.id),d={_0:s.x,_1:s.y,_2:n,_3:i},f;f=c===void 0?d:c;let p=f._0,m=f._1,h=f._2,g=f._3,_=p,v=m,y=h,b=g,te=!1,ne=e.start;if(ne!==void 0){let e=ne;if(e.element_id===t){let n=U_(a,e.anchor),i=a.shape,o;if(i.$tag===3){let i=Jd(r,t);if(i===void 0)o=n;else{let t=i,n=t._0,r=t._1,a=t._2,s=t._3;o=cv(n,r,a,s,e.anchor)}}else o=n;(o.x!==_||o.y!==v)&&(_=o.x,v=o.y,te=!0)}}let re=e.end;if(re!==void 0){let e=re;if(e.element_id===t){let n=U_(a,e.anchor),i=a.shape,o;if(i.$tag===3){let i=Jd(r,t);if(i===void 0)o=n;else{let t=i,n=t._0,r=t._1,a=t._2,s=t._3;o=cv(n,r,a,s,e.anchor)}}else o=n;(o.x!==y||o.y!==b)&&(y=o.x,b=o.y,te=!0)}}te&&(zd(r,s.id,{_0:_,_1:v,_2:y,_3:b}),!gp(o,s.id)&&!gp(l,s.id)&&su(o,s.id))}}else break _L;break _L}c=i+1|0;continue}else break}}}let u=Array(e.length),d=e.length,f=0;for(;;){let t=f;if(t<d){let n=e[t],i=n.shape,a;if(i.$tag===3){let e=Jd(r,n.id);if(e===void 0)a=n;else{let t=e,r=t._0,i=t._1,o=t._2,s=t._3;_L:{_L$2:{if(r!==n.x||i!==n.y)break _L$2;_L$3:{let e=n.shape;if(e.$tag===3){let t=e,n=t._0,r=t._1;if(o!==n||s!==r)break _L$2;break _L$3}else break _L$3}a=n;break _L}a={...n,x:r,y:i,shape:new gt(o,s)}}}}else a=n;u[t]=a,f=t+1|0;continue}else break}return u}function dv(e,t,n){let r;return r=n.$tag===1?n._0:[],uv(e,t,r)}function fv(e,t,n,r,i,a,o){let s=lv(e,t,n,r,i,a),c=[],l=o.connections;if(l!==void 0){let t=l,n=t.start;if(n!==void 0){let t=n;!cf(td(e),e=>{if(e.id===t.element_id){let t=e.shape,n;return n=t.$tag===3,n}else return!1})&&!gp(c,t.element_id)&&su(c,t.element_id)}let r=t.end;if(r!==void 0){let t=r;!cf(td(e),e=>{if(e.id===t.element_id){let t=e.shape,n;return n=t.$tag===3,n}else return!1})&&!gp(c,t.element_id)&&su(c,t.element_id)}}let u=[],d=c.length,f=0;for(;;){let t=f;if(t<d){let n=c[t],r=e.length,i=0;for(;;){let t=i;if(t<r){let r=e[t];nd(r.parent_id,n)&&su(u,r.id),i=t+1|0;continue}else break}f=t+1|0;continue}else break}let p=Array(e.length),m=e.length,h=0;for(;;){let t=h;if(t<m){let n=e[t],r,o;_L:{_L$2:{let e=s.length,t=0;for(;;){let r=t;if(r<e){let e=s[r];if(n.id===e.id){o={...n,x:e.x,y:e.y,shape:new gt(e.x2,e.y2)};break _L$2}t=r+1|0;continue}else break}if(gp(c,n.id)){o={...n,x:n.x+i,y:n.y+a};break _L$2}if(gp(u,n.id)){o={...n,x:n.x+i,y:n.y+a};break _L$2}r=n;break _L}r=o}p[t]=r,h=t+1|0;continue}else break}return p}function pv(e,t,n,r,i,a,o){let s=[],c=e.length,l=0;for(;;){let n=l;if(n<c){let r=e[n];nd(r.parent_id,t)&&su(s,r.id),l=n+1|0;continue}else break}let u=Array(e.length),d=e.length,f=0;for(;;){let o=f;if(o<d){let c=e[o];u[o]=c.id===t?{...c,x:n,y:r}:gp(s,c.id)?{...c,x:c.x+i,y:c.y+a}:c,f=o+1|0;continue}else break}return dv(u,[t],Nn)}function mv(e,t,n,r){let i,a=e.length,o=0;for(;;){let n=o;if(n<a){let r=e[n];if(r.id===t){i=r;break}o=n+1|0;continue}else break}let s=i;if(s===void 0)return e;{let i=s,a=n-i.x,o=r-i.y;return i.shape.$tag===3?fv(e,t,n,r,a,o,i):pv(e,t,n,r,a,o,i)}}function hv(e,t,n){let r,i=e.length,a=0;for(;;){let n=a;if(n<i){let i=e[n];if(i.id===t){r=i;break}a=n+1|0;continue}else break}let o=r;if(o===void 0)return e;{let r=H_({...o,shape:n}),i=r.x+r.width/2,a=r.y+r.height/2,s=Array(e.length),c=e.length,l=0;for(;;){let r=l;if(r<c){let o=e[r];s[r]=o.id===t?{...o,shape:n}:nd(o.parent_id,t)?{...o,x:i,y:a}:o,l=r+1|0;continue}else break}return dv(s,[t],Nn)}}function gv(){return{undo_stack:[],redo_stack:[]}}function _v(e,t){let n=Cl(t,10);return Yg(di,`svg`,[{_0:`width`,_1:new S(n)},{_0:`height`,_1:new S(n)},Ri,zi,Bi,Vi,Hi,Ui,Wi],[Yg(di,`path`,[{_0:`d`,_1:new S(e)}],[])])}function vv(e,t,n,r,i){Li.val=Li.val+1|0;let a=`tooltip-${vl(Li.val)}`,o=`display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 2px; padding: 4px 6px; cursor: pointer; border: 1px solid ${i.ui_border}; border-radius: 4px; background: ${i.ui_bg}; min-width: 36px; height: 40px; position: relative; color: ${i.ui_text};`,s=`color: ${i.ui_text_muted}; font-size: 9px; font-family: system-ui, sans-serif; line-height: 1;`,c=[{_0:`style`,_1:new S(o)},{_0:`aria-label`,_1:new S(n)},{_0:`click`,_1:new C(e=>{r()})},{_0:`mouseenter`,_1:new C(e=>{Yn(a,e)})},{_0:`mouseleave`,_1:new C(e=>{Xn(a)})}],l;return l=t===void 0?[e]:[e,q(void 0,void 0,s,void 0,void 0,k,void 0,j,M,[J(t)])],K(void 0,void 0,`position: relative; display: inline-block;`,void 0,void 0,k,void 0,j,M,[Xg(`button`,c,l),K(void 0,void 0,`position: fixed; margin: 0; padding: 4px 8px; background: #333; color: #fff; font-size: 11px; border-radius: 4px; white-space: nowrap; border: none;`,void 0,void 0,k,void 0,new Zn([{_0:`id`,_1:new lt(a)},Gi]),M,[J(n)])])}function yv(e){return q(void 0,void 0,`width: 1px; height: 24px; background: ${e.ui_border}; margin: 0 2px;`,void 0,void 0,k,void 0,j,M,[])}function bv(e,t){return e===0?t===0:t===1}function xv(e,t){return{width:e,height:t,canvas_width:nh(e),canvas_height:nh(t),doc_width:rh(400),doc_height:rh(300),elements:ih([]),selected_ids:ah([]),drag_state:oh(void 0),multi_drag_state:sh(void 0),resize_state:ch(void 0),box_select:lh(void 0),context_menu:uh(void 0),viewport:dh(Ki),grid_enabled:fh(!1),grid_size:nh(20),is_panning:fh(!1),pan_start:ph(void 0),text_edit:mh(void 0),pending_connection:hh(void 0),placement_state:gh(void 0),mouse_scene_pos:_h(qi),mouse_in_canvas:fh(!1),preview_bg:vh(`#ffffff`),embed_bg:vh(`transparent`),theme_mode:yh(0),is_mobile:fh(e<768),panel_visible:fh(!0),mode:0,modal_open:fh(!1),has_focus:fh(!0),is_readonly:fh(!1),show_toolbar:fh(!0),anchor_drag_state:bh(void 0),svg_el:xh($n()),container_el:xh($n()),tool_mode:Sh(0),free_draw_state:Ch(void 0),free_draw_options:wh(Ji),last_placement_pos:Th(void 0),pinch_state:Eh(void 0),validation_result:Dh(void 0),plain_svg_ids:ah([])}}function Sv(e,t,n){return{...xv(e,t),mode:n}}function Cv(e){return bm(e.theme_mode)===0?Ei:Di}function wv(e){return{fill:`var(--ml-fill)`,stroke:bi,stroke_width:Yi,opacity:w,stroke_dasharray:void 0,marker_start:void 0,marker_end:void 0,font_family:void 0}}function Tv(e){return{fill:xi,stroke:void 0,stroke_width:w,opacity:w,stroke_dasharray:void 0,marker_start:void 0,marker_end:void 0,font_family:void 0}}function Ev(e){return{fill:void 0,stroke:bi,stroke_width:Xi,opacity:w,stroke_dasharray:void 0,marker_start:void 0,marker_end:void 0,font_family:void 0}}function Dv(e){return{fill:void 0,stroke:bi,stroke_width:Zi,opacity:w,stroke_dasharray:void 0,marker_start:void 0,marker_end:1,font_family:void 0}}function Ov(e,t,n,r){hg(e.text_edit,{parent_id:t,x:n,y:r,editing_id:void 0,initial_text:``,font_size:w})}function kv(e,t,n,r,i,a,o){hg(e.text_edit,{parent_id:n,x:r,y:i,editing_id:t,initial_text:a,font_size:o})}function Av(e){hg(e.text_edit,void 0)}function jv(e){Og(e.grid_enabled,e=>!e)}function Mv(e,t,n){return Q_(t,n,om(e.grid_size),um(e.grid_enabled))}function Q(e,t){let n=W(e.elements),r=n.length,i=0;for(;;){let e=i;if(e<r){let r=n[e];if(r.id===t)return r;i=e+1|0;continue}else break}}function Nv(e,t){let n=W(e.elements),r=n.length,i=0;for(;;){let e=i;if(e<r){if(n[e].id===t)return!0;i=e+1|0;continue}else break}return!1}function Pv(e,t){let n=[],r=W(e.elements),i=r.length,a=0;for(;;){let e=a;if(e<i){let i=r[e];nd(i.parent_id,t)&&ou(n,i),a=e+1|0;continue}else break}return n}function Fv(e,t){let n=Q(e,t);return n===void 0?!1:n.parent_id!==void 0}function Iv(e,t){let n=Q(e,t);if(n!==void 0)return n.parent_id}function Lv(e,t,n){Tg(e.elements,e=>{let r=Array(e.length),i=e.length,a=0;for(;;){let o=a;if(o<i){let i=e[o];r[o]=i.id===t?n(i):i,a=o+1|0;continue}else break}return r})}function Rv(e,t,n,r){let i=av(n),a=av(r),o=mv(W(e.elements),t,i,a);ag(e.elements,o)}function zv(e,t){if(t===void 0){ug(e.selected_ids,[]);return}else{let n=t;ug(e.selected_ids,[n]);return}}function Bv(e,t){ug(e.selected_ids,t)}function Vv(e,t){let n=vm(e.selected_ids);if(!gp(n,t)){let r=rp(n);su(r,t),ug(e.selected_ids,r);return}}function Hv(e,t){Eg(e.selected_ids,e=>{let n=[],r=e.length,i=0;for(;;){let a=i;if(a<r){let r=e[a];r!==t&&su(n,r),i=a+1|0;continue}else break}return n})}function Uv(e,t){return gp(vm(e.selected_ids),t)}function Wv(e){let t=vm(e.selected_ids);return t.length>0?Fc(t,0):void 0}function Gv(e,t,n,r){let i=Q(e,t);if(i===void 0){T();return}else{let a=i,o,s,c;_L:if(a.shape.$tag===3){let t=[],n=a.connections;if(n!==void 0){let r=n,i=r.start;if(i!==void 0){let n=i,r=Q(e,n.element_id);if(r!==void 0){let e=r;hu(t,{_0:n.element_id,_1:e.x,_2:e.y})}}let a=r.end;if(a!==void 0){let n=a,r=Q(e,n.element_id);if(r!==void 0){let e=r;hu(t,{_0:n.element_id,_1:e.x,_2:e.y})}}}let r=a.shape,i=a.connections;o=r,s=i,c=t;break _L}else{o=void 0,s=void 0,c=[];break _L}let l=n-a.x,u=r-a.y;xg(e.drag_state,{element_id:t,start_x:a.x,start_y:a.y,offset_x:l,offset_y:u,start_shape:o,start_connections:s,connected_start_positions:c});return}}function Kv(e,t,n){let r=hm(e.drag_state);if(r===void 0){T();return}else{let i=r,a=Y_(i.offset_x,i.offset_y,t,n),o=Mv(e,a.x,a.y),s=o._0,c=o._1;Rv(e,i.element_id,s,c);return}}function qv(e){let t=hm(e.drag_state);if(t!==void 0){let n=t;Tg(e.elements,e=>{let t=Array(e.length),r=e.length,i=0;for(;;){let a=i;if(a<r){let r=e[a];t[a]=r.id===n.element_id?ov(r):r,i=a+1|0;continue}else break}return t})}xg(e.drag_state,void 0)}function Jv(e){return hm(e.drag_state)!==void 0}function Yv(e,t,n,r,i,a){pg(e.context_menu,{x:t,y:n,scene_x:r,scene_y:i,target_id:a})}function Xv(e){pg(e.context_menu,void 0)}function Zv(e,t){Tg(e.elements,e=>{let n=[],r=e.length,i=0;for(;;){let a=i;if(a<r){let r=e[a];r.id!==t&&ou(n,r),i=a+1|0;continue}else break}return n}),Hv(e,t)}function Qv(e,t){if(z_(t)){Tg(e.elements,e=>{let n=ip(e);return ou(n,t),n});return}else return}function $v(e,t){Tg(e.elements,e=>{let n=[],r=e.length,i=0;for(;;){let a=i;if(a<r){let r=e[a],o;o=r.id===t?!1:Mc(r.parent_id,t),o&&ou(n,r),i=a+1|0;continue}else break}return n}),Hv(e,t)}function ey(e,t){let n=W(e.elements),r=0;for(;;){let e=r;if(e<n.length){if(Rc(n,e).id===t)return e;r=e+1|0;continue}else break}}function ty(e,t,n){Tg(e.elements,e=>{let r=-1,i=0;for(;;){let n=i;if(n<e.length){if(Rc(e,n).id===t){r=n;break}i=n+1|0;continue}else break}if(r<0)return e;let a=Rc(e,r),o=[],s=0;for(;;){let t=s;if(t<e.length){t!==r&&ou(o,Rc(e,t)),s=t+1|0;continue}else break}let c=n>o.length?o.length:n<0?0:n,l=[],u=0;for(;;){let e=u;if(e<o.length){e===c&&ou(l,a),ou(l,Rc(o,e)),u=e+1|0;continue}else break}return c>=o.length&&ou(l,a),l})}function ny(e,t,n){Tg(e.elements,e=>{let r=Array(e.length),i=e.length,a=0;for(;;){let o=a;if(o<i){let i=e[o];r[o]=i.id===t?{...i,style:n}:i,a=o+1|0;continue}else break}return r})}function ry(e,t,n){Tg(e.elements,e=>{let r=Array(e.length),i=e.length,a=0;for(;;){let o=a;if(o<i){let i=e[o];r[o]=i.id===t?{...i,id:n}:i,a=o+1|0;continue}else break}return r}),Eg(e.selected_ids,e=>{let r=Array(e.length),i=e.length,a=0;for(;;){let o=a;if(o<i){let i=e[o];r[o]=i===t?n:i,a=o+1|0;continue}else break}return r})}function iy(e,t,n){Tg(e.elements,e=>{let r=Array(e.length),i=e.length,a=0;for(;;){let o=a;if(o<i){let i=e[o],s;if(i.id===t){let e=i.shape;if(e.$tag===6){let t=e._1;s={...i,shape:new yt(n,t)}}else s=i}else s=i;r[o]=s,a=o+1|0;continue}else break}return r})}function ay(e,t){let n=W(e.elements),r=ey(e,t);if(r!==void 0){let i=r,a=i+1|0;if(a<n.length)return ty(e,t,a),{_0:i,_1:a}}}function oy(e,t){let n=W(e.elements),r=ey(e,t);if(r!==void 0){let i=r,a=n.length-1|0;if(i!==a)return ty(e,t,a),{_0:i,_1:a}}}function sy(e,t){let n=ey(e,t);if(n!==void 0){let r=n;if(r>0){let n=r-1|0;return ty(e,t,n),{_0:r,_1:n}}}}function cy(e,t){let n=ey(e,t);if(n!==void 0){let r=n;if(r!==0)return ty(e,t,0),{_0:r,_1:0}}}function ly(e){Dg(e.viewport,e=>{let t=e.zoom*1.01,n=t>4?4:t;return{scroll_x:e.scroll_x,scroll_y:e.scroll_y,zoom:n}})}function uy(e){Dg(e.viewport,e=>{let t=e.zoom/1.01,n=t<.25?.25:t;return{scroll_x:e.scroll_x,scroll_y:e.scroll_y,zoom:n}})}function dy(e,t,n,r){Dg(e.viewport,e=>{let i=K_(e,t,n),a=r?1.01:.9900990099009901,o=e.zoom*a,s=o>4?4:o<.25?.25:o;return{scroll_x:i.x-t/s,scroll_y:i.y-n/s,zoom:s}})}function fy(e,t,n,r,i){let a=i.x-r.x,o=i.y-r.y,s=Math.sqrt(a*a+o*o),c=sm(e.viewport),l=K_(c,(r.x+i.x)/2,(r.y+i.y)/2);gg(e.pinch_state,{pointer1_id:t,pointer2_id:n,pointer1_pos:r,pointer2_pos:i,initial_distance:s,initial_zoom:c.zoom,center:l})}function py(e,t,n){let r=Cm(e.pinch_state);if(r!==void 0){let i=r,a;if(t===i.pointer1_id)a={_0:n,_1:i.pointer2_pos};else if(t===i.pointer2_id)a={_0:i.pointer1_pos,_1:n};else return;let o=a._0,s=a._1,c=s.x-o.x,l=s.y-o.y,u=Math.sqrt(c*c+l*l)/i.initial_distance,d=i.initial_zoom*u,f=d>4?4:d<.25?.25:d,p=(o.x+s.x)/2,m=(o.y+s.y)/2,h=i.center.x-p/f,g=i.center.y-m/f;rg(e.viewport,{scroll_x:h,scroll_y:g,zoom:f}),gg(e.pinch_state,{...i,pointer1_pos:o,pointer2_pos:s});return}}function my(e,t){let n=Cm(e.pinch_state);if(n!==void 0){let r=n;if(t===r.pointer1_id||t===r.pointer2_id){gg(e.pinch_state,void 0);return}else return}}function hy(e){return Cm(e.pinch_state)!==void 0}function gy(e){let t=ym(e.doc_width),n=ym(e.doc_height),r=om(e.canvas_width)+0,i=om(e.canvas_height)+0,a=r/(t+80),o=i/(n+80),s=a<o?a:o,c=r/s,l=i/s,u=-(c-t)/2,d=-(l-n)/2;rg(e.viewport,{scroll_x:u,scroll_y:d,zoom:s})}function _y(e){gy(e)}function vy(e){let t=sm(e.viewport),n=om(e.canvas_width)+0,r=om(e.canvas_height)+0;return{x:t.scroll_x+n/t.zoom/2,y:t.scroll_y+r/t.zoom/2}}function yy(e){let t=um(e.mouse_in_canvas)?_m(e.mouse_scene_pos):vy(e),n=Dm(e.last_placement_pos),r;if(n===void 0)r={x:av(t.x),y:av(t.y)};else{let e=n;r=Math.abs(t.x-e.x)<1&&Math.abs(t.y-e.y)<1?{x:av(e.x+15),y:av(e.y+15)}:{x:av(t.x),y:av(t.y)}}return Sg(e.last_placement_pos,r),r}function by(e,t,n){Dg(e.viewport,e=>({scroll_x:e.scroll_x+t,scroll_y:e.scroll_y+n,zoom:e.zoom}))}function xy(e,t,n){tg(e.is_panning,!0),mg(e.pan_start,{_0:t,_1:n})}function Sy(e,t,n){let r=Tm(e.pan_start);if(r!==void 0){let i=r,a=i._0,o=i._1,s=sm(e.viewport),c=(a-t)/s.zoom,l=(o-n)/s.zoom;Dg(e.viewport,e=>({scroll_x:e.scroll_x+c,scroll_y:e.scroll_y+l,zoom:e.zoom})),mg(e.pan_start,{_0:t,_1:n});return}}function Cy(e){tg(e.is_panning,!1),mg(e.pan_start,void 0)}function wy(e,t,n,r,i){let a=Q(e,t);if(a===void 0){T();return}else{let o=a;yg(e.resize_state,{element_id:t,handle:n,start_x:o.x,start_y:o.y,start_shape:o.shape,mouse_start_x:r,mouse_start_y:i});return}}function Ty(e,t,n,r){let i=rv(W(e.elements),t,n,r);if(i!==void 0){let e=i;return{_0:e.element,_1:e.anchor,_2:e.point}}}function Ey(e,t){Tg(e.elements,e=>dv(e,[t],Nn))}function Dy(e,t){if(um(e.grid_enabled)){let n=om(e.grid_size)+0;return Pp(t/n)*n}else return t}function Oy(e,t,n){let r=pm(e.resize_state);if(r===void 0){T();return}else{let i=r,a=t-i.mouse_start_x,o=n-i.mouse_start_y,s=i.start_shape;switch(s.$tag){case 0:{let t=s,n=t._0,r=t._1,c=t._2,l=t._3,u=i.start_x,d=i.start_y,f=i.start_x+n,p=i.start_y+r,m,h,g,_;_L:switch(i.handle){case 3:{let t=Dy(e,f+a),n=Dy(e,p+o);m=u,h=d,g=t,_=n;break _L}case 0:{let t=Dy(e,u+a),n=Dy(e,d+o);m=t,h=n,g=f,_=p;break _L}case 1:{let t=Dy(e,f+a),n=Dy(e,d+o);m=u,h=n,g=t,_=p;break _L}case 2:{let t=Dy(e,u+a),n=Dy(e,p+o);m=t,h=d,g=f,_=n;break _L}default:{let e=f+a,t=p+o;m=u,h=d,g=e,_=t;break _L}}let v;if(g-m<10)_L$2:{_L$3:{switch(i.handle){case 0:break _L$3;case 2:break _L$3;default:v={_0:m,_1:m+10}}break _L$2}v={_0:g-10,_1:g}}else v={_0:m,_1:g};let y=v._0,b=v._1,te;if(_-h<10)_L$2:{_L$3:{switch(i.handle){case 0:break _L$3;case 1:break _L$3;default:te={_0:h,_1:h+10}}break _L$2}te={_0:_-10,_1:_}}else te={_0:h,_1:_};let ne=te._0,re=te._1,ie=b-y,ae=re-ne,oe=y+ie/2,se=ne+ae/2;Tg(e.elements,e=>{let t=Array(e.length),n=e.length,r=0;for(;;){let a=r;if(a<n){let n=e[a];t[a]=n.id===i.element_id?{...n,x:y,y:ne,shape:new pt(ie,ae,c,l)}:nd(n.parent_id,i.element_id)?{...n,x:oe,y:se}:n,r=a+1|0;continue}else break}return t}),Ey(e,i.element_id);return}case 1:{let t=s._0,n=i.start_x,r=i.start_y,c,l;_L$2:switch(i.handle){case 3:{let e=n+t+a,i=r+t+o;c=e,l=i;break _L$2}case 0:{let e=n-t+a,i=r-t+o;c=e,l=i;break _L$2}case 1:{let e=n+t+a,i=r-t+o;c=e,l=i;break _L$2}case 2:{let e=n-t+a,i=r+t+o;c=e,l=i;break _L$2}default:{let e=n+t+a,i=r+t+o;c=e,l=i;break _L$2}}let u=Dy(e,c),d=Dy(e,l),f=(Math.abs(u-n)+Math.abs(d-r))/2,p=f<5?5:f;Tg(e.elements,e=>{let t=Array(e.length),a=e.length,o=0;for(;;){let s=o;if(s<a){let a=e[s];t[s]=a.id===i.element_id?{...a,shape:new mt(p)}:nd(a.parent_id,i.element_id)?{...a,x:n,y:r}:a,o=s+1|0;continue}else break}return t}),Ey(e,i.element_id);return}case 2:{let t=s,n=t._0,r=t._1,c=i.start_x,l=i.start_y,u=c-n,d=l-r,f=c+n,p=l+r,m,h,g,_;_L$3:switch(i.handle){case 3:{let t=Dy(e,f+a),n=Dy(e,p+o);m=u,h=d,g=t,_=n;break _L$3}case 0:{let t=Dy(e,u+a),n=Dy(e,d+o);m=t,h=n,g=f,_=p;break _L$3}case 1:{let t=Dy(e,f+a),n=Dy(e,d+o);m=u,h=n,g=t,_=p;break _L$3}case 2:{let t=Dy(e,u+a),n=Dy(e,p+o);m=t,h=d,g=f,_=n;break _L$3}default:{let e=f+a,t=p+o;m=u,h=d,g=e,_=t;break _L$3}}let v=(m+g)/2,y=(h+_)/2,b=(g-m)/2,te=(_-h)/2,ne=b<5?5:b,re=te<5?5:te;Tg(e.elements,e=>{let t=Array(e.length),n=e.length,r=0;for(;;){let a=r;if(a<n){let n=e[a];t[a]=n.id===i.element_id?{...n,x:v,y,shape:new ht(ne,re)}:nd(n.parent_id,i.element_id)?{...n,x:v,y}:n,r=a+1|0;continue}else break}return t}),Ey(e,i.element_id);return}case 3:{let t=s,n=t._0,r=t._1;switch(i.handle){case 4:{let t=i.start_x+a,n=i.start_y+o,r=Ty(e,{x:t,y:n},[i.element_id],20),s;if(r===void 0)s={_0:Dy(e,t),_1:Dy(e,n)};else{let e=r._2;s={_0:e.x,_1:e.y}}let c=s._0,l=s._1;if(r===void 0)vg(e.pending_connection,void 0);else{let t=r,n=t._0,i=t._1,a=t._2;vg(e.pending_connection,{target_id:n.id,anchor:i,point:a})}Tg(e.elements,e=>{let t=Array(e.length),n=e.length,r=0;for(;;){let a=r;if(a<n){let n=e[a];t[a]=n.id===i.element_id?{...n,x:c,y:l}:n,r=a+1|0;continue}else break}return t}),Ey(e,i.element_id);return}case 5:{let t=n+a,s=r+o,c=Ty(e,{x:t,y:s},[i.element_id],20),l;if(c===void 0)l={_0:Dy(e,t),_1:Dy(e,s)};else{let e=c._2;l={_0:e.x,_1:e.y}}let u=l._0,d=l._1;if(c===void 0)vg(e.pending_connection,void 0);else{let t=c,n=t._0,r=t._1,i=t._2;vg(e.pending_connection,{target_id:n.id,anchor:r,point:i})}Tg(e.elements,e=>{let t=Array(e.length),n=e.length,r=0;for(;;){let a=r;if(a<n){let n=e[a];t[a]=n.id===i.element_id?{...n,shape:new gt(u,d)}:n,r=a+1|0;continue}else break}return t}),Ey(e,i.element_id);return}default:return}}default:return}}}function ky(e,t){let n=W(e.elements),r,i=n.length,a=0;for(;;){let e=a;if(e<i){let i=n[e];if(i.id===t){r=i;break}a=e+1|0;continue}else break}let o=r;if(o!==void 0){let n=H_(o),r=n.x+n.width/2,i=n.y+n.height/2;Tg(e.elements,e=>{let n=Array(e.length),a=e.length,o=0;for(;;){let s=o;if(s<a){let a=e[s];n[s]=nd(a.parent_id,t)?{...a,x:r,y:i}:a,o=s+1|0;continue}else break}return n});return}}function Ay(e,t,n){Tg(e.elements,e=>{let r=Array(e.length),i=e.length,a=0;for(;;){let o=a;if(o<i){let i=e[o];r[o]=i.id===t?{...i,connections:n}:i,a=o+1|0;continue}else break}return r})}function jy(e){let t=pm(e.resize_state);if(t!==void 0){let n=t,r=Q(e,n.element_id);if(r!==void 0){let t=r;if(t.shape.$tag===3){let r=Sm(e.pending_connection);if(r===void 0){let r=t.connections,i=P_(),a;a=r===void 0?i:r;let o=n.handle,s;switch(o){case 4:s={start:void 0,end:a.end};break;case 5:s={start:a.start,end:void 0};break;default:s=a}_L:{_L$2:{if(s.start===void 0)if(s.end===void 0)Tg(e.elements,e=>{let t=Array(e.length),r=e.length,i=0;for(;;){let a=i;if(a<r){let r=e[a];t[a]=r.id===n.element_id?{...r,connections:void 0}:r,i=a+1|0;continue}else break}return t});else break _L$2;else break _L$2;break _L}Ay(e,n.element_id,s)}}else{let i=r,a=t.connections,o=P_(),s;s=a===void 0?o:a;let c=n.handle,l;switch(c){case 4:l={start:{element_id:i.target_id,anchor:i.anchor},end:s.end};break;case 5:{let e={element_id:i.target_id,anchor:i.anchor};l={start:s.start,end:e};break}default:l=s}Ay(e,n.element_id,l)}}else ky(e,n.element_id);let i=t.shape;if(i.$tag===3){let r=i,a=r._0,o=r._1,s=a-t.x,c=o-t.y;if(Math.sqrt(s*s+c*c)<5){Zv(e,n.element_id),vg(e.pending_connection,void 0),yg(e.resize_state,void 0),zv(e,void 0);return}}}}let n=pm(e.resize_state);if(n!==void 0){let t=n;Tg(e.elements,e=>{let n=Array(e.length),r=e.length,i=0;for(;;){let a=i;if(a<r){let r=e[a];n[a]=r.id===t.element_id?ov(r):r,i=a+1|0;continue}else break}return n})}let r=pm(e.resize_state);r===void 0||zv(e,r.element_id),vg(e.pending_connection,void 0),yg(e.resize_state,void 0)}function My(e){return pm(e.resize_state)!==void 0}function Ny(e,t){switch(e.$tag){case 0:{let n=e._0;Qv(t,n);return}case 1:{let n=e._0;$v(t,n.id);return}case 2:{let n=e,r=n._0,i=n._3,a=n._4,o=mv(W(t.elements),r,i,a);ag(t.elements,o);return}case 3:{let n=e,r=n._0,i=n._2,a=hv(W(t.elements),r,i);ag(t.elements,a);return}case 4:{let n=e,r=n._0,i=n._2;ty(t,r,i);return}case 5:{let n=e,r=n._0,i=n._2;ny(t,r,i);return}case 6:{let n=e,r=n._0,i=n._1;ry(t,r,i);return}default:{let n=e,r=n._0,i=n._2;iy(t,r,i);return}}}function $(e,t,n){Ny(n,t),cu(e.undo_stack,n),fp(e.redo_stack)}function Py(e,t){switch(e.$tag){case 0:{let n=e._0;$v(t,n.id);return}case 1:{let n=e._0;Qv(t,n);return}case 2:{let n=e,r=n._0,i=n._1,a=n._2,o=mv(W(t.elements),r,i,a);ag(t.elements,o);return}case 3:{let n=e,r=n._0,i=n._1,a=hv(W(t.elements),r,i);ag(t.elements,a);return}case 4:{let n=e,r=n._0,i=n._1;ty(t,r,i);return}case 5:{let n=e,r=n._0,i=n._1;ny(t,r,i);return}case 6:{let n=e,r=n._0,i=n._1;ry(t,i,r);return}default:{let n=e,r=n._0,i=n._1;iy(t,r,i);return}}}function Fy(e,t){let n=$f(e.undo_stack);if(n===void 0)return!1;{let r=n;return Py(r,t),cu(e.redo_stack,r),!0}}function Iy(e,t){let n=$f(e.redo_stack);if(n===void 0)return!1;{let r=n;return Ny(r,t),cu(e.undo_stack,r),!0}}function Ly(e,t,n){_g(e.box_select,{start_x:t,start_y:n,current_x:t,current_y:n})}function Ry(e,t,n){let r=xm(e.box_select);if(r===void 0){T();return}else{let i=r;_g(e.box_select,{start_x:i.start_x,start_y:i.start_y,current_x:t,current_y:n});return}}function zy(e){let t=xm(e.box_select);if(t!==void 0){let n=J_(t);if(n.width>5||n.height>5){let t=Z_(W(e.elements),n),r=Array(t.length),i=t.length,a=0;for(;;){let e=a;if(e<i){r[e]=t[e].id,a=e+1|0;continue}else break}Bv(e,r)}}_g(e.box_select,void 0)}function By(e){return xm(e.box_select)!==void 0}function Vy(e,t,n){let r=vm(e.selected_ids);if(r.length===0)return;let i=[],a=[],o=r.length,s=0;for(;;){let t=s;if(t<o){let n=r[t],o=Q(e,n);if(o!==void 0){let e=o;hu(i,{_0:n,_1:e.x,_2:e.y});let t=e.shape;if(t.$tag===3){let e=t,r=e._0,i=e._1;hu(a,{_0:n,_1:r,_2:i})}}s=t+1|0;continue}else break}bg(e.multi_drag_state,{element_ids:r,start_positions:i,line_endpoints:a,mouse_start_x:t,mouse_start_y:n})}function Hy(e,t){let n=e.line_endpoints,r=n.length,i=0;for(;;){let e=i;if(e<r){let r=n[e],a=r._0,o=r._1,s=r._2;if(a===t)return{_0:o,_1:s};i=e+1|0;continue}else break}}function Uy(e,t,n){let r=mm(e.multi_drag_state);if(r===void 0){T();return}else{let i=r,a=t-i.mouse_start_x,o=n-i.mouse_start_y,s=i.element_ids,c=i.start_positions,l=c.length,u=0;for(;;){let t=u;if(t<l){_L:{let n=c[t],r=n._0,l=n._1,u=n._2,d=Q(e,r);if(d===void 0)break _L;{let t=d;if(t.shape.$tag===3){let n=t.connections,c=P_(),d;d=n===void 0?c:n;let f=d.start,p;p=f===void 0?!1:!gp(s,f.element_id);let m=d.end,h;if(h=m===void 0?!1:!gp(s,m.element_id),p&&h)break _L;if(p){let t=Hy(i,r);if(t===void 0)break _L;{let n=t,i=n._0,s=n._1,c=i+a,l=s+o;Tg(e.elements,e=>{let t=Array(e.length),n=e.length,i=0;for(;;){let a=i;if(a<n){let n=e[a];t[a]=n.id===r?{...n,shape:new gt(c,l)}:n,i=a+1|0;continue}else break}return t})}}else if(h){let t=Hy(i,r);if(t===void 0)break _L;{let n=t,i=n._0,s=n._1,c=Mv(e,l+a,u+o),d=c._0,f=c._1;Tg(e.elements,e=>{let t=Array(e.length),n=e.length,a=0;for(;;){let o=a;if(o<n){let n=e[o];t[o]=n.id===r?{...n,x:d,y:f,shape:new gt(i,s)}:n,a=o+1|0;continue}else break}return t})}}else{let t=Mv(e,l+a,u+o),n=t._0,i=t._1;Rv(e,r,n,i)}}else{let t=Mv(e,l+a,u+o),n=t._0,i=t._1;Rv(e,r,n,i)}}break _L}u=t+1|0;continue}else return}}}function Wy(e){let t=mm(e.multi_drag_state);if(t!==void 0){let n=t.element_ids;Tg(e.elements,e=>{let t=Array(e.length),r=e.length,i=0;for(;;){let a=i;if(a<r){let r=e[a];t[a]=gp(n,r.id)?ov(r):r,i=a+1|0;continue}else break}return t})}bg(e.multi_drag_state,void 0)}function Gy(e){return mm(e.multi_drag_state)!==void 0}function Ky(e,t){ky(e,t),Ey(e,t)}function qy(e,t){if(um(e.grid_enabled)){let n=om(e.grid_size)+0;return Pp(t/n)*n}else return t}function Jy(e,t){let n=gm(e.placement_state);if(n===void 0){T();return}else{let r=n,i=Q(e,r.element_id);if(i===void 0){T();return}else{let n=i;r.has_moved||(fg(e.placement_state,{...r,has_moved:!0}),r.is_arrow&&Lv(e,r.element_id,e=>({...e,style:{...e.style,marker_end:1}})));let a=r.anchor_point.x,o=r.anchor_point.y,s=qy(e,t.x),c=qy(e,t.y),l=n.shape;switch(l.$tag){case 3:Lv(e,r.element_id,e=>({...e,shape:new gt(s,c)}));return;case 1:{let t=s-a,n=c-o,i=Math.sqrt(t*t+n*n),l=i<5?5:i;Lv(e,r.element_id,e=>({...e,x:a,y:o,shape:new mt(l)}));return}case 2:{let t=Math.abs(s-a),n=Math.abs(c-o),i=t<5?5:t,l=n<5?5:n;Lv(e,r.element_id,e=>({...e,x:a,y:o,shape:new ht(i,l)}));return}case 0:{let t=l,n=t._2,i=t._3,u=a<s?a:s,d=o<c?o:c,f=Math.abs(s-a),p=Math.abs(c-o),m=f<10?10:f,h=p<10?10:p;Lv(e,r.element_id,e=>({...e,x:u,y:d,shape:new pt(m,h,n,i)}));return}case 6:{let t=l,n=t._0,i=t._1;Lv(e,r.element_id,e=>({...e,x:s,y:c,shape:new yt(n,i)}));return}default:Lv(e,r.element_id,e=>({...e,x:s,y:c}));return}}}}function Yy(e){let t=gm(e.placement_state);if(t===void 0){T();return}else{let n=t,r=Q(e,n.element_id);if(r===void 0){T();return}else{let t=r,i=t.shape;if(i.$tag===3){let r=i,a=r._0,o=r._1,s=a-t.x,c=o-t.y;if(Math.sqrt(s*s+c*c)<5){Zv(e,n.element_id),fg(e.placement_state,void 0),zv(e,void 0);return}}if(n.is_line){let t={start:{element_id:n.anchor_element_id,anchor:n.anchor},end:void 0};Ay(e,n.element_id,t)}fg(e.placement_state,void 0);return}}}function Xy(e){return gm(e.placement_state)!==void 0}function Zy(e){let t=M_(W(e.elements)),n=vm(e.plain_svg_ids),r=n.length,i=0;for(;;){let e=i;if(e<r){let r=n[e];Ld(t.capabilities,r,Ci),i=e+1|0;continue}else break}dg(e.validation_result,t)}function Qy(e,t){if(gp(vm(e.plain_svg_ids),t))return Ci;let n=Om(e.validation_result);if(n===void 0)return Si;{let e=qd(n.capabilities,t);return e===void 0?Si:e}}function $y(e,t){let n=rp(vm(e.plain_svg_ids)),r=t.length,i=0;for(;;){let e=i;if(e<r){let r=t[e];gp(n,r)||su(n,r),i=e+1|0;continue}else break}ug(e.plain_svg_ids,n)}function eb(e){ug(e.plain_svg_ids,[])}function tb(e,t){return{x:e,y:t}}function nb(e,t){return{x:e.x+t.x,y:e.y+t.y}}function rb(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ib(e,t){return{x:e.x*t,y:e.y*t}}function ab(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function ob(e){let t=ab(e);return t<1e-10?Qi:ib(e,1/t)}function sb(e,t){return ab(rb(e,t))}function cb(e){return{x:-e.x,y:-e.y}}function lb(e,t){if(e.length===0)return[];let n=[F(e,0)],r=t*t,i=1;for(;;){let t=i;if(t<e.length){let a=F(e,t),o=rb(a,F(n,n.length-1|0));o.x*o.x+o.y*o.y>=r&&_u(n,a),i=t+1|0;continue}else break}if(n.length>1){let t=F(e,e.length-1|0),r=F(n,n.length-1|0);(t.x!==r.x||t.y!==r.y)&&_u(n,t)}return n}function ub(e,t,n){let r=rb(n,t),i=r.x*r.x+r.y*r.y;if(i<1e-10)return sb(e,t);let a=rb(e,t);return sb(e,nb(t,ib(r,(a.x*r.x+a.y*r.y)/i)))}function db(e,t,n,r){if((n-t|0)<=1)return[F(e,t),F(e,n)];let i=0,a=t,o=t+1|0;for(;;){let r=o;if(r<n){let s=ub(F(e,r),F(e,t),F(e,n));s>i&&(i=s,a=r),o=r+1|0;continue}else break}if(i>r){let i=db(e,t,a,r),o=db(e,a,n,r),s=[],c=0;for(;;){let e=c;if(e<(i.length-1|0)){_u(s,F(i,e)),c=e+1|0;continue}else break}let l=o.length,u=0;for(;;){let e=u;if(e<l){let t=o[e];_u(s,t),u=e+1|0;continue}else break}return s}else return[F(e,t),F(e,n)]}function fb(e,t){return e.length<=2?ap(e):db(e,0,e.length-1|0,t)}function pb(e,t){return(t+1|0)<e.length?ob(rb(F(e,t+1|0),F(e,t))):tb(1,0)}function mb(e,t){return t>0?ob(rb(F(e,t-1|0),F(e,t))):tb(-1,0)}function hb(e,t){let n=rb(t,e);return{p0:e,c1:nb(e,ib(n,.3333333333333333)),c2:nb(e,ib(n,.6666666666666666)),p3:t}}function gb(e,t,n){let r=(n-t|0)+1|0,i=Bf(r,0),a=1;for(;;){let n=a;if(n<r){let r=sb(F(e,t+n|0),F(e,(t+n|0)-1|0));Wf(i,n,Gc(i,n-1|0)+r),a=n+1|0;continue}else break}let o=Gc(i,r-1|0);if(o>1e-10){let e=1;for(;;){let t=e;if(t<r){Wf(i,t,Gc(i,t)/o),e=t+1|0;continue}else break}}return i}function _b(e,t){let n=1-t,r=n*n,i=r*n,a=t*t,o=a*t;return nb(nb(nb(ib(e.p0,i),ib(e.c1,3*r*t)),ib(e.c2,3*n*a)),ib(e.p3,o))}function vb(e,t,n,r,i){let a=0,o=(((n-t|0)+1|0)/2|0)+t|0,s=1;for(;;){let c=s;if(c<(n-t|0)){let n=sb(F(e,t+c|0),_b(r,Gc(i,c)));n>a&&(a=n,o=t+c|0),s=c+1|0;continue}else break}return{_0:a,_1:o}}function yb(e,t,n,r,i,a){let o=(n-t|0)+1|0,s=F(e,t),c=F(e,n),l=0,u=0,d=0,f=0,p=0,m=0;for(;;){let n=m;if(n<o){let o=Gc(r,n),h=o*o,g=h*o,_=1-o,v=_*_,y=v*_,b=3*v*o,te=3*_*h,ne=ib(i,b),re=ib(a,te);l+=ne.x*ne.x+ne.y*ne.y,u+=ne.x*re.x+ne.y*re.y,d+=re.x*re.x+re.y*re.y;let ie=rb(rb(F(e,t+n|0),ib(s,y+b)),ib(c,te+g));f+=ne.x*ie.x+ne.y*ie.y,p+=re.x*ie.x+re.y*ie.y,m=n+1|0;continue}else break}let h=l*d-u*u,g,_;_L:if(Math.abs(h)<1e-10){let e=sb(s,c),t=e/3,n=e/3;g=t,_=n;break _L}else{let e=(d*f-u*p)/h,t=(l*p-u*f)/h,n=sb(s,c),r=1e-6*n;if(e<r||t<r){let e=n/3,t=n/3;g=e,_=t;break _L}else{g=e,_=t;break _L}}return{p0:s,c1:nb(s,ib(i,g)),c2:nb(c,ib(a,_)),p3:c}}function bb(e,t,n){if(n===1){let n=1-t,r=n*n,i=t*t,a=ib(rb(e.c1,e.p0),3*r),o=ib(rb(e.c2,e.c1),6*n*t),s=ib(rb(e.p3,e.c2),3*i);return nb(nb(a,o),s)}else{let n=1-t;return nb(ib(nb(rb(e.c2,ib(e.c1,2)),e.p0),6*n),ib(nb(rb(e.p3,ib(e.c2,2)),e.c1),6*t))}}function xb(e,t,n){let r=rb(_b(e,n),t),i=bb(e,n,1),a=bb(e,n,2),o=r.x*i.x+r.y*i.y,s=i.x*i.x+i.y*i.y+(r.x*a.x+r.y*a.y);if(Math.abs(s)<1e-10)return n;let c=n-o/s;return c<0?0:c>1?1:c}function Sb(e,t,n,r,i){let a=(n-t|0)+1|0,o=op(r),s=0;for(;;){let n=s;if(n<a){Wf(o,n,xb(i,F(e,t+n|0),Gc(r,n))),s=n+1|0;continue}else break}return o}function Cb(e,t){return ob(nb(t>0?rb(F(e,t),F(e,t-1|0)):Qi,(t+1|0)<e.length?rb(F(e,t+1|0),F(e,t)):Qi))}function wb(e,t,n,r,i,a){if(((n-t|0)+1|0)==2)return[hb(F(e,t),F(e,n))];let o=gb(e,t,n),s=yb(e,t,n,o,r,i),c=vb(e,t,n,s,o),l=c._0,u=c._1;if(l<a)return[s];if(l<a*4){let c=Sb(e,t,n,o,s),u=yb(e,t,n,c,r,i),d=vb(e,t,n,u,c),f=d._0,p=d._1;if(f<a)return[u];if(f<l)return Tb(e,t,n,p,r,i,a)}return Tb(e,t,n,u,r,i,a)}function Tb(e,t,n,r,i,a,o){let s=Cb(e,r),c=wb(e,t,r,i,cb(s),o),l=wb(e,r,n,s,a,o),u=[],d=c.length,f=0;for(;;){let e=f;if(e<d){let t=c[e];Su(u,t),f=e+1|0;continue}else break}let p=l.length,m=0;for(;;){let e=m;if(e<p){let t=l[e];Su(u,t),m=e+1|0;continue}else break}return u}function Eb(e,t){if(e.length<2)return[];if(e.length===2)return[hb(F(e,0),F(e,1))];let n=pb(e,0),r=mb(e,e.length-1|0);return wb(e,0,e.length-1|0,n,r,t)}function Db(e){if(e.length===0)return``;let t=[],n=Bc(e,0);su(t,`M ${vl(Rf(n.p0.x))} ${vl(Rf(n.p0.y))}`);let r=e.length,i=0;for(;;){let n=i;if(n<r){let r=e[n];su(t,`C ${vl(Rf(r.c1.x))} ${vl(Rf(r.c1.y))} ${vl(Rf(r.c2.x))} ${vl(Rf(r.c2.y))} ${vl(Rf(r.p3.x))} ${vl(Rf(r.p3.y))}`),i=n+1|0;continue}else break}return _p(t,{str:` `,start:0,end:1})}function Ob(e,t){if(e.length<2)return``;let n=lb(e,t.min_resample_dist);if(n.length<2)return``;let r=fb(n,t.epsilon);return r.length<2?``:Db(Eb(r,t.max_error))}function kb(e,t,n){let r=wm(e.free_draw_state);if(r!==void 0){let i=r,a={x:t,y:n};uu(i.points,a),cg(e.free_draw_state,i);return}}function Ab(e,t){if(t.length<2){tr(e);return}let n=Array(t.length),r=t.length,i=0;for(;;){let e=i;if(e<r){let r=t[e];n[e]=`${L(r.x)},${L(r.y)}`,i=e+1|0;continue}else break}er(e,_p(n,{str:` `,start:0,end:1}))}function jb(e,t){let n=wm(e.free_draw_state);if(n!==void 0){let r=n.points;if(cg(e.free_draw_state,void 0),r.length<2)return;let i=Array(r.length),a=r.length,o=0;for(;;){let e=o;if(e<a){let t=r[e];i[e]=tb(t.x,t.y),o=e+1|0;continue}else break}let s=i,c=Em(e.free_draw_options),l=Ob(s,{min_resample_dist:c.resample_dist,epsilon:c.epsilon,max_error:c.max_error});if(l===``)return;let u=Ic(r,0),d=Ic(r,r.length-1|0),f=t(),p={id:f,x:u.x,y:u.y,shape:new vt(l,u.x,u.y,d.x,d.y),style:F_(),transform:void 0,parent_id:void 0,connections:void 0},m=W(e.elements);ou(m,p),ag(e.elements,m),og(e.tool_mode,0),ug(e.selected_ids,[f]);return}}function Mb(e){let t=wm(e.free_draw_state);return t===void 0?[]:t.points}function Nb(e){return wm(e.free_draw_state)!==void 0}function Pb(e,t,n){let r={x:t,y:n};cg(e.free_draw_state,{points:[r]})}function Fb(e){if(lm(e.tool_mode)===0){og(e.tool_mode,1);return}else{og(e.tool_mode,0);return}}function Ib(e,t){return au(e,{str:`var(`,start:0,end:4})||e===`transparent`||e===``?t:e}function Lb(e){let t=Cv(e),n=`display: flex; align-items: center; gap: 4px; margin-bottom: 12px; border-bottom: 1px solid ${t.ui_border}; padding-bottom: 8px; font-size: 12px;`,r=`color: ${t.ui_accent}; cursor: pointer; background: none; border: none; padding: 0; font-size: 12px;`,i=`color: ${t.ui_text}; font-weight: bold;`;return r_(()=>vm(e.selected_ids).length>0,()=>K(void 0,void 0,n,void 0,void 0,k,void 0,j,M,[g_(-1,void 0,void 0,r,void 0,void 0,void 0,new A(O(G(),t=>{zv(e,void 0)})),void 0,j,M,[J(`Canvas`)]),q(void 0,void 0,`color: #999;`,void 0,void 0,k,void 0,j,M,[J(` > `)]),r_(()=>vm(e.selected_ids).length===1,()=>q(void 0,void 0,i,void 0,void 0,k,void 0,j,M,[v_(()=>{let t=Wv(e);if(t===void 0)return`Unknown`;{let n=Q(e,t);if(n===void 0)return`Unknown`;{let e=n;return`${$_(e.shape)} #${e.id}`}}})])),r_(()=>vm(e.selected_ids).length>1,()=>q(void 0,void 0,i,void 0,void 0,k,void 0,j,M,[v_(()=>`${vl(vm(e.selected_ids).length)} selected`)]))]))}function Rb(e){let t=rr(e);return D(t)?w:new ct(t)}function zb(e){let t=[Oi,ki,Ai,ji,Mi,Ni,Pi,Fi],n=[],r=t.length,i=0;for(;;){let a=i;if(a<r){let r=t[a],o=r.name,s=r.light,c=r.dark;B(n,K(void 0,void 0,`display: flex; flex-direction: column; align-items: center; gap: 2px;`,void 0,void 0,k,void 0,j,M,[K(void 0,void 0,void 0,void 0,()=>{let t=bm(e.theme_mode),n;return n=t===0?s:c,`width: 24px; height: 24px; border-radius: 4px; border: 2px solid #ccc; cursor: pointer; background: ${n};`},new A(O(G(),t=>{let n=bm(e.theme_mode),r;r=n===0?s:c;let i=Wv(e);i!==void 0&&Lv(e,i,e=>({...e,style:{...e.style,stroke:r}}))})),void 0,j,M,[]),q(void 0,void 0,`font-size: 9px; color: #999;`,void 0,void 0,k,void 0,j,M,[J(o)])])),i=a+1|0;continue}else break}return K(void 0,void 0,`display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px;`,void 0,void 0,k,void 0,j,M,[t_(n)])}function Bb(e){return K(void 0,void 0,`padding: 8px; background: #fff; border: 1px solid #eee; border-radius: 4px;`,void 0,void 0,k,void 0,j,M,[K(void 0,void 0,`margin-bottom: 12px;`,void 0,void 0,k,void 0,j,M,[q(void 0,void 0,`${ta} display: block; margin-bottom: 6px;`,void 0,void 0,k,void 0,j,M,[J(`Document Size`)]),K(void 0,void 0,`display: flex; gap: 8px; align-items: center;`,void 0,void 0,k,void 0,j,M,[q(void 0,void 0,`font-size: 10px; color: #999;`,void 0,void 0,k,void 0,j,M,[J(`W:`)]),__(`number`,void 0,void 0,void 0,-1,-1,-1,-1,void 0,void 0,na,void 0,void 0,()=>Cl(Rf(ym(e.doc_width)),10),void 0,void 0,new A(qn(G(),t=>{let n=Rb(nr(t));if(n.$tag===1){let t=n._0;if(t>0){ng(e.doc_width,t);return}else return}else return})),void 0,j,M),q(void 0,void 0,`font-size: 10px; color: #999;`,void 0,void 0,k,void 0,j,M,[J(`H:`)]),__(`number`,void 0,void 0,void 0,-1,-1,-1,-1,void 0,void 0,na,void 0,void 0,()=>Cl(Rf(ym(e.doc_height)),10),void 0,void 0,new A(qn(G(),t=>{let n=Rb(nr(t));if(n.$tag===1){let t=n._0;if(t>0){ng(e.doc_height,t);return}else return}else return})),void 0,j,M)]),g_(-1,void 0,void 0,`margin-top: 6px; width: 100%; padding: 4px; border: 1px solid #ccc; border-radius: 3px; cursor: pointer; font-size: 10px; background: #f8f8f8;`,void 0,void 0,void 0,new A(O(G(),t=>{gy(e)})),void 0,j,M,[J(`Fit to Canvas`)])]),K(void 0,void 0,`margin-bottom: 12px; border-top: 1px solid #eee; padding-top: 8px;`,void 0,void 0,k,void 0,j,M,[q(void 0,void 0,`${ta} display: block; margin-bottom: 6px;`,void 0,void 0,k,void 0,j,M,[J(`Theme`)]),K(void 0,void 0,`display: flex; gap: 4px;`,void 0,void 0,k,void 0,j,M,[g_(-1,void 0,void 0,void 0,void 0,()=>S_(bm(e.theme_mode),0)?`${ra} background: #000; color: #fff; border-color: #000;`:`${ra} background: #fff; color: #333;`,void 0,new A(O(G(),t=>{ig(e.theme_mode,0);let n=Ei;Cg(e.preview_bg,n.background)})),void 0,j,M,[J(`Light`)]),g_(-1,void 0,void 0,void 0,void 0,()=>S_(bm(e.theme_mode),1)?`${ra} background: #000; color: #fff; border-color: #000;`:`${ra} background: #fff; color: #333;`,void 0,new A(O(G(),t=>{ig(e.theme_mode,1);let n=Di;Cg(e.preview_bg,n.background)})),void 0,j,M,[J(`Dark`)])])]),K(void 0,void 0,`margin-bottom: 12px; border-top: 1px solid #eee; padding-top: 8px;`,void 0,void 0,k,void 0,j,M,[q(void 0,void 0,`${ta} display: block; margin-bottom: 6px;`,void 0,void 0,k,void 0,j,M,[J(`Preset Colors`)]),zb(e)]),K(void 0,void 0,`display: flex; align-items: center; justify-content: space-between; padding: 4px 8px; font-size: 11px; border-top: 1px solid #eee; padding-top: 8px;`,void 0,void 0,k,void 0,j,M,[q(void 0,void 0,ta,void 0,void 0,k,void 0,j,M,[J(`Embed BG`)]),__(`text`,void 0,void 0,`transparent`,-1,-1,-1,-1,void 0,void 0,`width: 70px; padding: 2px 4px; border: 1px solid #ccc; border-radius: 3px; font-size: 10px;`,void 0,void 0,()=>{let t=km(e.embed_bg);return t===`transparent`?``:t},void 0,void 0,new A(Kn(G(),t=>{let n=nr(t);if(n===``){Cg(e.embed_bg,`transparent`);return}else{Cg(e.embed_bg,n);return}})),void 0,j,M)])])}function Vb(e){let t=W(e.elements),n=[],r=t.length,i=0;for(;;){let e=i;if(e<r){let r=t[e];r.parent_id===void 0&&ou(n,r),i=e+1|0;continue}else break}let a=n,o=[],s=a.length,c=0;for(;;){let t=c;if(t<s){let n=a[t],r=n.shape,i;switch(r.$tag){case 0:i=`▢`;break;case 1:i=`○`;break;case 2:i=`⬭`;break;case 3:i=`╱`;break;case 4:i=`⟋`;break;case 5:i=`✎`;break;default:i=`T`}let s=n.id,l=$_(n.shape);B(o,K(void 0,void 0,`display: flex; align-items: center; gap: 4px; padding: 4px 8px; cursor: pointer; border-radius: 3px; font-size: 11px;`,void 0,void 0,new A(O(G(),t=>{zv(e,s)})),void 0,j,M,[q(void 0,void 0,`font-size: 14px; width: 16px;`,void 0,void 0,k,void 0,j,M,[J(i)]),q(void 0,void 0,`color: #666;`,void 0,void 0,k,void 0,j,M,[J(l)]),q(void 0,void 0,`color: #999; font-family: monospace;`,void 0,void 0,k,void 0,j,M,[J(`#${s}`)])])),c=t+1|0;continue}else break}return o.length===0?K(void 0,void 0,`padding: 8px; color: #999; font-size: 11px; text-align: center;`,void 0,void 0,k,void 0,j,M,[J(`No elements`)]):K(void 0,void 0,`max-height: 300px; overflow-y: auto; padding: 4px;`,void 0,void 0,k,void 0,j,M,[t_(o)])}function Hb(e){let t=fh(!1),n=fh(!0);return K(void 0,void 0,`display: flex; flex-direction: column; gap: 4px;`,void 0,void 0,k,void 0,j,M,[K(void 0,void 0,``,void 0,void 0,k,void 0,j,M,[K(void 0,void 0,ea,void 0,void 0,new A(O(G(),e=>{Og(t,e=>!e)})),void 0,j,M,[J(`Canvas Settings`),v_(()=>um(t)?`▼`:`▶`)]),r_(()=>um(t),()=>Bb(e))]),K(void 0,void 0,``,void 0,void 0,k,void 0,j,M,[K(void 0,void 0,ea,void 0,void 0,new A(O(G(),e=>{Og(n,e=>!e)})),void 0,j,M,[v_(()=>{let t=W(e.elements),n=[],r=t.length,i=0;for(;;){let e=i;if(e<r){let r=t[e];r.parent_id===void 0&&ou(n,r),i=e+1|0;continue}else break}let a=n.length;return`Elements (${vl(a)})`}),v_(()=>um(n)?`▼`:`▶`)]),r_(()=>um(n),()=>Vb(e))])])}function Ub(e,t,n,r,i){return Xg(`button`,[{_0:`style`,_1:new st(()=>{let t=Q(e,n),a;if(t===void 0)a=r?`transparent`:`#000000`;else{let e=t;if(r){let t=e.style.fill;a=t===void 0?`transparent`:t}else{let t=e.style.stroke;a=t===void 0?`#000000`:t}}return`width: 22px; height: 22px; padding: 0; border: ${a===i||i===`transparent`&&a===`transparent`?`2px solid #0066ff`:`1px solid #ccc`}; border-radius: 3px; cursor: pointer; background: ${i===`transparent`?`linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(-45deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(-45deg, transparent 75%, #ccc 75%); background-size: 6px 6px; background-position: 0 0, 0 3px, 3px -3px, -3px 0px`:i};`})},{_0:`title`,_1:new S(i)},{_0:`click`,_1:new C(a=>{let o=Q(e,n);if(o!==void 0){let a=o.style,s=i===`transparent`?void 0:i;$(t,e,new lr(n,a,r?{...a,fill:s}:{...a,stroke:s}));return}})}],[])}function Wb(e,t,n,r,i){let a=[`#000000`,`#ffffff`,`#ff0000`,`#00ff00`,`#0000ff`,`#ffff00`],o=r?Ub(e,t,n,r,`transparent`):t_([]),s=Array(a.length),c=a.length,l=0;for(;;){let i=l;if(i<c){let o=a[i];s[i]=Ub(e,t,n,r,o),l=i+1|0;continue}else break}return K(void 0,void 0,`display: flex; align-items: center; gap: 3px;`,void 0,void 0,k,void 0,j,M,[o,t_(s),__(`color`,void 0,void 0,void 0,-1,-1,-1,-1,void 0,void 0,`width: 22px; height: 22px; padding: 0; border: 1px solid #ccc; border-radius: 3px; cursor: pointer;`,void 0,void 0,()=>{let t=Q(e,n);if(t===void 0)return r?`#ffffff`:`#000000`;{let e=t,n;if(r){let t=e.style.fill;n=t===void 0?`transparent`:t}else{let t=e.style.stroke;n=t===void 0?`#000000`:t}return Ib(n,r?`#ffffff`:`#000000`)}},void 0,void 0,new A(Kn(G(),i=>{let a=Q(e,n);if(a!==void 0){let o=a,s=nr(i),c=o.style;$(t,e,new lr(n,c,r?{...c,fill:s}:{...c,stroke:s}));return}})),void 0,j,M)])}function Gb(e,t,n){let r=[],i=sa.length,a=0;for(;;){let o=a;if(o<i){let i=sa[o],s=i._0,c=i._1;B(r,g_(-1,void 0,void 0,ca,void 0,()=>{let t=Q(e,n);if(t===void 0)return`${ca} background: #fff;`;{let e=t.style.stroke_dasharray,n;return n=e===void 0?c===void 0:c===void 0?!1:e===c,n?`${ca} background: #e0e0ff; border-color: #6666ff;`:`${ca} background: #fff;`}},void 0,new A(O(G(),r=>{let i=Q(e,n);if(i!==void 0){let r=i.style;$(t,e,new lr(n,r,{...r,stroke_dasharray:c}));return}})),void 0,j,M,[J(s)])),a=o+1|0;continue}else break}return t_(r)}function Kb(e,t,n,r){return K(void 0,void 0,`margin-top: 6px; padding-top: 6px; border-top: 1px solid ${Cv(e).ui_border}; display: flex; align-items: center; gap: 6px; flex-wrap: wrap;`,void 0,void 0,k,void 0,j,M,[K(void 0,void 0,`display: flex; gap: 2px;`,void 0,void 0,k,void 0,j,M,[Gb(e,t,n)]),q(void 0,void 0,`color: #ccc;`,void 0,void 0,k,void 0,j,M,[J(`|`)]),K(void 0,void 0,`display: flex; gap: 4px; align-items: center;`,void 0,void 0,k,void 0,j,M,[g_(-1,void 0,void 0,ca,void 0,()=>{let t=Q(e,n),r;if(t===void 0)r=!1;else{let e=t.style.marker_start;r=e===void 0?!1:e===1}return r?`${ca} background: #e3f2fd; border-color: #2196f3;`:`${ca} background: white;`},void 0,new A(O(G(),r=>{let i=Q(e,n);if(i!==void 0){let r=i.style,a;_L:{_L$2:{let e=r.marker_start;if(e===void 0)break _L$2;if(e===1)a=void 0;else break _L$2;break _L}a=1}$(t,e,new lr(n,r,{...r,marker_start:a}));return}})),void 0,j,M,[J(`<`)]),g_(-1,void 0,void 0,ca,void 0,()=>{let t=Q(e,n),r;if(t===void 0)r=!1;else{let e=t.style.marker_end;r=e===void 0?!1:e===1}return r?`${ca} background: #e3f2fd; border-color: #2196f3;`:`${ca} background: white;`},void 0,new A(O(G(),r=>{let i=Q(e,n);if(i!==void 0){let r=i.style,a;_L:{_L$2:{let e=r.marker_end;if(e===void 0)break _L$2;if(e===1)a=void 0;else break _L$2;break _L}a=1}$(t,e,new lr(n,r,{...r,marker_end:a}));return}})),void 0,j,M,[J(`>`)])])])}function qb(e){let t=Wv(e);if(t!==void 0){let n=t,r=Q(e,n);if(r===void 0)return;{if(r.shape.$tag===6)return n;let t=Pv(e,n),i=t.length,a=0;for(;;){let e=a;if(e<i){let n=t[e];if(n.shape.$tag===6)return n.id;a=e+1|0;continue}else break}return}}}function Jb(e,t,n){let r=[],i=la.length,a=0;for(;;){let n=a;if(n<i){let i=la[n],o=i._0,s=i._1;B(r,g_(-1,void 0,void 0,ca,void 0,()=>{let t=qb(e),n;if(t===void 0)n=!1;else{let r=Q(e,t);n=r===void 0?!1:nd(r.style.font_family,s)}return n?`${ca} background: #e3f2fd; border-color: #2196f3;`:`${ca} background: white;`},void 0,new A(O(G(),n=>{let r=qb(e);if(r!==void 0){let n=r,i=Q(e,n);if(i===void 0)return;{let r=i.style;$(t,e,new lr(n,r,{...r,font_family:s}));return}}})),void 0,j,M,[J(o)])),a=n+1|0;continue}else break}return t_(r)}function Yb(e,t,n,r){let i=Cv(e);return K(void 0,void 0,`margin-top: 6px; padding-top: 6px; border-top: 1px solid ${i.ui_border}; display: flex; align-items: center; gap: 6px;`,void 0,void 0,k,void 0,j,M,[q(void 0,void 0,`font-size: 11px; color: ${i.ui_text_muted};`,void 0,void 0,k,void 0,j,M,[J(`Font`)]),K(void 0,void 0,`display: flex; gap: 2px;`,void 0,void 0,k,void 0,j,M,[Jb(e,t,n)])])}function Xb(e,t,n,r){let i=`font-size: 11px; color: ${Cv(e).ui_text_muted}; min-width: 40px;`;return t_([r_(()=>{let t=Q(e,n);return t===void 0?!1:L_(t.shape).has_stroke},()=>K(void 0,void 0,ua,void 0,void 0,k,void 0,j,M,[K(void 0,void 0,`display: flex; align-items: center; gap: 8px;`,void 0,void 0,k,void 0,j,M,[q(void 0,void 0,i,void 0,void 0,k,void 0,j,M,[J(`Stroke`)]),Wb(e,t,n,!1,r)])])),r_(()=>{let t=Q(e,n);return t===void 0?!1:L_(t.shape).has_fill},()=>K(void 0,void 0,ua,void 0,void 0,k,void 0,j,M,[K(void 0,void 0,`display: flex; align-items: center; gap: 8px;`,void 0,void 0,k,void 0,j,M,[q(void 0,void 0,i,void 0,void 0,k,void 0,j,M,[J(`Fill`)]),Wb(e,t,n,!0,r)])])),r_(()=>{let t=Q(e,n);return t===void 0?!1:L_(t.shape).has_font?!0:cf(td(Pv(e,n)),e=>e.shape.$tag===6)},()=>Yb(e,t,n,r)),r_(()=>{let t=Q(e,n);if(t===void 0)return!1;{let e=L_(t.shape);return e.has_dasharray||e.has_arrows}},()=>Kb(e,t,n,r))])}function Zb(){}function Qb(e,t){let n=fh(!1);return K(void 0,void 0,`font-size: 12px;`,void 0,void 0,k,void 0,j,M,[K(void 0,void 0,`display: flex; align-items: center; gap: 6px; margin-bottom: 6px;`,void 0,void 0,k,void 0,j,M,[q(void 0,void 0,`font-size: 12px; color: #333; font-weight: 500;`,void 0,void 0,k,void 0,j,M,[v_(()=>{let t=Wv(e);if(t===void 0)return`-`;{let n=Q(e,t);return n===void 0?`-`:$_(n.shape)}})]),q(void 0,void 0,`font-size: 11px; color: #999;`,void 0,void 0,k,void 0,j,M,[J(`#`)]),__(`text`,void 0,void 0,void 0,-1,-1,-1,-1,void 0,void 0,ia,void 0,()=>um(n)?`${ia} border-color: #e53e3e; background: #fff5f5;`:ia,()=>{let t=Wv(e);return t===void 0?``:t},void 0,void 0,new A(qn(G(),r=>{let i=Wv(e);if(i!==void 0){let a=i,o=nr(r),s;if(s=o===``?!1:o!==a,s)if(Nv(e,o)){tg(n,!0);return}else{$(t,e,new ur(a,o)),tg(n,!1);return}else return}})),void 0,j,M)]),K(void 0,void 0,`display: grid; grid-template-columns: 1fr 1fr; gap: 4px; margin-bottom: 8px; padding: 6px; background: #f8f8f8; border-radius: 4px;`,void 0,void 0,k,void 0,j,M,[K(void 0,void 0,`display: flex; align-items: center; gap: 4px;`,void 0,void 0,k,void 0,j,M,[q(void 0,void 0,aa,void 0,void 0,k,void 0,j,M,[J(`x`)]),__(`number`,void 0,void 0,void 0,-1,-1,-1,-1,void 0,void 0,`${da} flex: 1;`,void 0,void 0,()=>{let t=Wv(e);if(t===void 0)return`0`;{let n=Q(e,t);return n===void 0?`0`:Cl(Rf(n.x),10)}},void 0,void 0,new A(Kn(G(),n=>{let r=Wv(e);if(r!==void 0){let i=r,a=Q(e,i);if(a===void 0)return;{let r=a,o=Rb(nr(n));if(o.$tag===1){let n=o._0;$(t,e,new or(i,r.x,r.y,n,r.y));return}else return}}})),void 0,j,M)]),K(void 0,void 0,`display: flex; align-items: center; gap: 4px;`,void 0,void 0,k,void 0,j,M,[q(void 0,void 0,aa,void 0,void 0,k,void 0,j,M,[J(`y`)]),__(`number`,void 0,void 0,void 0,-1,-1,-1,-1,void 0,void 0,`${da} flex: 1;`,void 0,void 0,()=>{let t=Wv(e);if(t===void 0)return`0`;{let n=Q(e,t);return n===void 0?`0`:Cl(Rf(n.y),10)}},void 0,void 0,new A(Kn(G(),n=>{let r=Wv(e);if(r!==void 0){let i=r,a=Q(e,i);if(a===void 0)return;{let r=a,o=Rb(nr(n));if(o.$tag===1){let n=o._0;$(t,e,new or(i,r.x,r.y,r.x,n));return}else return}}})),void 0,j,M)]),K(void 0,void 0,`display: flex; align-items: center; gap: 4px;`,void 0,void 0,k,void 0,j,M,[q(void 0,void 0,aa,void 0,void 0,k,void 0,j,M,[J(`w`)]),q(void 0,void 0,`${oa} flex: 1;`,void 0,void 0,k,void 0,j,M,[v_(()=>{let t=Wv(e);if(t===void 0)return`-`;{let n=Q(e,t);return n===void 0?`-`:Cl(Rf(H_(n).width),10)}})])]),K(void 0,void 0,`display: flex; align-items: center; gap: 4px;`,void 0,void 0,k,void 0,j,M,[q(void 0,void 0,aa,void 0,void 0,k,void 0,j,M,[J(`h`)]),q(void 0,void 0,`${oa} flex: 1;`,void 0,void 0,k,void 0,j,M,[v_(()=>{let t=Wv(e);if(t===void 0)return`-`;{let n=Q(e,t);return n===void 0?`-`:Cl(Rf(H_(n).height),10)}})])])]),r_(()=>Wv(e)!==void 0,()=>{let n=Wv(e),r;return r=n===void 0?T():n,t_([Xb(e,t,r,Zb),r_(()=>{let t=Q(e,r);return t===void 0?!1:L_(t.shape).has_stroke_width},()=>K(void 0,void 0,`display: flex; align-items: center; gap: 8px; margin-top: 8px;`,void 0,void 0,k,void 0,j,M,[q(void 0,void 0,`font-size: 11px; color: #666; min-width: 40px;`,void 0,void 0,k,void 0,j,M,[J(`Width`)]),__(`number`,void 0,void 0,void 0,-1,-1,-1,-1,void 0,void 0,`width: 50px; padding: 2px 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 10px;`,void 0,void 0,()=>{let t=Q(e,r);return t===void 0?`1`:Fp(id(t.style.stroke_width,1))},void 0,void 0,new A(qn(G(),n=>{let i=Q(e,r);if(i!==void 0){let a=i,o=Rb(nr(n));if(o.$tag===1){let n=o._0,i=a.style,s={...i,stroke_width:new ct(n)};$(t,e,new lr(r,i,s));return}else return}})),void 0,new Zn([ha,ga]),M),q(void 0,void 0,`font-size: 10px; color: #999;`,void 0,void 0,k,void 0,j,M,[J(`px`)])]))])})])}function $b(e){let t=Cv(e);return K(void 0,void 0,`font-size: 12px;`,void 0,void 0,k,void 0,j,M,[K(void 0,void 0,`display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;`,void 0,void 0,k,void 0,j,M,[q(void 0,void 0,`font-weight: 500; color: ${t.ui_text};`,void 0,void 0,k,void 0,j,M,[v_(()=>`${vl(vm(e.selected_ids).length)} elements selected`)]),g_(-1,void 0,void 0,`padding: 2px 6px; border: 1px solid #ccc; border-radius: 3px; cursor: pointer; font-size: 10px; background: #fff;`,void 0,void 0,void 0,new A(O(G(),t=>{zv(e,void 0)})),void 0,j,M,[J(`Clear`)])]),K(void 0,void 0,`max-height: 200px; overflow-y: auto; border: 1px solid ${t.ui_border}; border-radius: 4px; padding: 4px;`,void 0,void 0,k,void 0,j,M,[u_(()=>vm(e.selected_ids),(t,n)=>{let r=Q(e,t),i;if(r===void 0)i=`?`;else switch(r.shape.$tag){case 0:i=`▢`;break;case 1:i=`○`;break;case 2:i=`⬭`;break;case 3:i=`╱`;break;case 4:i=`⟋`;break;case 5:i=`✎`;break;default:i=`T`}let a;return a=r===void 0?`Unknown`:$_(r.shape),K(void 0,void 0,`display: flex; align-items: center; gap: 4px; padding: 4px 8px; cursor: pointer; border-radius: 3px; font-size: 11px;`,void 0,void 0,new A(O(G(),n=>{zv(e,t)})),void 0,j,M,[q(void 0,void 0,`font-size: 14px; width: 16px;`,void 0,void 0,k,void 0,j,M,[J(i)]),q(void 0,void 0,`color: #666;`,void 0,void 0,k,void 0,j,M,[J(a)]),q(void 0,void 0,`color: #999; font-family: monospace;`,void 0,void 0,k,void 0,j,M,[J(`#${t}`)]),g_(-1,void 0,void 0,`margin-left: auto; padding: 1px 4px; border: 1px solid #ccc; border-radius: 2px; cursor: pointer; font-size: 9px; background: #fff; color: #666;`,void 0,void 0,void 0,new A(O(G(),n=>{Sn(n,`stopPropagation`,[]),Hv(e,t)})),void 0,j,M,[J(`×`)])])})]),K(void 0,void 0,`margin-top: 8px; font-size: 10px; color: ${t.ui_text_muted};`,void 0,void 0,k,void 0,j,M,[J(`Tip: Shift+click to add/remove, Ctrl+C/V to copy/paste`)])])}function ex(e,t){return t_([Lb(e),r_(()=>vm(e.selected_ids).length===1,()=>Qb(e,t)),r_(()=>vm(e.selected_ids).length>1,()=>$b(e)),r_(()=>vm(e.selected_ids).length===0,()=>Hb(e))])}function tx(e,t){return K(void 0,void 0,void 0,void 0,()=>{let t=Cv(e);return`padding: 8px; background: ${t.ui_bg}; color: ${t.ui_text}; font-size: 12px;`},k,void 0,j,M,[ex(e,t)])}function nx(e,t,n,r){let i=`${$i} color: ${Cv(e).ui_text};`;return t_([K(void 0,void 0,fa,void 0,void 0,k,void 0,j,M,[g_(-1,void 0,void 0,i,void 0,void 0,void 0,new A(O(G(),i=>{let a=oy(e,n);if(a!==void 0){let e=a,r=e._0,i=e._1,o=new cr(n,r,i);cu(t.undo_stack,o),fp(t.redo_stack)}r()})),void 0,j,M,[J(`Bring to Front`)])]),K(void 0,void 0,fa,void 0,void 0,k,void 0,j,M,[g_(-1,void 0,void 0,i,void 0,void 0,void 0,new A(O(G(),i=>{let a=ay(e,n);if(a!==void 0){let e=a,r=e._0,i=e._1,o=new cr(n,r,i);cu(t.undo_stack,o),fp(t.redo_stack)}r()})),void 0,j,M,[J(`Bring Forward`)])]),K(void 0,void 0,fa,void 0,void 0,k,void 0,j,M,[g_(-1,void 0,void 0,i,void 0,void 0,void 0,new A(O(G(),i=>{let a=sy(e,n);if(a!==void 0){let e=a,r=e._0,i=e._1,o=new cr(n,r,i);cu(t.undo_stack,o),fp(t.redo_stack)}r()})),void 0,j,M,[J(`Send Backward`)])]),K(void 0,void 0,fa,void 0,void 0,k,void 0,j,M,[g_(-1,void 0,void 0,i,void 0,void 0,void 0,new A(O(G(),i=>{let a=cy(e,n);if(a!==void 0){let e=a,r=e._0,i=e._1,o=new cr(n,r,i);cu(t.undo_stack,o),fp(t.redo_stack)}r()})),void 0,j,M,[J(`Send to Back`)])])])}function rx(e,t,n,r){return g_(-1,void 0,void 0,`${$i} color: #e53e3e;`,void 0,void 0,void 0,new A(O(G(),i=>{let a=Q(e,n);a===void 0||$(t,e,new ar(a)),r()})),void 0,j,M,[J(`Delete`)])}function ix(e,t,n,r,i){let a=Cv(e),o=`padding: 4px 12px; border-bottom: 1px solid ${a.ui_border};`,s=`padding: 4px 12px; border-bottom: 1px solid ${a.ui_border}; color: ${a.ui_text_muted}; font-size: 12px;`,c=`${$i} color: ${a.ui_text};`;return t_([K(void 0,void 0,s,void 0,void 0,k,void 0,j,M,[J(`Insert`)]),K(void 0,void 0,o,void 0,void 0,k,void 0,j,M,[g_(-1,void 0,void 0,c,void 0,void 0,void 0,new A(O(G(),a=>{$(t,e,new ir(X(Y(n(),r,i,new pt(80,60,w,w)),wv(e)))),Xv(e)})),void 0,j,M,[J(`Rectangle`)])]),K(void 0,void 0,o,void 0,void 0,k,void 0,j,M,[g_(-1,void 0,void 0,c,void 0,void 0,void 0,new A(O(G(),a=>{$(t,e,new ir(X(Y(n(),r,i,_a),wv(e)))),Xv(e)})),void 0,j,M,[J(`Circle`)])]),K(void 0,void 0,o,void 0,void 0,k,void 0,j,M,[g_(-1,void 0,void 0,c,void 0,void 0,void 0,new A(O(G(),a=>{$(t,e,new ir(X(Y(n(),r,i,va),wv(e)))),Xv(e)})),void 0,j,M,[J(`Ellipse`)])]),K(void 0,void 0,o,void 0,void 0,k,void 0,j,M,[g_(-1,void 0,void 0,c,void 0,void 0,void 0,new A(O(G(),a=>{$(t,e,new ir(X(Y(n(),r,i,new gt(r+100,i+50)),Ev(e)))),Xv(e)})),void 0,j,M,[J(`Line`)])]),K(void 0,void 0,o,void 0,void 0,k,void 0,j,M,[g_(-1,void 0,void 0,c,void 0,void 0,void 0,new A(O(G(),a=>{$(t,e,new ir(X(Y(n(),r,i,new gt(r+100,i+50)),Dv(e)))),Xv(e)})),void 0,j,M,[J(`Arrow`)])]),K(void 0,void 0,`padding: 4px 12px;`,void 0,void 0,k,void 0,j,M,[g_(-1,void 0,void 0,c,void 0,void 0,void 0,new A(O(G(),a=>{$(t,e,new ir(X(Y(n(),r,i,ya),Tv(e)))),Xv(e)})),void 0,j,M,[J(`Text`)])])])}function ax(e,t,n){let r=cm(e.context_menu);if(r===void 0)return T();{let i=r,a=Cv(e),o=S_(bm(e.theme_mode),1)?`rgba(0,0,0,0.4)`:`rgba(0,0,0,0.1)`,s=`position: fixed; left: ${L(i.x)}px; top: ${L(i.y)}px; background: ${a.ui_bg}; border: 1px solid ${a.ui_border}; border-radius: 4px; box-shadow: 2px 2px 10px ${o}; min-width: 140px; z-index: 1000; color: ${a.ui_text};`,c=`padding: 4px 12px; border-bottom: 1px solid ${a.ui_border};`,l=`padding: 4px 12px; border-bottom: 1px solid ${a.ui_border}; color: ${a.ui_text_muted}; font-size: 11px;`,u=()=>{Xv(e)},d=i.target_id,f;if(d===void 0)f=ix(e,t,n,i.scene_x,i.scene_y);else{let n=d;f=t_([K(void 0,void 0,c,void 0,void 0,k,void 0,j,M,[Xb(e,t,n,u)]),K(void 0,void 0,l,void 0,void 0,k,void 0,j,M,[J(`Layer`)]),nx(e,t,n,u),K(void 0,void 0,`padding: 4px 12px;`,void 0,void 0,k,void 0,j,M,[rx(e,t,n,u)])])}return K(void 0,void 0,s,void 0,void 0,k,void 0,j,M,[f])}}function ox(e,t){let n=Tv(e),r=Dv(e),i={fill:`#e040e0`,stroke:`#c030c0`,stroke_width:ba,opacity:w,stroke_dasharray:void 0,marker_start:void 0,marker_end:void 0,font_family:void 0},a={fill:`transparent`,stroke:`#3355aa`,stroke_width:xa,opacity:w,stroke_dasharray:void 0,marker_start:void 0,marker_end:void 0,font_family:void 0},o={fill:`#ffee44`,stroke:bi,stroke_width:Sa,opacity:w,stroke_dasharray:void 0,marker_start:void 0,marker_end:void 0,font_family:void 0},s={fill:`transparent`,stroke:`#ddcc00`,stroke_width:Ca,opacity:w,stroke_dasharray:void 0,marker_start:void 0,marker_end:void 0,font_family:void 0},c={fill:`#8b7080`,stroke:`#6b5060`,stroke_width:wa,opacity:w,stroke_dasharray:void 0,marker_start:void 0,marker_end:void 0,font_family:void 0},l={fill:`transparent`,stroke:bi,stroke_width:Ta,opacity:w,stroke_dasharray:void 0,marker_start:void 0,marker_end:void 0,font_family:void 0},u=t(),d=X(Y(u,55,65,Ea),i),f=R_(X(Y(t(),55,65,Da),n),u),p=t(),m=X(Y(p,130,40,new pt(100,50,w,w)),a),h=R_(X(Y(t(),180,65,Oa),n),p),g=t(),_=X(Y(g,280,40,new pt(70,50,w,w)),o),v=R_(X(Y(t(),315,65,ka),n),g),y={...X(Y(t(),90,65,Aa),r),connections:{start:{element_id:u,anchor:4},end:{element_id:p,anchor:3}}},b={...X(Y(t(),230,65,ja),r),connections:{start:{element_id:p,anchor:4},end:{element_id:g,anchor:3}}},te=t(),ne=X(Y(te,55,200,Ma),s),re=R_(X(Y(t(),55,200,Na),n),te),ie=t(),ae=X(Y(ie,150,160,new pt(100,70,w,w)),c),oe=R_(X(Y(t(),200,195,Pa),n),ie),se=t(),ce=X(Y(se,300,165,new pt(70,60,w,w)),l),le=R_(X(Y(t(),335,195,Fa),n),se),x={...X(Y(t(),180,90,Ia),r),connections:{start:{element_id:p,anchor:2},end:{element_id:ie,anchor:1}}},ue={...X(Y(t(),105,200,La),r),connections:{start:{element_id:te,anchor:4},end:{element_id:ie,anchor:3}}},de={...X(Y(t(),250,195,Ra),r),connections:{start:{element_id:ie,anchor:4},end:{element_id:se,anchor:3}}};Qv(e,d),Qv(e,f),Qv(e,m),Qv(e,h),Qv(e,_),Qv(e,v),Qv(e,ne),Qv(e,re),Qv(e,ae),Qv(e,oe),Qv(e,ce),Qv(e,le),Qv(e,y),Qv(e,b),Qv(e,x),Qv(e,ue),Qv(e,de)}function sx(e,t,n){let r,i=[],a=t.length,o=0;for(;;){let e=o;if(e<a){let n=t[e];n._0===`class`?r=n._1:V(i,{_0:n._0,_1:new S(n._1)}),o=e+1|0;continue}else break}let s=n.length,c=0;for(;;){let e=c;if(e<s){let t=n[e];V(i,{_0:t._0,_1:new C(t._1)}),c=e+1|0;continue}else break}let l=Jg(Yg(di,e,i,[])),u=r;return u===void 0||N(l,`class`,u),l}function cx(e,t){let n=t.fill;n===void 0?z(e,za):z(e,{_0:`fill`,_1:n});let r=t.stroke;r===void 0||z(e,{_0:`stroke`,_1:r});let i=t.stroke_width;if(i.$tag===1){let t=i._0;z(e,{_0:`stroke-width`,_1:Z(t)})}let a=t.opacity;if(a.$tag===1){let t=a._0;z(e,{_0:`opacity`,_1:Z(t)})}let o=t.stroke_dasharray;o!==void 0&&z(e,{_0:`stroke-dasharray`,_1:o})}function lx(e,t,n){let r=t.marker_start;r===void 0||r===1&&z(e,Ba);let i=t.marker_end;if(i!==void 0)if(i===1){z(e,Va);return}else return}function ux(e,t){let n=sx(`marker`,[{_0:`id`,_1:e},Ha,Ua,{_0:`refX`,_1:t?`0`:`10`},Wa,Ga,Ka],[]);return mr(n,sx(`path`,[{_0:`d`,_1:t?`M10,0 L0,5 L10,10`:`M0,0 L10,5 L0,10`},qa],[])),n}function dx(){let e=sx(`defs`,[],[]),t=ux(`arrow-start-context`,!0),n=ux(`arrow-end-context`,!1);return mr(e,t),mr(e,n),e}function fx(e){let t=nv(e.anchor);return`${e.element_id}:${t}`}function px(){let e=Ec(0);return I(e,`  <defs>
`),I(e,`    <marker id="arrow-start" markerWidth="10" markerHeight="10" refX="0" refY="3" orient="auto-start-reverse">
`),I(e,`      <path d="M0,0 L0,6 L9,3 z" fill="currentColor"/>
`),I(e,`    </marker>
`),I(e,`    <marker id="arrow-end" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
`),I(e,`      <path d="M0,0 L0,6 L9,3 z" fill="currentColor"/>
`),I(e,`    </marker>
`),I(e,`  </defs>
`),e.val}function mx(e,t){let n=e.style,r=Ec(0);I(r,` data-id=\"${e.id}\"`);let i=e.parent_id;i===void 0||I(r,` data-parent-id=\"${i}\"`);let a=e.connections;if(a!==void 0){let e=a,t=e.start;t===void 0||I(r,` data-connection-start=\"${fx(t)}\"`);let n=e.end;n===void 0||I(r,` data-connection-end=\"${fx(n)}\"`)}let o=e.transform;o===void 0||I(r,` transform=\"${o}\"`);let s=e.shape,c;if(c=s.$tag===6,c)I(r,` fill=\"${B_(n,t)}\"`);else{let e=n.fill;e===void 0?I(r,` fill="none"`):I(r,` fill=\"${e}\"`)}let l=n.stroke;l===void 0||I(r,` stroke=\"${l}\"`);let u=n.stroke_width;if(u.$tag===1){let e=u._0;I(r,` stroke-width=\"${L(e)}\"`)}let d=n.opacity;if(d.$tag===1){let e=d._0;I(r,` opacity=\"${L(e)}\"`)}let f=n.stroke_dasharray;f===void 0||I(r,` stroke-dasharray=\"${f}\"`);let p=n.marker_start;p===void 0||p===1&&I(r,` marker-start="url(#arrow-start)"`);let m=n.marker_end;m===void 0||m===1&&I(r,` marker-end="url(#arrow-end)"`);let h=r.val,g=e.shape;switch(g.$tag){case 0:{let t=g,n=t._0,r=t._1,i=t._2,a=t._3,o;if(i.$tag===1){let e=i._0;o=` rx=\"${L(e)}\"`}else o=``;let s;if(a.$tag===1){let e=a._0;s=` ry=\"${L(e)}\"`}else s=``;return`<rect x=\"${L(e.x)}\" y=\"${L(e.y)}\" width=\"${L(n)}\" height=\"${L(r)}\"${o}${s}${h}/>`}case 1:{let t=g._0;return`<circle cx=\"${L(e.x)}\" cy=\"${L(e.y)}\" r=\"${L(t)}\"${h}/>`}case 2:{let t=g,n=t._0,r=t._1;return`<ellipse cx=\"${L(e.x)}\" cy=\"${L(e.y)}\" rx=\"${L(n)}\" ry=\"${L(r)}\"${h}/>`}case 3:{let t=g,n=t._0,r=t._1;return`<line x1=\"${L(e.x)}\" y1=\"${L(e.y)}\" x2=\"${L(n)}\" y2=\"${L(r)}\"${h}/>`}case 4:{let e=g._0,t=Array(e.length),n=e.length,r=0;for(;;){let i=r;if(i<n){let n=e[i];t[i]=`${L(n.x)},${L(n.y)}`,r=i+1|0;continue}else break}return`<polyline points=\"${_p(t,{str:` `,start:0,end:1})}\"${h}/>`}case 5:return`<path d=\"${g._0}\"${h}/>`;default:{let t=g,n=t._0,r=t._1,i=id(r,16),a=` font-size=\"${L(i)}\"`;if(Tu(n,{str:`
`,start:0,end:1})){let t=Nu(n,{str:`
`,start:0,end:1}),r=zu(e=>t(t=>e(Tl(t)))),o=i*1.2,s=-(((r.length-1|0)+0)*o)/2,c=[],l=r.length,u=0;for(;;){let t=u;if(t<l){let n=r[t],i=t===0?s:o,a=iv(n),l=e.x;su(c,`<tspan x=\"${L(l)}\" dy=\"${L(i)}\">${a}</tspan>`),u=t+1|0;continue}else break}let d=_p(c,{str:``,start:0,end:0});return`<text x=\"${L(e.x)}\" y=\"${L(e.y)}\"${a} text-anchor=\"middle\" dominant-baseline=\"middle\"${h}>${d}</text>`}else{let t=iv(n);return`<text x=\"${L(e.x)}\" y=\"${L(e.y)}\"${a} text-anchor=\"middle\" dominant-baseline=\"middle\"${h}>${t}</text>`}}}}function hx(e,t,n,r){let i=Ec(0);I(i,`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${vl(t)}\" height=\"${vl(n)}\" viewBox=\"0 0 ${vl(t)} ${vl(n)}\" data-moonlight=\"1.0\">\n`),I(i,px()),r!==`transparent`&&I(i,`  <rect width=\"100%\" height=\"100%\" fill=\"${r}\"/>\n`);let a=N_(e),o=a.length,s=0;for(;;){let t=s;if(t<o){let n=a[t],r=V_(e,n.parent_id);I(i,`  `),I(i,mx(n,r)),I(i,`
`),s=t+1|0;continue}else break}return I(i,`</svg>`),i.val}function gx(e){let t=[];if(e.shape.$tag===5)return t;let n=e.shape;if(n.$tag===3){let r=n,i=r._0,a=r._1,o=[{_0:`line-start`,_1:e.x,_2:e.y,_3:`move`},{_0:`line-end`,_1:i,_2:a,_3:`move`}],s=o.length,c=0;for(;;){let n=c;if(n<s){let r=o[n],i=r._0,a=r._1,s=r._2,l=r._3,u=sx(`g`,[Ja],[]),d=sx(`circle`,[{_0:`cx`,_1:Z(a)},{_0:`cy`,_1:Z(s)},{_0:`r`,_1:Z(12)},Ya,{_0:`cursor`,_1:l},{_0:`data-handle`,_1:i},{_0:`data-element-id`,_1:e.id}],[]),f=sx(`circle`,[{_0:`cx`,_1:Z(a)},{_0:`cy`,_1:Z(s)},{_0:`r`,_1:Z(5)},Xa,Za,Qa,$a,eo,to],[]);pr(d,`mouseenter`,e=>{N(f,`r`,Z(10)),N(f,`fill`,`#0088ff`)}),pr(d,`mouseleave`,e=>{N(f,`r`,Z(5)),N(f,`fill`,`#0066ff`)}),mr(u,d),mr(u,f),gu(t,u),c=n+1|0;continue}else break}}else{let n=H_(e),r=[{_0:`nw`,_1:n.x-4,_2:n.y-4,_3:`nwse-resize`},{_0:`ne`,_1:n.x+n.width-4,_2:n.y-4,_3:`nesw-resize`},{_0:`sw`,_1:n.x-4,_2:n.y+n.height-4,_3:`nesw-resize`},{_0:`se`,_1:n.x+n.width-4,_2:n.y+n.height-4,_3:`nwse-resize`}],i=r.length,a=0;for(;;){let n=a;if(n<i){let i=r[n],o=i._0,s=i._1,c=i._2,l=i._3;gu(t,sx(`rect`,[{_0:`data-handle`,_1:o},{_0:`data-element-id`,_1:e.id},{_0:`x`,_1:Z(s)},{_0:`y`,_1:Z(c)},{_0:`width`,_1:Z(8)},{_0:`height`,_1:Z(8)},no,ro,io,{_0:`cursor`,_1:l}],[])),a=n+1|0;continue}else break}}return t}function _x(e,t){let n=[],r=e.length,i=0;for(;;){let a=i;if(a<r){_L:{let r=e[a];if(r.shape.$tag===3){let e=r.connections;if(e===void 0)break _L;{let r=e,i=r.start;if(i!==void 0){let e=i;e.element_id===t.id&&uu(n,U_(t,e.anchor))}let a=r.end;if(a!==void 0){let e=a;e.element_id===t.id&&uu(n,U_(t,e.anchor))}}}else break _L;break _L}i=a+1|0;continue}else break}return n}function vx(e){let t=[];if(e.shape.$tag===3)return t;let n=W_(e),r=n.length,i=0;for(;;){let a=i;if(a<r){_L:{let r=n[a],i=r._0,o=r._1;if(y_(i,0)||y_(i,5)||y_(i,6)||y_(i,7)||y_(i,8))break _L;let s=nv(i);gu(t,sx(`circle`,[{_0:`cx`,_1:Z(o.x)},{_0:`cy`,_1:Z(o.y)},ao,oo,so,co,lo,uo,{_0:`data-anchor`,_1:s},{_0:`data-anchor-element`,_1:e.id}],[]));break _L}i=a+1|0;continue}else break}return t}function yx(e,t){let n=[],r=_x(e,t),i=r.length,a=0;for(;;){let e=a;if(e<i){let t=r[e];gu(n,sx(`circle`,[{_0:`cx`,_1:Z(t.x)},{_0:`cy`,_1:Z(t.y)},fo,po,mo,ho,go],[])),a=e+1|0;continue}else break}return n}function bx(e,t,n,r,i,a){let o=[],s=(r+0)/n.zoom,c=(i+0)/n.zoom,l=n.scroll_x-2e3,u=n.scroll_y-2e3,d=s+4e3,f=c+4e3,p=a?`#333333`:`#e0e0e0`,m=a?`#1a1a1a`:`#ffffff`;gu(o,sx(`rect`,[{_0:`x`,_1:Z(l)},{_0:`y`,_1:Z(u)},{_0:`width`,_1:Z(d)},{_0:`height`,_1:Z(f)},{_0:`fill`,_1:p},_o],[])),gu(o,sx(`rect`,[vo,yo,{_0:`width`,_1:Z(e)},{_0:`height`,_1:Z(t)},{_0:`fill`,_1:m},bo,xo],[]));let h=a?`#555555`:`#cccccc`;return gu(o,sx(`rect`,[So,Co,{_0:`width`,_1:Z(e)},{_0:`height`,_1:Z(t)},wo,{_0:`stroke`,_1:h},To,Eo],[])),o}function xx(e,t){let n=[],r=e.length,i=0;for(;;){let a=i;if(a<r){_L:{let r=e[a];if(r.id===t||r.shape.$tag===3||r.parent_id!==void 0)break _L;let i=W_(r),o=i.length,s=0;for(;;){let e=s;if(e<o){let t=i[e]._1;gu(n,sx(`circle`,[{_0:`cx`,_1:Z(t.x)},{_0:`cy`,_1:Z(t.y)},Do,Oo,ko,Ao,jo],[])),s=e+1|0;continue}else break}break _L}i=a+1|0;continue}else break}return n}function Sx(e,t,n,r){let i,a=[],o=t.length,s=0;for(;;){let e=s;if(e<o){let n=t[e];n._0===`class`?i=n._1:V(a,{_0:n._0,_1:new S(n._1)}),s=e+1|0;continue}else break}let c=n.length,l=0;for(;;){let e=l;if(e<c){let t=n[e];V(a,{_0:t._0,_1:new C(t._1)}),l=e+1|0;continue}else break}let u=Yg(di,e,a,r),d=i;if(d!==void 0){let e=d;N(Jg(u),`class`,e)}return u}function Cx(e,t,n){let r=[];z(r,{_0:`data-id`,_1:e.id});let i=e.style,a=e.shape;switch(a.$tag){case 0:{let t=a,n=t._0,o=t._1,s=t._2,c=t._3;if(z(r,{_0:`x`,_1:Z(e.x)}),z(r,{_0:`y`,_1:Z(e.y)}),z(r,{_0:`width`,_1:Z(n)}),z(r,{_0:`height`,_1:Z(o)}),s.$tag===1){let e=s._0;z(r,{_0:`rx`,_1:Z(e)})}if(c.$tag===1){let e=c._0;z(r,{_0:`ry`,_1:Z(e)})}cx(r,i);let l=e.transform;return l===void 0||z(r,{_0:`transform`,_1:l}),z(r,Mo),z(r,No),Sx(`rect`,r,[],[])}case 1:{let t=a._0;z(r,{_0:`cx`,_1:Z(e.x)}),z(r,{_0:`cy`,_1:Z(e.y)}),z(r,{_0:`r`,_1:Z(t)}),cx(r,i);let n=e.transform;return n===void 0||z(r,{_0:`transform`,_1:n}),z(r,Po),z(r,Fo),Sx(`circle`,r,[],[])}case 2:{let t=a,n=t._0,o=t._1;z(r,{_0:`cx`,_1:Z(e.x)}),z(r,{_0:`cy`,_1:Z(e.y)}),z(r,{_0:`rx`,_1:Z(n)}),z(r,{_0:`ry`,_1:Z(o)}),cx(r,i);let s=e.transform;return s===void 0||z(r,{_0:`transform`,_1:s}),z(r,Io),z(r,Lo),Sx(`ellipse`,r,[],[])}case 3:{let n=a,r=n._0,i=n._1,o=e.style.stroke,s;s=o===void 0?`#000000`:o;let c=[Sx(`line`,[{_0:`data-id`,_1:e.id},{_0:`x1`,_1:Z(e.x)},{_0:`y1`,_1:Z(e.y)},{_0:`x2`,_1:Z(r)},{_0:`y2`,_1:Z(i)},Ro,zo],[],[])];t&&B(c,Sx(`line`,[{_0:`x1`,_1:Z(e.x)},{_0:`y1`,_1:Z(e.y)},{_0:`x2`,_1:Z(r)},{_0:`y2`,_1:Z(i)},Bo,{_0:`stroke-width`,_1:Z(id(e.style.stroke_width,1)+6)},Vo,Ho],[],[]));let l=[{_0:`x1`,_1:Z(e.x)},{_0:`y1`,_1:Z(e.y)},{_0:`x2`,_1:Z(r)},{_0:`y2`,_1:Z(i)},Uo];cx(l,e.style),lx(l,e.style,s);let u=e.transform;return u===void 0||z(l,{_0:`transform`,_1:u}),B(c,Sx(`line`,l,[],[])),Sx(`g`,[{_0:`data-id`,_1:e.id},Wo,Go],[],c)}case 4:{let t=a._0,n=Array(t.length),o=t.length,s=0;for(;;){let e=s;if(e<o){let r=t[e];n[e]=`${L(r.x)},${L(r.y)}`,s=e+1|0;continue}else break}z(r,{_0:`points`,_1:_p(n,{str:` `,start:0,end:1})}),cx(r,i);let c=e.transform;return c===void 0||z(r,{_0:`transform`,_1:c}),z(r,Ko),Sx(`polyline`,r,[],[])}case 5:{let t=a._0;z(r,{_0:`d`,_1:t}),cx(r,i);let n=e.transform;return n===void 0||z(r,{_0:`transform`,_1:n}),z(r,qo),Sx(`path`,r,[],[])}default:{let t=a,o=t._0,s=t._1,c=id(s,16),l;if(n===void 0)l={_0:e.x,_1:e.y};else{let e=H_(n);l={_0:e.x+e.width/2,_1:e.y+e.height/2}}let u=l._0,d=l._1,f,p;_L:if(Tu(o,{str:`
`,start:0,end:1})){let e=Nu(o,{str:`
`,start:0,end:1}),t=zu(t=>e(e=>t(Tl(e)))),n=t.length,r=c*1.2,i=(n+0)*r,a,s=0,l=0;for(;;){let e=s,n=l;if(e<t.length){s=e+1|0;let r=lf(Du(Fc(t,e)));l=r>n?r:n;continue}else{a=n;break}}let u=(a+0)*c*.55,d=u<40?40:u,m=i<24?24:i;f=d,p=m;break _L}else{let e=(lf(Du(o))+0)*c*.55,t=e<40?40:e,n=c*1.2;f=t,p=n;break _L}let m=Sx(`rect`,[{_0:`data-id`,_1:e.id},{_0:`x`,_1:Z(u-f/2)},{_0:`y`,_1:Z(d-p/2)},{_0:`width`,_1:Z(f)},{_0:`height`,_1:Z(p)},Jo,Yo],[],[]);z(r,{_0:`x`,_1:Z(u)}),z(r,{_0:`y`,_1:Z(d)}),z(r,{_0:`font-size`,_1:Z(c)});let h=e.style.font_family;if(h===void 0||z(r,{_0:`font-family`,_1:h}),z(r,Xo),z(r,Zo),z(r,Qo),n===void 0)cx(r,i);else{let e=n.style.stroke;e===void 0?cx(r,i):z(r,{_0:`fill`,_1:e})}let g=e.transform;g===void 0||z(r,{_0:`transform`,_1:g});let _=[],v=r.length,y=0;for(;;){let e=y;if(e<v){let t=r[e];V(_,{_0:t._0,_1:new S(t._1)}),y=e+1|0;continue}else break}V(_,{_0:`__ref`,_1:new C(e=>{hr(e,o,u,c)})});let b=Yg(di,`text`,_,[]);return Sx(`g`,[{_0:`data-id`,_1:e.id},$o,es],[],[m,b])}}}function wx(e){let t=[],n=om(e.grid_size),r=sm(e.viewport),i=n+0,a=bm(e.theme_mode),o;o=a===1?`#333333`:`#e0e0e0`;let s=(om(e.canvas_width)+0)/r.zoom,c=(om(e.canvas_height)+0)/r.zoom,l=r.scroll_x,u=r.scroll_y,d=l+s,f=u+c,p=Np(l/i)*i,m=Np(u/i)*i,h=p;for(;h<=d;)B(t,Sx(`line`,[{_0:`x1`,_1:Fp(h)},{_0:`y1`,_1:Fp(u)},{_0:`x2`,_1:Fp(h)},{_0:`y2`,_1:Fp(f)},{_0:`stroke`,_1:o},ts],[],[])),h+=i;let g=m;for(;g<=f;)B(t,Sx(`line`,[{_0:`x1`,_1:Fp(l)},{_0:`y1`,_1:Fp(g)},{_0:`x2`,_1:Fp(d)},{_0:`y2`,_1:Fp(g)},{_0:`stroke`,_1:o},ns],[],[])),g+=i;return t_(t)}function Tx(e,t,n,r){let i=e.style.stroke,a;a=i===void 0?`#000000`:i;let o=[];B(o,Sx(`line`,[{_0:`data-id`,_1:e.id},{_0:`x1`,_1:Z(e.x)},{_0:`y1`,_1:Z(e.y)},{_0:`x2`,_1:Z(t)},{_0:`y2`,_1:Z(n)},rs,is],[],[]));let s=[{_0:`x1`,_1:Z(e.x)},{_0:`y1`,_1:Z(e.y)},{_0:`x2`,_1:Z(t)},{_0:`y2`,_1:Z(n)},as];return cx(s,e.style),lx(s,e.style,a),B(o,Sx(`line`,s,[],[])),Yg(di,`g`,[{_0:`data-id`,_1:new S(e.id)},os,ss,{_0:`__ref`,_1:new C(e=>{r.val=new _r(e)})}],o)}function Ex(e,t,n){let r=[];B(r,Sx(`path`,[{_0:`data-id`,_1:e.id},{_0:`d`,_1:t},cs,ls,us,ds,fs],[],[]));let i=[{_0:`d`,_1:t},ps];return cx(i,e.style),B(r,Sx(`path`,i,[],[])),Yg(di,`g`,[{_0:`data-id`,_1:new S(e.id)},ms,hs,{_0:`__ref`,_1:new C(e=>{n.val=new _r(e)})}],r)}function Dx(e,t,n){let r=[],i=t.length,a=0;for(;;){let e=a;if(e<i){let n=t[e];V(r,{_0:n._0,_1:new S(n._1)}),a=e+1|0;continue}else break}return V(r,{_0:`__ref`,_1:new C(e=>{n.val=new _r(e)})}),Yg(di,e,r,[])}function Ox(e,t,n,r,i){let a=id(n,16),o=e.x,s=e.y,c,l;_L:if(Tu(t,{str:`
`,start:0,end:1})){let e=Nu(t,{str:`
`,start:0,end:1}),n=zu(t=>e(e=>t(Tl(e)))),r=n.length,i=a*1.2,o=(r+0)*i,s,u=0,d=0;for(;;){let e=u,t=d;if(e<n.length){u=e+1|0;let r=lf(Du(Fc(n,e)));d=r>t?r:t;continue}else{s=t;break}}let f=(s+0)*a*.55,p=f<40?40:f,m=o<24?24:o;c=p,l=m;break _L}else{let e=(lf(Du(t))+0)*a*.55,n=e<40?40:e,r=a*1.2;c=n,l=r;break _L}let u=[];B(u,Sx(`rect`,[{_0:`data-id`,_1:e.id},{_0:`x`,_1:Z(o-c/2)},{_0:`y`,_1:Z(s-l/2)},{_0:`width`,_1:Z(c)},{_0:`height`,_1:Z(l)},gs,_s],[],[]));let d=B_(e.style,i),f=[{_0:`x`,_1:Z(o)},{_0:`y`,_1:Z(s)},{_0:`font-size`,_1:Z(a)},vs,ys,bs,{_0:`fill`,_1:d}],p=e.style.font_family;p===void 0||z(f,{_0:`font-family`,_1:p});let m=e.style.stroke;if(m!==void 0){z(f,{_0:`stroke`,_1:m});let t=e.style.stroke_width;if(t.$tag===1){let e=t._0;z(f,{_0:`stroke-width`,_1:Z(e)})}}let h=[],g=f.length,_=0;for(;;){let e=_;if(e<g){let t=f[e];V(h,{_0:t._0,_1:new S(t._1)}),_=e+1|0;continue}else break}return V(h,{_0:`__ref`,_1:new C(e=>{hr(e,t,o,a)})}),B(u,Yg(di,`text`,h,[])),Yg(di,`g`,[{_0:`data-id`,_1:new S(e.id)},xs,Ss,{_0:`__ref`,_1:new C(e=>{r.val=new _r(e)})}],u)}function kx(e,t,n){let r=[];z(r,{_0:`data-id`,_1:e.id});let i=e.shape;switch(i.$tag){case 0:{let n=i,a=n._0,o=n._1,s=n._2,c=n._3;if(z(r,{_0:`x`,_1:Z(e.x)}),z(r,{_0:`y`,_1:Z(e.y)}),z(r,{_0:`width`,_1:Z(a)}),z(r,{_0:`height`,_1:Z(o)}),s.$tag===1){let e=s._0;z(r,{_0:`rx`,_1:Z(e)})}if(c.$tag===1){let e=c._0;z(r,{_0:`ry`,_1:Z(e)})}return cx(r,e.style),z(r,Cs),z(r,ws),Dx(`rect`,r,t)}case 1:{let n=i._0;return z(r,{_0:`cx`,_1:Z(e.x)}),z(r,{_0:`cy`,_1:Z(e.y)}),z(r,{_0:`r`,_1:Z(n)}),cx(r,e.style),z(r,Ts),z(r,Es),Dx(`circle`,r,t)}case 2:{let n=i,a=n._0,o=n._1;return z(r,{_0:`cx`,_1:Z(e.x)}),z(r,{_0:`cy`,_1:Z(e.y)}),z(r,{_0:`rx`,_1:Z(a)}),z(r,{_0:`ry`,_1:Z(o)}),cx(r,e.style),z(r,Ds),z(r,Os),Dx(`ellipse`,r,t)}case 3:{let n=i,r=n._0,a=n._1;return Tx(e,r,a,t)}case 5:{let n=i._0;return Ex(e,n,t)}case 6:{let r=i,a=r._0,o=r._1;return Ox(e,a,o,t,n)}default:return Cx(e,!1,void 0)}}function Ax(e,t,n,r,i,a){let o=a.stroke,s;s=o===void 0?`#000000`:o;let c=id(a.stroke_width,1);vr(e,t,n,r,i,s,c)}function jx(e,t,n,r,i){let a=i.stroke,o;o=a===void 0?`#000000`:a;let s=id(i.stroke_width,1),c=i.fill,l;l=c===void 0?`none`:c,yr(e,t,n,r,o,s,l)}function Mx(e,t){let n=t.fill;n===void 0?N(e,`fill`,`none`):N(e,`fill`,n);let r=t.stroke;r===void 0||N(e,`stroke`,r);let i=t.stroke_width;if(i.$tag===1){let t=i._0;N(e,`stroke-width`,Z(t))}let a=t.opacity;if(a.$tag===1){let t=a._0;N(e,`opacity`,Z(t));return}else return}function Nx(e,t,n){let r=t.shape;switch(r.$tag){case 0:{let n=r,i=n._0,a=n._1;N(e,`x`,Z(t.x)),N(e,`y`,Z(t.y)),N(e,`width`,Z(i)),N(e,`height`,Z(a)),Mx(e,t.style);return}case 1:{let n=r._0;N(e,`cx`,Z(t.x)),N(e,`cy`,Z(t.y)),N(e,`r`,Z(n)),Mx(e,t.style);return}case 2:{let n=r,i=n._0,a=n._1;N(e,`cx`,Z(t.x)),N(e,`cy`,Z(t.y)),N(e,`rx`,Z(i)),N(e,`ry`,Z(a)),Mx(e,t.style);return}case 3:{let n=r,i=n._0,a=n._1;Ax(e,t.x,t.y,i,a,t.style);return}case 5:{let n=r,i=n._0,a=n._1,o=n._2;jx(e,i,t.x-a,t.y-o,t.style);return}case 6:{let i=r,a=i._0,o=i._1,s=id(o,16),c=B_(t.style,n),l=t.style.stroke,u;u=l===void 0?``:l;let d=id(t.style.stroke_width,0),f=t.style.font_family,p;p=f===void 0?``:f,br(e,t.x,t.y,a,s,c,u,d,p);return}default:return}}function Px(e,t,n){let r={val:gr},i=V_(W(e.elements),n.parent_id);return am(()=>{let n=W(e.elements),i=r.val;if(i.$tag===1){let e=i._0,r,a=n.length,o=0;for(;;){let e=o;if(e<a){let i=n[e];if(i.id===t){r=i;break}o=e+1|0;continue}else break}let s=r;if(s===void 0)return;{let t=s;Nx(e,t,V_(n,t.parent_id));return}}else return}),am(()=>{let n=dm(e.text_edit),i=r.val;if(i.$tag===1){let e=i._0,r;if(r=n===void 0?!1:nd(n.editing_id,t),r){N(e,`visibility`,`hidden`);return}else{N(e,`visibility`,`visible`);return}}else return}),kx(n,r,i)}function Fx(e,t){let n=Q(e,t);return n===void 0?t_([]):Px(e,t,n)}function Ix(e){let t={val:gr};return am(()=>{let n=W(e.elements),r=vm(e.selected_ids),i=t.val;if(i.$tag===1){let t=i._0;xr(t);let a=r.length,o=0;for(;;){let i=o;if(i<a){let a=r[i],s,c=n.length,l=0;for(;;){let e=l;if(e<c){let t=n[e];if(t.id===a){s=t;break}l=e+1|0;continue}else break}let u=s;if(u!==void 0){let i=u,a=yx(n,i),o=a.length,s=0;for(;;){let e=s;if(e<o){let n=a[e];mr(t,n),s=e+1|0;continue}else break}let c;if(r.length===1){let t=i.id;c=Qy(e,t).can_resize}else c=!1;if(c){let e=gx(i),n=e.length,r=0;for(;;){let i=r;if(i<n){let n=e[i];mr(t,n),r=i+1|0;continue}else break}}let l=vx(i),d=l.length,f=0;for(;;){let e=f;if(e<d){let n=l[e];mr(t,n),f=e+1|0;continue}else break}}o=i+1|0;continue}else return}}else return}),Yg(di,`g`,[{_0:`__ref`,_1:new C(e=>{t.val=new _r(e),N(e,`class`,`selection-overlay`)})}],[])}function Lx(e){let t={val:gr};am(()=>{let n=xm(e.box_select),r=t.val;if(r.$tag===1){let e=r._0;if(n===void 0)return;{let t=J_(n);N(e,`x`,Z(t.x)),N(e,`y`,Z(t.y)),N(e,`width`,Z(t.width)),N(e,`height`,Z(t.height));return}}else return});let n=xm(e.box_select),r;if(n===void 0)r=ks;else{let e=J_(n);r={_0:e.x,_1:e.y,_2:e.width,_3:e.height}}let i=r._0,a=r._1,o=r._2,s=r._3;return Yg(di,`rect`,[{_0:`x`,_1:new S(Z(i))},{_0:`y`,_1:new S(Z(a))},{_0:`width`,_1:new S(Z(o))},{_0:`height`,_1:new S(Z(s))},As,js,Ms,Ns,Ps,{_0:`__ref`,_1:new C(e=>{t.val=new _r(e)})}],[])}function Rx(e){let t={val:gr};return am(()=>{let n=W(e.elements),r=pm(e.resize_state),i=t.val;if(i.$tag===1){let e=i._0;if(r===void 0)return;{let t=r;xr(e);let i=n.length,a=0;for(;;){let r=a;if(r<i){_L:{let i=n[r];if(i.id===t.element_id||i.shape.$tag===3||i.parent_id!==void 0)break _L;let a=xx([i],t.element_id),o=a.length,s=0;for(;;){let t=s;if(t<o){let n=a[t];mr(e,n),s=t+1|0;continue}else break}break _L}a=r+1|0;continue}else return}}}else return}),Yg(di,`g`,[{_0:`__ref`,_1:new C(e=>{t.val=new _r(e),N(e,`class`,`all-anchors`)})}],[])}function zx(e){let t={val:gr};am(()=>{let n=Sm(e.pending_connection),r=t.val;if(r.$tag===1){let e=r._0;if(n===void 0)return;{let t=n;N(e,`cx`,Z(t.point.x)),N(e,`cy`,Z(t.point.y));return}}else return});let n=Sm(e.pending_connection),r;if(n===void 0)r=Fs;else{let e=n;r={_0:e.point.x,_1:e.point.y}}let i=r._0,a=r._1;return Yg(di,`circle`,[{_0:`cx`,_1:new S(Z(i))},{_0:`cy`,_1:new S(Z(a))},Is,Ls,Rs,zs,Bs,{_0:`__ref`,_1:new C(e=>{t.val=new _r(e)})}],[])}function Bx(e){let t={val:gr};return am(()=>{let n=sm(e.viewport),r=ym(e.doc_width),i=ym(e.doc_height),a=om(e.canvas_width),o=om(e.canvas_height),s=S_(bm(e.theme_mode),1),c=t.val;if(c.$tag===1){let e=c._0;xr(e);let t=bx(r,i,n,a,o,s),l=t.length,u=0;for(;;){let n=u;if(n<l){let r=t[n];mr(e,r),u=n+1|0;continue}else return}}else return}),Yg(di,`g`,[{_0:`__ref`,_1:new C(e=>{t.val=new _r(e),N(e,`class`,`canvas-background`)})}],[])}function Vx(e){return Sx(`filter`,[Vs,Hs,Us,Ws,Gs],[],[Sx(`feDropShadow`,[Ks,qs,Js,{_0:`flood-opacity`,_1:Z(e?.5:.15)}],[],[])])}function Hx(){return nh(0)}function Ux(e,t){let n=Tr(e,t);return Er(n)?n:void 0}function Wx(e){let t=wr(e,`width`,400),n=wr(e,`height`,300);return{width:t,height:n,doc_width:wr(e,`docWidth`,t),doc_height:wr(e,`docHeight`,n),zoom:Cr(e,`zoom`,1),theme:Dr(e,`theme`,`light`),is_readonly:Sr(e,`readonly`,!1),initial_svg:Ux(e,`initialSvg`)}}function Gx(e){let t=Nu(e,{str:`:`,start:0,end:1}),n=zu(e=>t(t=>e(Tl(t))));if(n.length!==2)return;let r=Fc(n,0),i=tv(Fc(n,1));if(i!==void 0)return{element_id:r,anchor:i}}function Kx(e){let t=Ar(e,`data-connection-start`),n=Ar(e,`data-connection-end`);if(D(t)&&D(n))return;let r;r=D(t)?void 0:Gx(t);let i;return i=D(n)?void 0:Gx(n),{start:r,end:i}}function qx(e,t,n){let r=Ar(e,t);if(D(r))return n;let i=Rb(r);return i.$tag===1?i._0:n}function Jx(e,t){let n=Ar(e,t);return D(n)?w:Rb(n)}function Yx(e){let t=[],n=Eu(e);for(;;){let e=kl(n);if(e===-1)break;{let n=e;_L:{_L$2:{switch(n){case 77:break _L$2;case 109:break _L$2;case 76:break _L$2;case 108:break _L$2;case 72:break _L$2;case 104:break _L$2;case 86:break _L$2;case 118:break _L$2;case 67:break _L$2;case 99:break _L$2;case 83:break _L$2;case 115:break _L$2;case 81:break _L$2;case 113:break _L$2;case 84:break _L$2;case 116:break _L$2;case 65:break _L$2;case 97:break _L$2;case 90:break _L$2;case 122:break _L$2}break _L}bu(t,n)}continue}}return t}function Xx(e){let t=[],n=[],r=!1,i=Eu(e);for(;;){let e=kl(i);if(e===-1)break;{let i=e;_L:{_L$2:{switch(i){case 48:break _L$2;case 49:break _L$2;case 50:break _L$2;case 51:break _L$2;case 52:break _L$2;case 53:break _L$2;case 54:break _L$2;case 55:break _L$2;case 56:break _L$2;case 57:break _L$2;case 46:break _L$2;case 45:break _L$2;default:if(r&&n.length>0){let e=Rb(ql({buf:n,start:0,end:n.length}));if(e.$tag===1){let n=e._0;xu(t,n)}hp(n)}r=!1}break _L}if(i===45&&r&&n.length>0){let e=Rb(ql({buf:n,start:0,end:n.length}));if(e.$tag===1){let n=e._0;xu(t,n)}hp(n)}bu(n,i),r=!0}continue}}if(n.length>0){let e=Rb(ql({buf:n,start:0,end:n.length}));if(e.$tag===1){let n=e._0;xu(t,n)}}return t}function Zx(e){let t=0,n=0,r=0,i=0,a=0,o=0,s=!1,c=Xx(e),l=Yx(e),u=0,d=l.length,f=0;for(;;){let e=f;if(e<d){let d=l[e];_L:{_L$2:{_L$3:{_L$4:{_L$5:{_L$6:{_L$7:{_L$8:{_L$9:{_L$10:{_L$11:{_L$12:{_L$13:{_L$14:{_L$15:{_L$16:{_L$17:{_L$18:{switch(d){case 77:break _L$18;case 109:break _L$18;case 76:break _L$16;case 108:break _L$16;case 67:break _L$14;case 99:break _L$14;case 81:break _L$12;case 113:break _L$12;case 83:break _L$10;case 115:break _L$10;case 84:break _L$8;case 116:break _L$8;case 72:break _L$6;case 104:break _L$6;case 86:break _L$4;case 118:break _L$4;case 90:break _L$2;case 122:break _L$2}break _L$17}if((u+1|0)<c.length){let e=Gc(c,u),l=Gc(c,u+1|0);u=u+2|0,d===77?(a=e,o=l):(a+=e,o+=l),s||=(t=a,n=o,!0),r=a,i=o}}break _L$15}if((u+1|0)<c.length){let e=Gc(c,u),t=Gc(c,u+1|0);u=u+2|0,d===76?(a=e,o=t):(a+=e,o+=t),r=a,i=o}}break _L$13}if((u+5|0)<c.length){let e=Gc(c,u+4|0),t=Gc(c,u+5|0);u=u+6|0,d===67?(a=e,o=t):(a+=e,o+=t),r=a,i=o}}break _L$11}if((u+3|0)<c.length){let e=Gc(c,u+2|0),t=Gc(c,u+3|0);u=u+4|0,d===81?(a=e,o=t):(a+=e,o+=t),r=a,i=o}}break _L$9}if((u+3|0)<c.length){let e=Gc(c,u+2|0),t=Gc(c,u+3|0);u=u+4|0,d===83?(a=e,o=t):(a+=e,o+=t),r=a,i=o}}break _L$7}if((u+1|0)<c.length){let e=Gc(c,u),t=Gc(c,u+1|0);u=u+2|0,d===84?(a=e,o=t):(a+=e,o+=t),r=a,i=o}}break _L$5}if(u<c.length){let e=Gc(c,u);u=u+1|0,d===72?a=e:a+=e,r=a,i=o}}break _L$3}if(u<c.length){let e=Gc(c,u);u=u+1|0,d===86?o=e:o+=e,r=a,i=o}}break _L}a=t,o=n,r=a,i=o}f=e+1|0;continue}else break}return{_0:t,_1:n,_2:r,_3:i}}function Qx(e){let t=[],n=Nu(e,{str:` `,start:0,end:1}),r=zu(e=>n(t=>e(Tl(t)))),i=r.length,a=0;for(;;){let e=a;if(e<i){let n=r[e],i=Nu(n,{str:`,`,start:0,end:1}),o=zu(e=>i(t=>e(Tl(t))));if(o.length===2){let e=Rb(Fc(o,0));if(e.$tag===1){let n=e._0,r=Rb(Fc(o,1));if(r.$tag===1){let e=r._0;uu(t,{x:n,y:e})}}}a=e+1|0;continue}else break}return t}function $x(e,t){switch(t){case`rect`:{let t=Ar(e,`width`);if(!D(t)&&t===`100%`)return;let n=qx(e,`x`,0),r=qx(e,`y`,0);return{_0:new pt(qx(e,`width`,100),qx(e,`height`,100),Jx(e,`rx`),Jx(e,`ry`)),_1:n,_2:r}}case`circle`:{let t=qx(e,`cx`,0),n=qx(e,`cy`,0);return{_0:new mt(qx(e,`r`,50)),_1:t,_2:n}}case`ellipse`:{let t=qx(e,`cx`,0),n=qx(e,`cy`,0);return{_0:new ht(qx(e,`rx`,50),qx(e,`ry`,30)),_1:t,_2:n}}case`line`:{let t=qx(e,`x1`,0),n=qx(e,`y1`,0);return{_0:new gt(qx(e,`x2`,100),qx(e,`y2`,100)),_1:t,_2:n}}case`text`:{let t=qx(e,`x`,0),n=qx(e,`y`,0);return{_0:new yt(Nr(e),Jx(e,`font-size`)),_1:t,_2:n}}case`polyline`:{let t=Ar(e,`points`);if(D(t))return;let n=Qx(t);if(n.length===0)return;let r=Ic(n,0);return{_0:new _t(n),_1:r.x,_2:r.y}}case`path`:{let t=Ar(e,`d`);if(D(t))return;let n=t,r=Zx(n),i=r._0,a=r._1,o=r._2,s=r._3;return{_0:new vt(n,i,a,o,s),_1:i,_2:a}}default:return}}function eS(e){let t=Ar(e,`fill`),n;if(D(t))n=void 0;else{let e=t;n=e===`none`?void 0:e}let r=Ar(e,`stroke`),i=D(r)?void 0:r,a=Jx(e,`stroke-width`),o=Jx(e,`opacity`),s=Ar(e,`stroke-dasharray`),c=D(s)?void 0:s,l=D(Ar(e,`marker-start`))?void 0:1,u=D(Ar(e,`marker-end`))?void 0:1,d=Ar(e,`font-family`),f;return f=D(d)?void 0:d,{fill:n,stroke:i,stroke_width:a,opacity:o,stroke_dasharray:c,marker_start:l,marker_end:u,font_family:f}}function tS(e,t,n){let r=Mr(e),i=Ar(e,`data-id`),a=D(i)?``:i,o=t();a!==``&&z(n,{_0:a,_1:o});let s=Ar(e,`data-parent-id`),c;if(D(s))c=void 0;else{let e=s;c=e===``?void 0:e}let l=Kx(e),u=eS(e),d=$x(e,r);if(d!==void 0){let e=d,t=e._0;return{id:o,x:e._1,y:e._2,shape:t,style:u,transform:void 0,parent_id:c,connections:l}}}function nS(e,t){let n=Mr(e),r=t(),i=eS(e),a=$x(e,n);if(a!==void 0){let e=a,t=e._0;return{id:r,x:e._1,y:e._2,shape:t,style:i,transform:void 0,parent_id:void 0,connections:void 0}}}function rS(e,t){let n=e.length,r=0;for(;;){let i=r;if(i<n){let n=e[i],a=n._0,o=n._1;if(a===t)return o;r=i+1|0;continue}else break}return t}function iS(e,t){let n=0;for(;;){let r=n;if(r<e.length){let i=Rc(e,r),a=i.parent_id,o;o=a===void 0?void 0:rS(t,a);let s=i.connections,c;if(s===void 0)c=void 0;else{let e=s,n=e.start,r;if(n===void 0)r=void 0;else{let e=n;r={element_id:rS(t,e.element_id),anchor:e.anchor}}let i=e.end,a;if(i===void 0)a=void 0;else{let e=i;a={element_id:rS(t,e.element_id),anchor:e.anchor}}c={start:r,end:a}}Vf(e,r,{...i,parent_id:o,connections:c}),n=r+1|0;continue}else return}}function aS(e,t){let n=Pr(e);if(D(n))return{elements:[],is_moonlight:!1,plain_svg_ids:[]};let r=!D(Ar(n,`data-moonlight`)),i=jr(n),a=[],o=[],s=[],c=i,l=c.length,u=0;for(;;){let e=u;if(e<l){_L:{let n=c[e];if(Mr(n)===`defs`)break _L;let i=r?tS(n,t,s):nS(n,t);if(i!==void 0){let e=i;ou(a,e),r||su(o,e.id)}break _L}u=e+1|0;continue}else break}return r&&iS(a,s),{elements:a,is_moonlight:r,plain_svg_ids:o}}function oS(e,t,n){return kr(()=>{let r=bm(e.theme_mode),i;return i=r===1?`#1a1a2e`:`#ffffff`,hx(W(e.elements),t,n,i)},t=>{let n=Hx(),r=aS(t,()=>{let e=om(n);return eg(n,e+1|0),`el-${vl(e+1|0)}`});if(r.elements.length>0){ag(e.elements,r.elements),eb(e),r.plain_svg_ids.length>0&&$y(e,r.plain_svg_ids),Zy(e);return}else return},()=>{ag(e.elements,[])},()=>um(e.has_focus),t=>{ug(e.selected_ids,t)},()=>{let t=W(e.elements),n=Array(t.length),r=t.length,i=0;for(;;){let e=i;if(e<r){n[e]=t[e].id,i=e+1|0;continue}else break}let a=n;ug(e.selected_ids,a)},()=>{ug(e.selected_ids,[])},()=>vm(e.selected_ids),()=>{tg(e.has_focus,!0)},()=>{tg(e.has_focus,!1)},()=>W(e.elements),t=>{Tg(e.elements,e=>{let n=[],r=e.length,i=0;for(;;){let a=i;if(a<r){let r=e[a];gp(t,r.id)||ou(n,r),i=a+1|0;continue}else break}return n}),Eg(e.selected_ids,e=>{let n=[],r=e.length,i=0;for(;;){let a=i;if(a<r){let r=e[a];gp(t,r)||su(n,r),i=a+1|0;continue}else break}return n})},t=>{let n=t===`freedraw`?1:0;og(e.tool_mode,n)},()=>lm(e.tool_mode)===0?`select`:`freedraw`,t=>{tg(e.is_readonly,t)},()=>um(e.is_readonly))}function sS(e,t,n,r){let i=dm(e.text_edit);if(i===void 0){T();return}else{let a=i,o=a.editing_id;if(o===void 0){if(r!==``){let i;if(a.parent_id!==``){let t=Q(e,a.parent_id);if(t===void 0)i=Tv(e);else{let n=t.style.stroke;if(n===void 0)i=Tv(e);else{let t=n;i={...Tv(e),fill:t}}}}else i=Tv(e);$(t,e,new ir(R_(X(Y(n(),a.x,a.y,new yt(r,Ys)),i),a.parent_id)))}}else{let n=o;if(r===``){let r=Q(e,n);r===void 0||$(t,e,new ar(r))}else r!==a.initial_text&&$(t,e,new dr(n,a.initial_text,r))}Av(e);return}}function cS(e,t){return n=>{Sn(n,`preventDefault`,[]);let r=n,i=t(n),a=i._0,o=i._1,s=xn(n,`target`),c=xn(xn(s,`dataset`),`id`),l;if(D(c)){let e=Fr(s);l=D(e)?void 0:e}else l=c;l===void 0||zv(e,l),Yv(e,r.clientX,r.clientY,a,o,l)}}function lS(e,t,n,r,i,a){let o=xn(a,`anchor`);if(D(o))return!1;let s=o,c=xn(a,`anchorElement`);if(D(c))return!1;let l=c,u=tv(s);if(u===void 0)return!1;{let a=u,o=Q(e,l);if(o===void 0)return!1;{let s=U_(o,a),c=r(i),u=c._0,d=c._1,f=n();return $(t,e,new ir({...X(Y(f,s.x,s.y,new gt(s.x,s.y)),Dv(e)),connections:{start:{element_id:l,anchor:a},end:void 0}})),wy(e,f,5,u,d),!0}}}function uS(e,t){let n=Q(e,t);if(n===void 0){T();return}else{let r=n;if(r.shape.$tag===5)return;let i=r.shape;if(i.$tag===6){let n=i,a=n._0,o=n._1,s=r.parent_id,c;c=s===void 0?t:s,kv(e,t,c,r.x,r.y,a,o);return}let a=Pv(e,t),o=a.length,s=0;for(;;){let n=s;if(n<o){let r=a[n],i=r.shape;if(i.$tag===6){let n=i,a=n._0,o=n._1;kv(e,r.id,t,r.x,r.y,a,o);return}s=n+1|0;continue}else break}let c=H_(r);Ov(e,t,c.x+c.width/2,c.y+c.height/2);return}}function dS(e,t){let n=Q(e,t);if(n===void 0){T();return}else{let r=n,i=r.shape;if(i.$tag===6){let n=i,a=n._0,o=n._1,s=r.parent_id,c;c=s===void 0?t:s,kv(e,t,c,r.x,r.y,a,o);return}else{T();return}}}function fS(e,t,n,r,i,a,o,s){let c=Iv(e,t),l;l=c===void 0?t:c;let u=Ir(),d=Fv(e,t),f;if(d){let n=Q(e,t);f=n===void 0?!1:n.shape.$tag===6}else f=!1;let p=f?t:l;if(a.val===p&&u-i.val<o){i.val=0,a.val=``,qv(e),f?dS(e,t):uS(e,l);return}i.val=u,a.val=p;let m=Uv(e,l),h=vm(e.selected_ids).length;if(s){m?Hv(e,l):Vv(e,l),vm(e.selected_ids).length>1?Vy(e,n,r):vm(e.selected_ids).length===1&&Gv(e,Fc(vm(e.selected_ids),0),n,r);return}if(m&&h>1){Vy(e,n,r);return}else{zv(e,l),Gv(e,l,n,r);return}}function pS(e,t,n,r){let i=xn(r,`handle`);if(D(i))return!1;let a=i,o=xn(r,`elementId`);if(D(o))return!1;let s=o,c=Q(e,s);if(c!==void 0&&c.shape.$tag===5)return!1;let l=t(n),u=l._0,d=l._1;return wy(e,s,ev(a),u,d),!0}function mS(e,t,n,r,i,a,o,s,c,l){return u=>{let d=Or(u),f=r(u),p=f._0,m=f._1;if(Id(l.val,d,{x:p,y:m}),l.val.size===2){let t=Ru(tf(l.val)),n=Pc(t,0),r=n._0,i=n._1,a=Pc(t,1),o=a._0,s=a._1;fy(e,r,o,i,s);return}if(cm(e.context_menu)!==void 0){Xv(e);return}if(Xy(e)){Yy(e);return}let h=u.button;if(e.mode===0)_L:{_L$2:{if(h===1||a.val)break _L$2;break _L}xy(e,p,m);return}let g=xn(u,`target`),_=xn(g,`dataset`);if(lS(e,t,n,i,u,_))return;if(bv(lm(e.tool_mode),1)){let t=i(u),n=t._0,r=t._1;Pb(e,n,r);return}if(pS(e,i,u,_))return;let v=xn(_,`id`),y;if(D(v)){let e=Fr(g);y=D(e)?void 0:e}else y=v;let b=i(u),te=b._0,ne=b._1,re=xn(u,`shiftKey`);if(y===void 0){zv(e,void 0),Ly(e,te,ne),o.val=0,s.val=``;return}else{fS(e,y,te,ne,o,s,c,re);return}}}function hS(e){return t=>{if(tg(e.mouse_in_canvas,!1),Nb(e)){let t=fm(e.svg_el);D(t)||tr(t),cg(e.free_draw_state,void 0)}um(e.is_panning)&&Cy(e),By(e)&&zy(e),pm(e.resize_state)===void 0||jy(e),mm(e.multi_drag_state)===void 0||Wy(e),hm(e.drag_state)===void 0||qv(e),gm(e.placement_state)!==void 0&&Yy(e)}}function gS(e,t,n,r){return i=>{let a=Or(i),o=t(i),s=o._0,c=o._1;if(Id(r.val,a,{x:s,y:c}),hy(e)){py(e,a,{x:s,y:c});return}if(cm(e.context_menu)!==void 0)return;let l=n(i),u=l._0,d=l._1;if(sg(e.mouse_scene_pos,{x:u,y:d}),tg(e.mouse_in_canvas,!0),Nb(e)){kb(e,u,d);let t=fm(e.svg_el);D(t)||Ab(t,Mb(e));return}if(um(e.is_panning)){let n=t(i),r=n._0,a=n._1;Sy(e,r,a);return}if(Xy(e)){Jy(e,{x:u,y:d});return}else if(My(e)){Oy(e,u,d);return}else if(Gy(e)){Uy(e,u,d);return}else if(Jv(e)){Kv(e,u,d);return}else if(By(e)){Ry(e,u,d);return}else return}}function _S(e,t,n){let r=n.length,i=0;for(;;){let a=i;if(a<r){_L:{let r=n[a],i=r._0,o=r._1,s=r._2,c=Q(e,i);if(c===void 0)break _L;{let e=c;if(o!==e.x||s!==e.y)cu(t.undo_stack,new or(i,o,s,e.x,e.y));else break _L}break _L}i=a+1|0;continue}else return}}function vS(e,t,n){let r=Q(e,n.element_id);if(r!==void 0){let i=r;if(n.start_x!==i.x||n.start_y!==i.y){let r=n.start_shape,a=i.shape;if(r!==void 0){let i=r;if(i.$tag===3){let r=i;if(a.$tag===3){let i=a;_S(e,t,n.connected_start_positions),jc(r,i)&&cu(t.undo_stack,new sr(n.element_id,r,i))}}}cu(t.undo_stack,new or(n.element_id,n.start_x,n.start_y,i.x,i.y)),fp(t.redo_stack);return}else return}}function yS(e,t,n){let r=n.start_positions,i=r.length,a=0;for(;;){let n=a;if(n<i){_L:{let i=r[n],a=i._0,o=i._1,s=i._2,c=Q(e,a);if(c===void 0)break _L;{let e=c;if(o!==e.x||s!==e.y)cu(t.undo_stack,new or(a,o,s,e.x,e.y));else break _L}break _L}a=n+1|0;continue}else break}fp(t.redo_stack)}function bS(e,t,n){let r=Q(e,n.element_id);if(r!==void 0){let e=r;if(jc(n.start_shape,e.shape)||n.start_x!==e.x||n.start_y!==e.y){(n.start_x!==e.x||n.start_y!==e.y)&&cu(t.undo_stack,new or(n.element_id,n.start_x,n.start_y,e.x,e.y)),cu(t.undo_stack,new sr(n.element_id,n.start_shape,e.shape)),fp(t.redo_stack);return}else return}}function xS(e,t,n,r,i){return n=>{let a=Or(n);if($d(r.val,a),my(e,a),Nb(e)){let t=fm(e.svg_el);D(t)||tr(t),jb(e,i);return}if(um(e.is_panning)){Cy(e);return}if(By(e)){zy(e);return}let o=pm(e.resize_state);if(o!==void 0){bS(e,t,o),jy(e);return}let s=mm(e.multi_drag_state);if(s!==void 0){yS(e,t,s),Wy(e);return}let c=hm(e.drag_state);c===void 0||vS(e,t,c),qv(e)}}function SS(e,t){return n=>{Sn(n,`preventDefault`,[]);let r=xn(n,`deltaY`),i=t(n),a=i._0,o=i._1;dy(e,a,o,r<0)}}function CS(e,t,n,r,i){let a,o;_L:switch(r){case`ArrowUp`:{let e=-i;a=0,o=e;break _L}case`ArrowDown`:a=0,o=i;break _L;case`ArrowLeft`:a=-i,o=0;break _L;case`ArrowRight`:a=i,o=0;break _L;default:a=0,o=0;break _L}let s=n.length,c=0;for(;;){let r=c;if(r<s){let i=n[r],s=Q(e,i);if(s===void 0)T();else{let n=s,r=n.x,c=n.y,l=r+a,u=c+o;Lv(e,i,e=>({...e,x:l,y:u}));let d=Pv(e,i),f=d.length,p=0;for(;;){let n=p;if(n<f){let r=d[n],i=r.x,s=r.y;Lv(e,r.id,e=>({...e,x:i+a,y:s+o})),cu(t.undo_stack,new or(r.id,i,s,i+a,s+o)),p=n+1|0;continue}else break}Ey(e,i),cu(t.undo_stack,new or(i,r,c,l,u))}c=r+1|0;continue}else break}fp(t.redo_stack)}function wS(e,t){let n=12/sm(e.viewport).zoom;switch(t){case`ArrowUp`:by(e,0,-n);return;case`ArrowDown`:by(e,0,n);return;case`ArrowLeft`:by(e,-n,0);return;case`ArrowRight`:by(e,n,0);return;default:return}}function TS(e,t,n,r,i){switch(e.$tag){case 0:{let a=e,o=a._0,s=a._1,c=a._2,l=a._3;switch(r){case`ArrowRight`:return{_0:new pt(o+i,s,c,l),_1:t,_2:n};case`ArrowLeft`:return{_0:new pt(o+i>=10?o+i:10,s,c,l),_1:t-i,_2:n};case`ArrowDown`:return{_0:new pt(o,s+i,c,l),_1:t,_2:n};case`ArrowUp`:return{_0:new pt(o,s+i>=10?s+i:10,c,l),_1:t,_2:n-i};default:return{_0:e,_1:t,_2:n}}}case 1:{let r=e._0;return{_0:new mt(r+i>=5?r+i:5),_1:t,_2:n}}case 2:{let a=e,o=a._0,s=a._1;_L:{_L$2:switch(r){case`ArrowRight`:break _L$2;case`ArrowLeft`:break _L$2;case`ArrowDown`:break _L;case`ArrowUp`:break _L;default:return{_0:e,_1:t,_2:n}}return{_0:new ht(o+i>=5?o+i:5,s),_1:t,_2:n}}return{_0:new ht(o,s+i>=5?s+i:5),_1:t,_2:n}}case 3:{let a=e,o=a._0,s=a._1;switch(r){case`ArrowRight`:return{_0:new gt(o+i,s),_1:t,_2:n};case`ArrowLeft`:return{_0:new gt(o,s),_1:t-i,_2:n};case`ArrowDown`:return{_0:new gt(o,s+i),_1:t,_2:n};case`ArrowUp`:return{_0:new gt(o,s),_1:t,_2:n-i};default:return{_0:e,_1:t,_2:n}}}case 6:{let a=e,o=a._0,s=a._1,c=id(s,16);_L$2:{_L$3:switch(r){case`ArrowRight`:break _L$3;case`ArrowDown`:break _L$3;case`ArrowLeft`:break _L$2;case`ArrowUp`:break _L$2;default:return{_0:e,_1:t,_2:n}}return{_0:new yt(o,new ct(c+i/2)),_1:t,_2:n}}return{_0:new yt(o,new ct(c-i/2>=8?c-i/2:8)),_1:t,_2:n}}default:return{_0:e,_1:t,_2:n}}}function ES(e,t,n,r,i){let a=n.length,o=0;for(;;){let s=o;if(s<a){let a=n[s],c=Q(e,a);if(c===void 0)T();else{let n=c,o=n.shape,s=TS(n.shape,n.x,n.y,r,i),l=s._0,u=s._1,d=s._2,f=Pv(e,a),p=[],m=f.length,h=0;for(;;){let e=h;if(e<m){let t=f[e];hu(p,{_0:t.id,_1:t.x,_2:t.y}),h=e+1|0;continue}else break}Lv(e,a,e=>({...e,shape:l,x:u,y:d})),(u!==n.x||d!==n.y)&&cu(t.undo_stack,new or(a,n.x,n.y,u,d)),cu(t.undo_stack,new sr(a,o,l)),Ky(e,a);let g=p.length,_=0;for(;;){let n=_;if(n<g){let r=p[n],i=r._0,a=r._1,o=r._2,s=Q(e,i);if(s!==void 0){let e=s;(e.x!==a||e.y!==o)&&cu(t.undo_stack,new or(i,a,o,e.x,e.y))}_=n+1|0;continue}else break}}o=s+1|0;continue}else break}fp(t.redo_stack)}function DS(e,t,n,r){let i=vm(e.selected_ids);if(i.length===0){wS(e,n);return}let a=um(e.grid_enabled)?10:5;if(r){ES(e,t,i,n,a);return}else{CS(e,t,i,n,a);return}}function OS(){Ur(`https://github.com/mizchi/moonlight`)}function kS(e,t,n){let r=Cv(e);return K(void 0,void 0,`display: flex; gap: 3px; align-items: center;`,void 0,void 0,k,void 0,j,M,[vv(_v(`M3 3h18v18H3z`,16),`1`,`Rectangle`,()=>{let r=n(),i=yy(e);$(t,e,new ir(X(Y(r,i.x-40,i.y-30,new pt(80,60,w,w)),wv(e)))),zv(e,r)},r),vv(_v(`M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0`,16),`2`,`Circle`,()=>{let r=n(),i=yy(e);$(t,e,new ir(X(Y(r,i.x,i.y,Xs),wv(e)))),zv(e,r)},r),vv(_v(`M12 12m-9 0a9 5 0 1 0 18 0a9 5 0 1 0 -18 0`,16),`3`,`Ellipse`,()=>{let r=n(),i=yy(e);$(t,e,new ir(X(Y(r,i.x,i.y,Zs),wv(e)))),zv(e,r)},r),vv(_v(`M5 19L19 5`,16),`4`,`Line`,()=>{let r=n(),i=yy(e);$(t,e,new ir(X(Y(r,i.x-50,i.y-25,new gt(i.x+50,i.y+25)),Ev(e)))),zv(e,r)},r),vv(_v(`M5 19L19 5M19 5L19 12M19 5L12 5`,16),`5`,`Arrow`,()=>{let r=n(),i=yy(e);$(t,e,new ir(X(Y(r,i.x-50,i.y-25,new gt(i.x+50,i.y+25)),Dv(e)))),zv(e,r)},r),vv(_v(`M4 7V4h16v3M9 20h6M12 4v16`,16),`6`,`Text`,()=>{let r=n(),i=yy(e);$(t,e,new ir(X(Y(r,i.x-25,i.y+8,Qs),Tv(e)))),zv(e,r)},r),yv(r),vv(_v(bv(lm(e.tool_mode),1)?`M12 19l7-7 3 3-7 7H12v-3zM18 12l-1.5-1.5M2 12l5.5-5.5L15 3l3 3-6.5 7.5L6 19`:`M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z`,16),`P`,bv(lm(e.tool_mode),1)?`Free Draw (active)`:`Free Draw`,()=>{Fb(e)},r),yv(r),vv(_v(`M3 7v6h6M3 13a9 9 0 1 0 3-7.5`,16),`⌘Z`,`Undo`,()=>{Fy(t,e)},r),vv(_v(`M21 7v6h-6M21 13a9 9 0 1 1 -3-7.5`,16),`⌘Y`,`Redo`,()=>{Iy(t,e)},r),yv(r),vv(_v(`M21 21l-6-6m2-5a7 7 0 1 1 -14 0a7 7 0 0 1 14 0zM7 10h6`,16),void 0,`Zoom Out`,()=>{uy(e)},r),q(void 0,void 0,`min-width: 44px; text-align: center; font-size: 11px; font-weight: 500; color: ${r.ui_text};`,void 0,void 0,k,void 0,j,M,[v_(()=>{let t=sm(e.viewport).zoom;return`${vl(Rf(t*100))}%`})]),vv(_v(`M21 21l-6-6m2-5a7 7 0 1 1 -14 0a7 7 0 0 1 14 0zM10 7v6M7 10h6`,16),void 0,`Zoom In`,()=>{ly(e)},r),vv(_v(`M3 12a9 9 0 1 0 9-9M3 3v6h6`,16),void 0,`Fit to Canvas`,()=>{_y(e)},r),yv(r),K(void 0,void 0,`position: relative; display: inline-block;`,void 0,void 0,k,void 0,j,M,[Xg(`button`,[{_0:`style`,_1:new st(()=>{let t=um(e.grid_enabled),n=S_(bm(e.theme_mode),1),r=n?Di:Ei;return t?`${ma}background: ${n?`#1e3a5f`:`#e3f2fd`}; border-color: ${n?`#4a9eff`:`#2196f3`}; color: ${n?`#60a5fa`:`#1976d2`};`:`${ma}background: ${r.ui_bg}; border-color: ${r.ui_border}; color: ${r.ui_text_muted};`})},$s,{_0:`click`,_1:new C(t=>{jv(e)})},{_0:`mouseenter`,_1:new C(e=>{Wr(pa,e)})},{_0:`mouseleave`,_1:new C(e=>{Vr(pa)})}],[_v(`M3 3h7v7H3zM14 3h7v7h-7zM14 14h7v7h-7zM3 14h7v7H3z`,16),q(void 0,void 0,`color: inherit; font-size: 9px; line-height: 1;`,void 0,void 0,k,void 0,j,M,[J(`Snap`)])]),K(void 0,void 0,`position: fixed; margin: 0; padding: 4px 8px; background: #333; color: #fff; font-size: 11px; border-radius: 4px; white-space: nowrap; border: none;`,void 0,void 0,k,void 0,new Zn([{_0:`id`,_1:new lt(pa)},ec]),M,[J(`Grid Snap`)])]),yv(r),vv(_v(`M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5l5-5M12 15V3`,16),void 0,`Download SVG (Ctrl+S)`,()=>{Br(hx(W(e.elements),Rf(ym(e.doc_width)),Rf(ym(e.doc_height)),Cv(e).background),`moonlight.svg`,`image/svg+xml`)},r),vv(_v(`M8 4v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7.24a2 2 0 0 0-.59-1.41l-2.83-2.83A2 2 0 0 0 15.17 2H10a2 2 0 0 0-2 2zM16 2v4a2 2 0 0 0 2 2h4M4 12v8a2 2 0 0 0 2 2h8`,16),void 0,`Copy SVG (Ctrl+Shift+C)`,()=>{zr(hx(W(e.elements),Rf(ym(e.doc_width)),Rf(ym(e.doc_height)),Cv(e).background),()=>{},()=>{})},r),vv(_v(`M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5l-5 5M12 3v12`,16),void 0,`Import SVG (Ctrl+Shift+V)`,()=>{Hr(`.svg`,r=>{let i=aS(r,n),a=i.elements,o=a.length,s=0;for(;;){let n=s;if(n<o){let r=a[n];$(t,e,new ir(r)),s=n+1|0;continue}else break}if(i.elements.length>0){i.plain_svg_ids.length>0&&$y(e,i.plain_svg_ids),Zy(e);let t=i.elements,n=[],r=t.length,a=0;for(;;){let e=a;if(e<r){let r=t[e];r.parent_id===void 0&&ou(n,r),a=e+1|0;continue}else break}let o=n,s=Array(o.length),c=o.length,l=0;for(;;){let e=l;if(e<c){s[e]=o[e].id,l=e+1|0;continue}else break}Bv(e,s);return}else return})},r),r_(()=>e.mode===0,()=>t_([yv(r),vv(_v(`M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22`,16),void 0,`View on GitHub`,()=>{OS()},r)]))])}function AS(e,t,n,r,i,a,o){let s=kg(()=>{let t=W(e.elements),n=[],r=[],i=t.length,a=0;for(;;){let e=a;if(e<i){let i=t[e];i.shape.$tag===3?su(r,i.id):su(n,i.id),a=e+1|0;continue}else break}return up(n,{buf:r,start:0,end:r.length}),n}),c=[];return B(c,new Rn(dx())),B(c,Vx(S_(bm(e.theme_mode),1))),B(c,Bx(e)),B(c,Yg(di,`g`,[{_0:`style`,_1:new st(()=>um(e.grid_enabled)?`visibility: visible;`:`visibility: hidden;`)}],[wx(e)])),B(c,u_(()=>s(),(t,n)=>Fx(e,t))),B(c,Ix(e)),B(c,r_(()=>xm(e.box_select)!==void 0,()=>Lx(e))),B(c,r_(()=>{let t=pm(e.resize_state);return t===void 0?!1:t.start_shape.$tag===3},()=>Rx(e))),B(c,r_(()=>Sm(e.pending_connection)!==void 0,()=>zx(e))),Yg(di,`svg`,[tc,nc,{_0:`viewBox`,_1:new st(()=>{_L:if(e.mode===1){if(um(e.modal_open))break _L;{let t=ym(e.doc_width),n=ym(e.doc_height);return`0 0 ${L(t)} ${L(n)}`}}else break _L;let t=sm(e.viewport),n=om(e.canvas_width)+0,r=om(e.canvas_height)+0,i=n/t.zoom,a=r/t.zoom;return`${L(t.scroll_x)} ${L(t.scroll_y)} ${L(i)} ${L(a)}`})},{_0:`style`,_1:new st(()=>{let t=Cv(e),n=e.mode,r;r=n===1?`none`:`1px solid #ccc`;let i=lm(e.tool_mode),a;return a=i===1?`crosshair`:`default`,`border: ${r}; user-select: none; touch-action: none; overflow: hidden; cursor: ${a}; --ml-stroke: ${t.stroke}; --ml-fill: ${t.fill}; --ml-text: ${t.text};`})},{_0:`pointerdown`,_1:new C(t)},{_0:`pointermove`,_1:new C(n)},{_0:`pointerup`,_1:new C(r)},{_0:`pointerleave`,_1:new C(i)},{_0:`contextmenu`,_1:new C(a)},{_0:`wheel`,_1:new C(o)},{_0:`__ref`,_1:new C(t=>{lg(e.svg_el,t);let n={val:!0};Gr(t,(t,r)=>{let i=Rf(t),a=Rf(r);if(i>0&&a>0)if(eg(e.canvas_width,i),eg(e.canvas_height,a),n.val){n.val=!1;_L:if(e.mode===0)break _L;else if(um(e.modal_open))break _L;else return;gy(e);return}else return;else return})})}],c)}function jS(e){switch(e){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 65:return 10;case 66:return 11;case 67:return 12;case 68:return 13;case 69:return 14;case 70:return 15;default:return 0}}function MS(e){let t=Bu(Du(Wu(e))),n=t.length>0&&Wc(t,0)===35?1:0;if(t.length>=(n+6|0)){let e=((Math.imul(jS(Wc(t,n)),16)|0)+jS(Wc(t,n+1|0))|0)+0,r=((Math.imul(jS(Wc(t,n+2|0)),16)|0)+jS(Wc(t,n+3|0))|0)+0,i=((Math.imul(jS(Wc(t,n+4|0)),16)|0)+jS(Wc(t,n+5|0))|0)+0;return(.299*e+.587*r+.114*i)/255}else return .5}function NS(e,t){return MS(e)<.5?t===0?`#ffffff`:`#e0e0e0`:t===0?`#2a2a2a`:`#1a1a2e`}function PS(e,t){return au(t,{str:`var(`,start:0,end:4})?e.stroke:t}function FS(e){}function IS(e,t){let n={val:gr},r={val:gr};return wg(()=>{let i=dm(e.text_edit),a=n.val,o;if(a.$tag===1)o=a._0;else return;let s=r.val;if(s.$tag===1){let e=s._0;Kr(o,e),r.val=gr}if(i!==void 0){let n=i,a=sm(e.viewport),s=bm(e.theme_mode),c=W(e.elements),l=Cv(e),u=l.stroke,d=n.editing_id,f;if(d===void 0){let t=Q(e,n.parent_id);if(t===void 0)f=u;else{let e=t.style.stroke,n;n=e===void 0?u:e,f=PS(l,n)}}else{let t=Q(e,d);if(t===void 0)f=u;else{let e=t,n=V_(c,e.parent_id);f=PS(l,B_(e.style,n))}}let p=Q(e,n.parent_id),m;if(p===void 0)m={_0:n.x,_1:n.y};else{let e=H_(p);m={_0:e.x+e.width/2,_1:e.y+e.height/2}}let h=m._0,g=m._1,_=NS(f,s),v=e.mode,y;y=v===1?!um(e.modal_open):!1;let b=n.font_size,te;te=b.$tag===1?b._0:16;let ne;if(y){let t=ym(e.doc_width),n=ym(e.doc_height),r=h/t*100,i=g/n*100;ne=`position: absolute; left: ${L(r)}%; top: ${L(i)}%; transform: translate(-50%, -50%); min-width: 40px; padding: 2px 4px; border: none; background: ${_}; color: ${f}; font-family: sans-serif; font-size: ${L(te)}px; line-height: 1.2; text-align: center; outline: none; box-sizing: border-box; resize: none; overflow: hidden; caret-color: currentColor; white-space: nowrap; border-radius: 2px;`}else{let e=q_(a,h,g),t=40*a.zoom,n=te*a.zoom,r=n*1.5;ne=`position: absolute; left: ${L(e.x)}px; top: ${L(e.y)}px; transform: translate(-50%, -50%); min-width: ${L(t)}px; height: ${L(r)}px; padding: 2px 4px; border: none; background: ${_}; color: ${f}; font-family: sans-serif; font-size: ${L(n)}px; line-height: 1.2; text-align: center; outline: none; box-sizing: border-box; resize: none; overflow: hidden; caret-color: currentColor; white-space: nowrap; border-radius: 2px;`}let re=n.editing_id,ie=n.initial_text,ae=fr(ne,ie,e=>{t(e)},t=>{re===void 0||iy(e,re,ie),hg(e.text_edit,void 0)},FS);mr(o,ae),r.val=new _r(ae);return}}),Xg(`div`,[rc,{_0:`__ref`,_1:new C(e=>{n.val=new _r(e)})}],[])}function LS(e){let t=e,n=Sn(xn(e,`currentTarget`),`getBoundingClientRect`,[]);return{_0:t.clientX-xn(n,`left`),_1:t.clientY-xn(n,`top`)}}function RS(e,t,n){let r=t=>{let n=LS(t),r=n._0,i=n._1,a=K_(sm(e.viewport),r,i);return{_0:a.x,_1:a.y}},i={val:!1},a={val:0},o={val:``},s={val:Vd({buf:[],start:0,end:0})},c=r=>{sS(e,t,n,r)},l=mS(e,t,n,LS,r,i,a,o,300,s),u=gS(e,LS,r,s),d=xS(e,t,LS,s,n),f=hS(e),p=SS(e,LS),m=AS(e,l,u,d,f,cS(e,r),p);return wg(()=>{if(um(e.modal_open),um(e.modal_open)){Lr(n=>{if(Rr())return;let r=xn(n,`key`),i=n;if(r===`Escape`){tg(e.modal_open,!1),Gp(i);return}_L:switch(r){case`ArrowUp`:break _L;case`ArrowDown`:break _L;case`ArrowLeft`:break _L;case`ArrowRight`:break _L;default:return}DS(e,t,r,xn(n,`shiftKey`)),Gp(i)});return}else return}),K(void 0,void 0,`position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 1000; display: flex; align-items: center; justify-content: center;`,void 0,void 0,new A(O(G(),t=>{tg(e.modal_open,!1)})),void 0,j,M,[K(void 0,void 0,`width: 90vw; max-width: 1200px; height: 85vh; background: white; border-radius: 8px; overflow: hidden; display: flex; flex-direction: column; box-shadow: 0 4px 24px rgba(0,0,0,0.3);`,void 0,void 0,new A(O(G(),e=>{Sn(e,`stopPropagation`,[])})),void 0,j,M,[K(void 0,void 0,`display: flex; justify-content: space-between; align-items: center; padding: 8px 16px; border-bottom: 1px solid #ddd; background: #f8f8f8; flex-shrink: 0;`,void 0,void 0,k,void 0,j,M,[K(void 0,void 0,`font-weight: 500; font-size: 14px;`,void 0,void 0,k,void 0,j,M,[J(`Moonlight Editor`)]),Xg(`button`,[ic,ac,oc,{_0:`click`,_1:new C(t=>{tg(e.modal_open,!1)})}],[_v(`M18 6L6 18M6 6l12 12`,18)])]),K(void 0,void 0,`flex: 1; display: flex; overflow: hidden; min-height: 0;`,void 0,void 0,k,void 0,j,M,[K(void 0,void 0,`flex: 1; position: relative; min-width: 0;`,void 0,void 0,k,void 0,j,M,[m,IS(e,c)]),K(void 0,void 0,`width: 240px; border-left: 1px solid #ddd; overflow-y: auto; background: #fafafa;`,void 0,void 0,k,void 0,j,M,[tx(e,t)])]),K(void 0,void 0,`display: flex; gap: 4px; align-items: center; padding: 8px 12px; border-top: 1px solid #ddd; background: #f8f8f8; flex-shrink: 0;`,void 0,void 0,k,void 0,j,M,[kS(e,t,n)]),r_(()=>cm(e.context_menu)!==void 0,()=>ax(e,t,n))])])}function zS(e,t,n){return K(void 0,void 0,void 0,void 0,()=>{let t=ym(e.doc_width),n=ym(e.doc_height);return`position: relative; width: 100%; aspect-ratio: ${L(t)} / ${L(n)};`},k,void 0,j,M,[t,IS(e,n),Xg(`button`,[sc,cc,lc,{_0:`click`,_1:new C(t=>{tg(e.modal_open,!0)})}],[_v(`M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7`,20)])])}function BS(e){let t=e,n=Sn(xn(e,`currentTarget`),`getBoundingClientRect`,[]);return{_0:t.clientX-xn(n,`left`),_1:t.clientY-xn(n,`top`)}}function VS(e){}function HS(e,t,n){let r=t=>{let n=BS(t),r=n._0,i=n._1,a=K_(sm(e.viewport),r,i);return{_0:a.x,_1:a.y}},i={val:!1},a={val:0},o={val:``},s={val:Vd({buf:[],start:0,end:0})};return t_([zS(e,AS(e,mS(e,t,n,BS,r,i,a,o,300,s),gS(e,BS,r,s),xS(e,t,BS,s,n),hS(e),cS(e,r),VS),r=>{sS(e,t,n,r)}),r_(()=>cm(e.context_menu)!==void 0,()=>ax(e,t,n)),r_(()=>um(e.modal_open),()=>RS(e,t,n))])}function US(e,t){let n={val:[]};wg(()=>{let r=W(e.elements);Jr(t);let i=n.val,a=Array(i.length),o=i.length,s=0;for(;;){let e=s;if(e<o){a[e]=i[e].id,s=e+1|0;continue}else break}let c=a,l=Array(r.length),u=r.length,d=0;for(;;){let e=d;if(e<u){l[e]=r[e].id,d=e+1|0;continue}else break}let f=l,p=f.length,m=0;for(;;){let e=m;if(e<p){let n=f[e];gp(c,n)||Xr(t,n),m=e+1|0;continue}else break}let h=c.length,g=0;for(;;){let e=g;if(e<h){let n=c[e];gp(f,n)||Zr(t,n),g=e+1|0;continue}else break}n.val=r});let r={val:[]};wg(()=>{let n=vm(e.selected_ids);n.length>0&&r.val.length===0?ei(t,n):n.length===0&&r.val.length>0?Yr(t):n.length>0&&ei(t,n),r.val=n});let i={val:!1};wg(()=>{let n=um(e.has_focus);n&&!i.val?Qr(t):!n&&i.val&&qr(t),i.val=n});let a={val:0};wg(()=>{let n=lm(e.tool_mode);if(kc(n,a.val)){let e;e=n===0?`select`:`freedraw`,$r(t,e)}a.val=n})}function WS(e,t){let n=Hx(),r=()=>{let e=om(n);return eg(n,e+1|0),`el-${vl(e+1|0)}`},i=Sv(t.width,t.height,1),a=gv();ng(i.doc_width,t.doc_width+0),ng(i.doc_height,t.doc_height+0);let o=sm(i.viewport);rg(i.viewport,{scroll_x:o.scroll_x,scroll_y:o.scroll_y,zoom:t.zoom});let s=t.theme===`dark`?1:0;ig(i.theme_mode,s),tg(i.is_readonly,t.is_readonly);let c=t.initial_svg;if(c===void 0)ox(i,r);else{let e=aS(c,r);e.elements.length>0&&(ag(i.elements,e.elements),e.plain_svg_ids.length>0&&$y(i,e.plain_svg_ids),Zy(i))}let l=HS(i,a,r);$g(qg(e),l);let u=oS(i,t.doc_width,t.doc_height);return US(i,u),u}function GS(e,t){return WS(e,Wx(t))}ti(GS);export const createEditor=globalThis.__moonlightEditorModule.createEditor;